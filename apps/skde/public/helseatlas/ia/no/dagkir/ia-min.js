(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement)cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close();d=cm.createElement(a),cm.body.appendChild(d),
e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===
1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]===
"*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)ca(a+"["+e+"]",b[e],c,d);else d(a,
b)}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),
e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border")for(;g<h;g++)c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0;return d+"px"}d=bz(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;g<h;g++)d+=
parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0);return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();
b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();
if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio")if(c==="option")b.selected=a.defaultSelected;else{if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<
e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===
c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,
e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=
0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=
this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);
return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?
this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},
slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i=
{}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,
1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&
b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;
for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a);},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),
d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d)if(i)for(f in a){if(c.apply(a[f],
d)===!1)break}else for(;g<h;){if(c.apply(a[g++],d)===!1)break}else if(i)for(f in a){if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,
a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));
if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=
!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof
e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test("\u00a0")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",
B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?
e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=
d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,
fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,
d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=
arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),
q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),
hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,
g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=
i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent)for(o in{submit:1,change:1,focusin:1})n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p;k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,
k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",
l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,
d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,
k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]=
{},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=
b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,
c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&
(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?
f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!=
"string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!=
"string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,
v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=
a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=
(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&
f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+=
"":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,
c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||
(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in
h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++)e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",
b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,
d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!=
"boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=
w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||
b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],
{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&
(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,
arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,
o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+
"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,
d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,
o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=
0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=
b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++)r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),
o[s]&&q.push(r);q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},
props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,
h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||
{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===
b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);
a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&
a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),
f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),
f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&
!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},
function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);
return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,
a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,
b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>
0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,
l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>
1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,
k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,
e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=
null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a);};
var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d)if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else{if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,
ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},
type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<
f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!=
"undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,
"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+
a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&
a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===
a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();
return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,
b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case "only":case "first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case "last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case "nth":c=b[2],e=b[3];if(c===
1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,
c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=
new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);
else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),
j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!=
"undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);
if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||
c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!==
"object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,
"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className=
"e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:
0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,
O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=
0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});
g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:
a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,
"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,
b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===
1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,
$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],
area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,
b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?
a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,
this)});if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),
f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||
!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();
c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});
if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bp)}return this}}),
f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",
insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||
!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=
k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),
o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof(r=k.length)=="number")for(i=0;i<r;i++)bn(k[i]);else bn(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},
cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=
/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,
widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||
(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bC(a,b,d);f.swap(a,bw,function(){e=
bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=
bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,
a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;
return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS)return bS.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&
(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&
(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,
url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},
contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=
y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},
c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||
(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]===
"http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&
d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,
v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bU,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z;}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||
a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)ca(g,a[g],c,e);return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||
e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,
c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch)ch[a](0,1)}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||
f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===
4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=
/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",
cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a==
"boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties=
{};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?
this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,
""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&
g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&
a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+0.5)*d+c}},timers:[],fx:function(a,
b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;
this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=
!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==
!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=
this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],
function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);
try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,
a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&
(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,
i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,
n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=
parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||
g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=
f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f,typeof define=="function"&&
define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);(function($,h,c){var a=$([]),e=$.resize=$.extend($.resize,{}),i,k="setTimeout",j="resize",d=j+"-special-event",b="delay",f="throttleWindow";e[b]=250;e[f]=true;$.event.special[j]={setup:function(){if(!e[f]&&this[k])return false;var l=$(this);a=a.add(l);$.data(this,d,{w:l.width(),h:l.height()});if(a.length===1)g()},teardown:function(){if(!e[f]&&this[k])return false;var l=$(this);a=a.not(l);l.removeData(d);if(!a.length)clearTimeout(i)},add:function(l){if(!e[f]&&this[k])return false;var n;function m(s,
o,p){var q=$(this),r=$.data(this,d);r.w=o!==c?o:q.width();r.h=p!==c?p:q.height();n.apply(this,arguments)}if($.isFunction(l)){n=l;return m}else{n=l.handler;l.handler=m}}};function g(){i=h[k](function(){a.each(function(){var n=$(this),m=n.width(),l=n.height(),o=$.data(this,d);if(m!==o.w||l!==o.h)n.trigger(j,[o.w=m,o.h=l])});g()},e[b])}})(jQuery,this);(function(){var a=Math,b=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"",c="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,d="ontouchstart"in window,e=b+"Transform"in document.documentElement.style,f=/android/gi.test(navigator.appVersion),g=/iphone|ipad/gi.test(navigator.appVersion),h=/playbook/gi.test(navigator.appVersion),j=g||h,i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),m=window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,k="onorientationchange"in window?"orientationchange":"resize",n=d?"touchstart":"mousedown",l=d?"touchmove":"mousemove",o=d?"touchend":"mouseup",p=d?"touchcancel":"mouseup",r=b=="Moz"?"DOMMouseScroll":
"mousewheel",s="translate"+(c?"3d(":"("),w=c?",0)":")",h=function(a,h){var i=this,m;i.wrapper=typeof a=="object"?a:document.getElementById(a);i.wrapper.style.overflow="hidden";i.scroller=i.wrapper.children[0];i.options={hScroll:!0,vScroll:!0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,roundPosition:!1,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:f,hideScrollbar:g,fadeScrollbar:g&&c,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,
doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(m in h)i.options[m]=h[m];i.options.useTransform=e?i.options.useTransform:!1;i.options.hScrollbar=i.options.hScroll&&i.options.hScrollbar;i.options.vScrollbar=i.options.vScroll&&i.options.vScrollbar;
i.options.zoom=i.options.useTransform&&i.options.zoom;i.options.useTransition=j&&i.options.useTransition;i.scroller.style[b+"TransitionProperty"]=i.options.useTransform?"-"+b.toLowerCase()+"-transform":"top left";i.scroller.style[b+"TransitionDuration"]="0";i.scroller.style[b+"TransformOrigin"]="0 0";i.options.useTransition&&(i.scroller.style[b+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");i.options.useTransform?i.scroller.style[b+"Transform"]=s+"0,0"+w:i.scroller.style.cssText+=";position:absolute;top:0;left:0";
if(i.options.useTransition)i.options.fixedScrollbar=!0;i.refresh();i._bind(k,window);i._bind(n);d||(i._bind("mouseout",i.wrapper),i._bind(r));if(i.options.checkDOMChanges)i.checkDOMTime=setInterval(function(){i._checkDOMChanges()},500)};h.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(a){switch(a.type){case n:if(!d&&a.button!==0)break;this._start(a);break;case l:this._move(a);break;case o:case p:this._end(a);
break;case k:this._resize();break;case r:this._wheel(a);break;case "mouseout":this._mouseout(a);break;case "webkitTransitionEnd":this._transitionEnd(a)}},_checkDOMChanges:function(){!this.moved&&!this.zoomed&&!(this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)&&this.refresh()},_scrollbar:function(c){var d=document,f;if(this[c+"Scrollbar"]){if(!this[c+"ScrollbarWrapper"]){f=d.createElement("div");this.options.scrollbarClass?
f.className=this.options.scrollbarClass+c.toUpperCase():f.style.cssText="position:absolute;z-index:100;"+(c=="h"?"height:7px;bottom:1px;left:2px;right:"+(this.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(this.hScrollbar?"7":"2")+"px;top:2px;right:1px");f.style.cssText+=";pointer-events:none;-"+b+"-transition-property:opacity;-"+b+"-transition-duration:"+(this.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(this.options.hideScrollbar?"0":"1");this.wrapper.appendChild(f);this[c+"ScrollbarWrapper"]=
f;f=d.createElement("div");if(!this.options.scrollbarClass)f.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+b+"-background-clip:padding-box;-"+b+"-box-sizing:border-box;"+(c=="h"?"height:100%":"width:100%")+";-"+b+"-border-radius:3px;border-radius:3px";f.style.cssText+=";pointer-events:none;-"+b+"-transition-property:-"+b+"-transform;-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+b+"-transition-duration:0;-"+b+
"-transform:"+s+"0,0"+w;this.options.useTransition&&(f.style.cssText+=";-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)");this[c+"ScrollbarWrapper"].appendChild(f);this[c+"ScrollbarIndicator"]=f}c=="h"?(this.hScrollbarSize=this.hScrollbarWrapper.clientWidth,this.hScrollbarIndicatorSize=a.max(a.round(this.hScrollbarSize*this.hScrollbarSize/this.scrollerW),8),this.hScrollbarIndicator.style.width=this.hScrollbarIndicatorSize+"px",this.hScrollbarMaxScroll=this.hScrollbarSize-this.hScrollbarIndicatorSize,
this.hScrollbarProp=this.hScrollbarMaxScroll/this.maxScrollX):(this.vScrollbarSize=this.vScrollbarWrapper.clientHeight,this.vScrollbarIndicatorSize=a.max(a.round(this.vScrollbarSize*this.vScrollbarSize/this.scrollerH),8),this.vScrollbarIndicator.style.height=this.vScrollbarIndicatorSize+"px",this.vScrollbarMaxScroll=this.vScrollbarSize-this.vScrollbarIndicatorSize,this.vScrollbarProp=this.vScrollbarMaxScroll/this.maxScrollY);this._scrollbarPos(c,!0)}else this[c+"ScrollbarWrapper"]&&(e&&(this[c+"ScrollbarIndicator"].style[b+
"Transform"]=""),this[c+"ScrollbarWrapper"].parentNode.removeChild(this[c+"ScrollbarWrapper"]),this[c+"ScrollbarWrapper"]=null,this[c+"ScrollbarIndicator"]=null)},_resize:function(){var a=this;setTimeout(function(){a.refresh()},f?200:0)},_pos:function(c,d){c=this.hScroll?c:0;d=this.vScroll?d:0;if(this.options.roundPosition||!this.options.useTransform)c=a.round(c),d=a.round(d);this.options.useTransform?this.scroller.style[b+"Transform"]=s+c+"px,"+d+"px"+w+" scale("+this.scale+")":(this.scroller.style.left=
c+"px",this.scroller.style.top=d+"px");this.x=c;this.y=d;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(c,d){var e=c=="h"?this.x:this.y;if(this[c+"Scrollbar"])e*=this[c+"ScrollbarProp"],e<0?(this.options.fixedScrollbar||(e=this[c+"ScrollbarIndicatorSize"]+a.round(e*3),e<8&&(e=8),this[c+"ScrollbarIndicator"].style[c=="h"?"width":"height"]=e+"px"),e=0):e>this[c+"ScrollbarMaxScroll"]&&(this.options.fixedScrollbar?e=this[c+"ScrollbarMaxScroll"]:(e=this[c+"ScrollbarIndicatorSize"]-
a.round((e-this[c+"ScrollbarMaxScroll"])*3),e<8&&(e=8),this[c+"ScrollbarIndicator"].style[c=="h"?"width":"height"]=e+"px",e=this[c+"ScrollbarMaxScroll"]+(this[c+"ScrollbarIndicatorSize"]-e))),this[c+"ScrollbarWrapper"].style[b+"TransitionDelay"]="0",this[c+"ScrollbarWrapper"].style.opacity=d&&this.options.hideScrollbar?"0":"1",this[c+"ScrollbarIndicator"].style[b+"Transform"]=s+(c=="h"?e+"px,0":"0,"+e+"px")+w},_start:function(c){var e=d?c.touches[0]:c,f,g;if(this.enabled){this.options.onBeforeScrollStart&&
this.options.onBeforeScrollStart.call(this,c);(this.options.useTransition||this.options.zoom)&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;if(this.options.zoom&&d&&c.touches.length>1)g=a.abs(c.touches[0].pageX-c.touches[1].pageX),f=a.abs(c.touches[0].pageY-c.touches[1].pageY),this.touchesDistStart=a.sqrt(g*g+f*f),this.originX=a.abs(c.touches[0].pageX+c.touches[1].pageX-this.wrapperOffsetLeft*2)/2-this.x,this.originY=
a.abs(c.touches[0].pageY+c.touches[1].pageY-this.wrapperOffsetTop*2)/2-this.y,this.options.onZoomStart&&this.options.onZoomStart.call(this,c);if(this.options.momentum&&(this.options.useTransform?(f=getComputedStyle(this.scroller,null)[b+"Transform"].replace(/[^0-9-.,]/g,"").split(","),g=f[4]*1,f=f[5]*1):(g=getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,"")*1,f=getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")*1),g!=this.x||f!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):
m(this.aniTime),this.steps=[],this._pos(g,f);this.absStartX=this.x;this.absStartY=this.y;this.startX=this.x;this.startY=this.y;this.pointX=e.pageX;this.pointY=e.pageY;this.startTime=c.timeStamp||(new Date).getTime();this.options.onScrollStart&&this.options.onScrollStart.call(this,c);this._bind(l);this._bind(o);this._bind(p)}},_move:function(c){var e=d?c.touches[0]:c,f=e.pageX-this.pointX,g=e.pageY-this.pointY,h=this.x+f,j=this.y+g,i=c.timeStamp||(new Date).getTime();this.options.onBeforeScrollMove&&
this.options.onBeforeScrollMove.call(this,c);if(this.options.zoom&&d&&c.touches.length>1)h=a.abs(c.touches[0].pageX-c.touches[1].pageX),j=a.abs(c.touches[0].pageY-c.touches[1].pageY),this.touchesDist=a.sqrt(h*h+j*j),this.zoomed=!0,e=1/this.touchesDistStart*this.touchesDist*this.scale,e<this.options.zoomMin?e=0.5*this.options.zoomMin*Math.pow(2,e/this.options.zoomMin):e>this.options.zoomMax&&(e=2*this.options.zoomMax*Math.pow(0.5,this.options.zoomMax/e)),this.lastScale=e/this.scale,h=this.originX-
this.originX*this.lastScale+this.x,j=this.originY-this.originY*this.lastScale+this.y,this.scroller.style[b+"Transform"]=s+h+"px,"+j+"px"+w+" scale("+e+")",this.options.onZoom&&this.options.onZoom.call(this,c);else{this.pointX=e.pageX;this.pointY=e.pageY;if(h>0||h<this.maxScrollX)h=this.options.bounce?this.x+f/2:h>=0||this.maxScrollX>=0?0:this.maxScrollX;if(j>this.minScrollY||j<this.maxScrollY)j=this.options.bounce?this.y+g/2:j>=this.minScrollY||this.maxScrollY>=0?this.minScrollY:this.maxScrollY;if(this.absDistX<
6&&this.absDistY<6)this.distX+=f,this.distY+=g,this.absDistX=a.abs(this.distX),this.absDistY=a.abs(this.distY);else{if(this.options.lockDirection)if(this.absDistX>this.absDistY+5)j=this.y,g=0;else if(this.absDistY>this.absDistX+5)h=this.x,f=0;this.moved=!0;this._pos(h,j);this.dirX=f>0?-1:f<0?1:0;this.dirY=g>0?-1:g<0?1:0;if(i-this.startTime>300)this.startTime=i,this.startX=this.x,this.startY=this.y;this.options.onScrollMove&&this.options.onScrollMove.call(this,c)}}},_end:function(c){if(!(d&&c.touches.length!=
0)){var e=this,f=d?c.changedTouches[0]:c,g,h,j={dist:0,time:0},i={dist:0,time:0},m=(c.timeStamp||(new Date).getTime())-e.startTime,k=e.x,n=e.y;e._unbind(l);e._unbind(o);e._unbind(p);e.options.onBeforeScrollEnd&&e.options.onBeforeScrollEnd.call(e,c);if(e.zoomed)k=e.scale*e.lastScale,k=Math.max(e.options.zoomMin,k),k=Math.min(e.options.zoomMax,k),e.lastScale=k/e.scale,e.scale=k,e.x=e.originX-e.originX*e.lastScale+e.x,e.y=e.originY-e.originY*e.lastScale+e.y,e.scroller.style[b+"TransitionDuration"]="200ms",
e.scroller.style[b+"Transform"]=s+e.x+"px,"+e.y+"px"+w+" scale("+e.scale+")",e.zoomed=!1,e.refresh(),e.options.onZoomEnd&&e.options.onZoomEnd.call(e,c);else{if(e.moved){if(m<300&&e.options.momentum){j=k?e._momentum(k-e.startX,m,-e.x,e.scrollerW-e.wrapperW+e.x,e.options.bounce?e.wrapperW:0):j;i=n?e._momentum(n-e.startY,m,-e.y,e.maxScrollY<0?e.scrollerH-e.wrapperH+e.y-e.minScrollY:0,e.options.bounce?e.wrapperH:0):i;k=e.x+j.dist;n=e.y+i.dist;if(e.x>0&&k>0||e.x<e.maxScrollX&&k<e.maxScrollX)j={dist:0,
time:0};if(e.y>e.minScrollY&&n>e.minScrollY||e.y<e.maxScrollY&&n<e.maxScrollY)i={dist:0,time:0}}if(j.dist||i.dist){j=a.max(a.max(j.time,i.time),10);if(e.options.snap)i=k-e.absStartX,m=n-e.absStartY,a.abs(i)<e.options.snapThreshold&&a.abs(m)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(i=e._snap(k,n),k=i.x,n=i.y,j=a.max(i.time,j));e.scrollTo(k,n,j)}else e.options.snap?(i=k-e.absStartX,m=n-e.absStartY,a.abs(i)<e.options.snapThreshold&&a.abs(m)<e.options.snapThreshold?e.scrollTo(e.absStartX,
e.absStartY,200):(i=e._snap(e.x,e.y),(i.x!=e.x||i.y!=e.y)&&e.scrollTo(i.x,i.y,i.time))):e._resetPos(200)}else{if(d)e.doubleTapTimer&&e.options.zoom?(clearTimeout(e.doubleTapTimer),e.doubleTapTimer=null,e.options.onZoomStart&&e.options.onZoomStart.call(e,c),e.zoom(e.pointX,e.pointY,e.scale==1?e.options.doubleTapZoom:1),e.options.onZoomEnd&&setTimeout(function(){e.options.onZoomEnd.call(e,c)},200)):e.doubleTapTimer=setTimeout(function(){e.doubleTapTimer=null;for(g=f.target;g.nodeType!=1;)g=g.parentNode;
if(g.tagName!="SELECT"&&g.tagName!="INPUT"&&g.tagName!="TEXTAREA")h=document.createEvent("MouseEvents"),h.initMouseEvent("click",!0,!0,c.view,1,f.screenX,f.screenY,f.clientX,f.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null),h._fake=!0,g.dispatchEvent(h)},e.options.zoom?250:0);e._resetPos(200)}e.options.onTouchEnd&&e.options.onTouchEnd.call(e,c)}}},_resetPos:function(a){var c=this.x>=0?0:this.x<this.maxScrollX?this.maxScrollX:this.x,d=this.y>=this.minScrollY||this.maxScrollY>0?this.minScrollY:
this.y<this.maxScrollY?this.maxScrollY:this.y;if(c==this.x&&d==this.y){if(this.moved)this.moved=!1,this.options.onScrollEnd&&this.options.onScrollEnd.call(this);if(this.hScrollbar&&this.options.hideScrollbar)b=="webkit"&&(this.hScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),this.hScrollbarWrapper.style.opacity="0";if(this.vScrollbar&&this.options.hideScrollbar)b=="webkit"&&(this.vScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),this.vScrollbarWrapper.style.opacity="0"}else this.scrollTo(c,
d,a||0)},_wheel:function(a){var b=this,c,d;"wheelDeltaX"in a?(c=a.wheelDeltaX/12,d=a.wheelDeltaY/12):c="detail"in a?d=-a.detail*3:d=-a.wheelDelta;if(b.options.wheelAction=="zoom"){d=b.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0));if(d<b.options.zoomMin)d=b.options.zoomMin;if(d>b.options.zoomMax)d=b.options.zoomMax;d!=b.scale&&(!b.wheelZoomCount&&b.options.onZoomStart&&b.options.onZoomStart.call(b,a),b.wheelZoomCount++,b.zoom(a.pageX,a.pageY,d,400),setTimeout(function(){b.wheelZoomCount--;!b.wheelZoomCount&&
b.options.onZoomEnd&&b.options.onZoomEnd.call(b,a)},400))}else{c=b.x+c;d=b.y+d;if(c>0)c=0;else if(c<b.maxScrollX)c=b.maxScrollX;if(d>b.minScrollY)d=b.minScrollY;else if(d<b.maxScrollY)d=b.maxScrollY;b.scrollTo(c,d,0)}},_mouseout:function(a){var b=a.relatedTarget;if(b)for(;b=b.parentNode;)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){a.target==this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var b=this,c=b.x,d=b.y,e=(new Date).getTime(),
f,g;if(!b.animating)if(b.steps.length){f=b.steps.shift();if(f.x==c&&f.y==d)f.time=0;b.animating=!0;b.moved=!0;b.options.useTransition?(b._transitionTime(f.time),b._pos(f.x,f.y),b.animating=!1,f.time?b._bind("webkitTransitionEnd"):b._resetPos(0)):function da(){var h=(new Date).getTime();if(h>=e+f.time)b._pos(f.x,f.y),b.animating=!1,b.options.onAnimationEnd&&b.options.onAnimationEnd.call(b),b._startAni();else if(h=(h-e)/f.time-1,g=a.sqrt(1-h*h),h=(f.x-c)*g+c,b._pos(h,(f.y-d)*g+d),b.animating)b.aniTime=
i(da)}()}else b._resetPos(400)},_transitionTime:function(a){a+="ms";this.scroller.style[b+"TransitionDuration"]=a;this.hScrollbar&&(this.hScrollbarIndicator.style[b+"TransitionDuration"]=a);this.vScrollbar&&(this.vScrollbarIndicator.style[b+"TransitionDuration"]=a)},_momentum:function(b,c,d,e,f){var c=a.abs(b)/c,g=c*c/0.0012,h=0,h=0;b>0&&g>d?(d+=f/(6/(g/c*6.0E-4)),c=c*d/g,g=d):b<0&&g>e&&(e+=f/(6/(g/c*6.0E-4)),c=c*e/g,g=e);g*=b<0?-1:1;return{dist:g,time:a.round(c/6.0E-4)}},_offset:function(a){for(var b=
-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;a!=this.wrapper&&(b*=this.scale,c*=this.scale);return{left:b,top:c}},_snap:function(b,c){var d,e,f;f=this.pagesX.length-1;d=0;for(e=this.pagesX.length;d<e;d++)if(b>=this.pagesX[d]){f=d;break}f==this.currPageX&&f>0&&this.dirX<0&&f--;b=this.pagesX[f];e=(e=a.abs(b-this.pagesX[this.currPageX]))?a.abs(this.x-b)/e*500:0;this.currPageX=f;f=this.pagesY.length-1;for(d=0;d<f;d++)if(c>=this.pagesY[d]){f=d;break}f==this.currPageY&&
f>0&&this.dirY<0&&f--;c=this.pagesY[f];d=(d=a.abs(c-this.pagesY[this.currPageY]))?a.abs(this.y-c)/d*500:0;this.currPageY=f;f=a.round(a.max(e,d))||200;return{x:b,y:c,time:f}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){this.scroller.style[b+"Transform"]="";this.vScrollbar=this.hScrollbar=!1;this._scrollbar("h");this._scrollbar("v");this._unbind(k,window);this._unbind(n);this._unbind(l);
this._unbind(o);this._unbind(p);this.options.hasTouch&&(this._unbind("mouseout",this.wrapper),this._unbind(r));this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.checkDOMChanges&&clearInterval(this.checkDOMTime);this.options.onDestroy&&this.options.onDestroy.call(this)},refresh:function(){var c,d,e,f=0;d=0;if(this.scale<this.options.zoomMin)this.scale=this.options.zoomMin;this.wrapperW=this.wrapper.clientWidth||1;this.wrapperH=this.wrapper.clientHeight||1;this.minScrollY=
-this.options.topOffset||0;this.scrollerW=a.round(this.scroller.offsetWidth*this.scale);this.scrollerH=a.round((this.scroller.offsetHeight+this.minScrollY)*this.scale);this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH+this.minScrollY;this.dirY=this.dirX=0;this.options.onRefresh&&this.options.onRefresh.call(this);this.hScroll=this.options.hScroll&&this.maxScrollX<0;this.vScroll=this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);
this.hScrollbar=this.hScroll&&this.options.hScrollbar;this.vScrollbar=this.vScroll&&this.options.vScrollbar&&this.scrollerH>this.wrapperH;c=this._offset(this.wrapper);this.wrapperOffsetLeft=-c.left;this.wrapperOffsetTop=-c.top;if(typeof this.options.snap=="string"){this.pagesX=[];this.pagesY=[];e=this.scroller.querySelectorAll(this.options.snap);c=0;for(d=e.length;c<d;c++)f=this._offset(e[c]),f.left+=this.wrapperOffsetLeft,f.top+=this.wrapperOffsetTop,this.pagesX[c]=f.left<this.maxScrollX?this.maxScrollX:
f.left*this.scale,this.pagesY[c]=f.top<this.maxScrollY?this.maxScrollY:f.top*this.scale}else if(this.options.snap){for(this.pagesX=[];f>=this.maxScrollX;)this.pagesX[d]=f,f-=this.wrapperW,d++;this.maxScrollX%this.wrapperW&&(this.pagesX[this.pagesX.length]=this.maxScrollX-this.pagesX[this.pagesX.length-1]+this.pagesX[this.pagesX.length-1]);d=f=0;for(this.pagesY=[];f>=this.maxScrollY;)this.pagesY[d]=f,f-=this.wrapperH,d++;this.maxScrollY%this.wrapperH&&(this.pagesY[this.pagesY.length]=this.maxScrollY-
this.pagesY[this.pagesY.length-1]+this.pagesY[this.pagesY.length-1])}this._scrollbar("h");this._scrollbar("v");this.zoomed||(this.scroller.style[b+"TransitionDuration"]="0",this._resetPos(200))},scrollTo:function(a,b,c,d){var e=a;this.stop();e.length||(e=[{x:a,y:b,time:c,relative:d}]);a=0;for(b=e.length;a<b;a++){if(e[a].relative)e[a].x=this.x-e[a].x,e[a].y=this.y-e[a].y;this.steps.push({x:e[a].x,y:e[a].y,time:e[a].time||0})}this._startAni()},scrollToElement:function(b,c){var d;if(b=b.nodeType?b:this.scroller.querySelector(b))d=
this._offset(b),d.left+=this.wrapperOffsetLeft,d.top+=this.wrapperOffsetTop,d.left=d.left>0?0:d.left<this.maxScrollX?this.maxScrollX:d.left,d.top=d.top>this.minScrollY?this.minScrollY:d.top<this.maxScrollY?this.maxScrollY:d.top,c=c===void 0?a.max(a.abs(d.left)*2,a.abs(d.top)*2):c,this.scrollTo(d.left,d.top,c)},scrollToPage:function(a,b,c){if(this.options.snap)a=a=="next"?this.currPageX+1:a=="prev"?this.currPageX-1:a,b=b=="next"?this.currPageY+1:b=="prev"?this.currPageY-1:b,a=a<0?0:a>this.pagesX.length-
1?this.pagesX.length-1:a,b=b<0?0:b>this.pagesY.length-1?this.pagesY.length-1:b,this.currPageX=a,this.currPageY=b,a=this.pagesX[a],b=this.pagesY[b];else{a*=-this.wrapperW;b*=-this.wrapperH;if(a<this.maxScrollX)a=this.maxScrollX;if(b<this.maxScrollY)b=this.maxScrollY}this.scrollTo(a,b,c||400)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(l);this._unbind(o);this._unbind(p)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):
m(this.aniTime);this.steps=[];this.animating=this.moved=!1},zoom:function(a,c,d,e){var f=d/this.scale;if(this.options.useTransform)this.zoomed=!0,e=e===void 0?200:e,a=a-this.wrapperOffsetLeft-this.x,c=c-this.wrapperOffsetTop-this.y,this.x=a-a*f+this.x,this.y=c-c*f+this.y,this.scale=d,this.refresh(),this.x=this.x>0?0:this.x<this.maxScrollX?this.maxScrollX:this.x,this.y=this.y>this.minScrollY?this.minScrollY:this.y<this.maxScrollY?this.maxScrollY:this.y,this.scroller.style[b+"TransitionDuration"]=e+
"ms",this.scroller.style[b+"Transform"]=s+this.x+"px,"+this.y+"px"+w+" scale("+d+")",this.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};typeof exports!=="undefined"?exports.iScroll=h:window.iScroll=h})();
var ia=ia||{log:function(a){window.console&&window.console.log&&window.console.log(a);ia.isTouchDevice()&&$j("#ia-debug-container").append("<span style='color:green'><br/>&gt; "+a+"</span>")},isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},parseInt:function(a,b){return parseInt(a,b||10)},extend:function(a,b){function c(){}c.prototype=a.prototype;b.prototype=new c;b.prototype.constructor=b;b.baseConstructor=a;b.superClass=a.prototype},Quicksort:function(a,b,c,d){var e,f,g,h;if(d-c==
1)a[c][b]>a[d][b]&&(h=a[c],a[c]=a[d],a[d]=h);else{e=a[ia.parseInt((c+d)/2)];a[ia.parseInt((c+d)/2)]=a[c];a[c]=e;f=c+1;g=d;do{for(;f<=g&&a[f][b]<=e[b];)f++;for(;a[g][b]>e[b];)g--;f<g&&(h=a[f],a[f]=a[g],a[g]=h)}while(f<g);a[c]=a[g];a[g]=e;c<g-1&&ia.Quicksort(a,b,c,g-1);g+1<d&&ia.Quicksort(a,b,g+1,d)}},proxyMapStem:"../",proxyMaps:void 0,useProxy:!1,accessToken:"",addProxy:function(a,b){if(ia.proxyMaps==void 0)ia.proxyMaps={};ia.proxyMaps[a]=b},getDomainSafeUrl:function(a){var b=a;if(ia.useProxy){var c=
a.indexOf("://")+3,c=a.substring(0,a.indexOf("/",c)+1);ia.proxyMaps&&ia.proxyMaps[c]&&(b=a.replace(c,ia.proxyMapStem+ia.proxyMaps[c]))}return b},getNiceNum:function(a,b){var c=Math.floor(ia.log10(a)),d=a/Math.pow(10,c);return(b?d<1.5?1:d<3?2:d<7?5:10:d<=1?1:d<=2?2:d<=5?5:10)*Math.pow(10,c)},log10:function(a){return Math.log(a)/Math.LN10},round:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},disableTextSelection:function(a){a=a.get(0);typeof a.onselectstart!="undefined"?a.onselectstart=
function(){return!1}:typeof a.style.MozUserSelect!="undefined"?a.style.MozUserSelect="none":a.onmousedown=function(){return!1}},enableTextSelection:function(a){a=a.get(0);typeof a.onselectstart!="undefined"?a.onselectstart=function(){return!0}:typeof a.style.MozUserSelect!="undefined"?a.style.MozUserSelect="text":a.onmousedown=function(){return!0}},loadCssfile:function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css";c.appendChild(d);ia.File.load(a,
"text",function(a){d.appendChild(document.createTextNode(a));b!=void 0&&b.call(null)})},getPrecision:function(a){for(var b=0,c=a.length-1,d=0;d<c;d++){var e=a[d],f=Math.abs(a[d+1]-e);f>0&&f<1?(e=String(f).split(".")[1],f=e.indexOf("e"),f!=-1?(f=e.indexOf("+")!=-1?f+2:f+1,e=e.substr(f)):(f=String(ia.parseInt(e)),e=e.length-f.length+1),e>b&&(b=e)):String(e).indexOf(".")>-1&&(e=1,e>b&&(b=e))}return b},callFunction:function(a,b,c){var d="none";a.indexOf("script")==0||a.indexOf("javascript")==0?(d=a.split(":")[0],
a=a.substring(a.indexOf(":")+1).split(";")):a=a.split(";");for(var e=0;e<a.length;e++)a[e]&&ia.processFunction(a[e],d,b,c)},processFunction:function(a,b,c,d){var e=[];if(b=="script"||b=="javascript"){if(a.indexOf("(")!=-1){if(b=jQuery.trim(a.substring(0,a.indexOf("("))),a=a.substring(a.indexOf("(")+1,a.indexOf(")")),a!=""){e=a.split(",");for(a=0;a<e.length;a++)c=jQuery.trim(e[a]),c.indexOf("'")==0&&c.lastIndexOf("'")==c.length-1?c=c.substr(1,c.length-2):c.indexOf('"')==0&&c.lastIndexOf('"')==c.length-
1&&(c=c.substr(1,c.length-2)),ia.isNumber(c)&&(c=parseFloat(c)),e[a]=c}}else b=jQuery.trim(a);d&&(e[e.length]=d);window[b].apply(null,e)}else c==void 0&&(c="_blank"),window.open(a,c)},supportsCanvas:function(){return!!document.createElement("canvas").getContext},isTouchDevice:function(){return"ontouchstart"in window},disableDefaultTouch:function(){if(ia.isTouchDevice())document.body.addEventListener("touchstart touchend touchmove",function(a){a.preventDefault()},!1),document.ontouchmove=function(a){a.preventDefault()}},
showWaitCursor:function(){$j("body").css("cursor","wait")},showDefaultCursor:function(){document.onselectstart=function(){return ia.useTextSelection};$j("body").css("cursor","default")},showCursor:function(a){document.onselectstart=function(){return!1};$j("body").css("cursor",a)},showMoveCursor:function(){document.onselectstart=function(){return!1};$j("body").css("cursor","move")},showPointerCursor:function(){$j("body").css("cursor","pointer")},useTextSelection:document.onselectstart,IAS_PATH:"",
CLICK_TYPE:"click",MOUSE_DOWN_TYPE:"mousedown",IS_TOUCH_DEVICE:!1,IS_IE_TEN:!1,SINGLE_MAP_REPORT:"timeseries_advanced_sm::flash::html",PYRAMID_REPORT:"timeseries_advanced_sm::flash::pyramid::html",SPINE_REPORT:"areaprofiler::flash::html",ELECTION_REPORT:"areaprofiler::flash::election::html",DOUBLE_GEOG_REPORT:"double_timeseries_advanced_dm::flash::html",DOUBLE_BASELAYER_REPORT:"double_timeseries_advanced_dm::flash::double_base::html",DOUBLE_BASELAYER_REPORT_NEW:"double_timeseries_advanced_dm::flash::double_base_new::html",
DOUBLE_PLOT_REPORT:"timeseries_advanced_dm::flash::html",BUBBLE_PLOT_REPORT:"bubbleplot::flash::html",BUBBLE_PLOT_REPORT_SINGLE:"bubbleplot::flash::html::single"};
(function(){function a(){var a=new ia.CalloutBox("shareCallout","top-bottom");a.popup(!0);f.addCallout(a);var b=$j("<div></div>");a.container.append(b);a=$j("<div></div>").html(f.config.getProperty("emailReportText"));b.append(a);a=$j('<input type="text" style="width:100%" class="ia-input" value="'+document.URL+'"/>');b.append(a);a.bind(ia.CLICK_TYPE,function(){this.select()});a=$j("<br/><br/>");b.append(a);a=$j("<div></div>").html(f.config.getProperty("embedReportText"));b.append(a);a=$j('<input type="text" style="width:100%" class="ia-input" value="'+
("<iframe src='"+document.URL+"' style='width:800px;height:600px;border-width:0px'></iframe>")+'"/>');b.append(a);a.bind(ia.CLICK_TYPE,function(){this.select()})}function b(){clearTimeout(g);g=setTimeout(function(){clearTimeout(g);ia.log("renderDoubleComponents");var a=e[0],b=e[1],c=f.getWidget("scatterPlot-panel");if(c){var d=f.config.getComponent("scatterPlot"),k=f.getComponent("scatterPlot"),n=k.getLayers(),l=n[0],n=n[1],o=a.indicator.getDataType(l.xDataField),p=b.indicator.getDataType(l.yDataField);
if(o==ia.Thematic.CATEGORIC||p==ia.Thematic.CATEGORIC)k.hide(),c.text(d.getProperty("notAvailableText"));else{o=a.indicator.getProperty(d.getProperty("minChartValue"));p=a.indicator.getProperty(d.getProperty("maxChartValue"));o&&p?(k.useFixedValues=!0,k.useTightLabels=!0,k.fixedMinValue=o,k.fixedMaxValue=p):(k.useFixedValues=d.getProperty("useFixedValues"),k.useFixedValues?(k.useTightLabels=!0,k.fixedMinValue=d.getProperty("fixedMinValue"),k.fixedMaxValue=d.getProperty("fixedMaxValue")):k.useTightLabels=
d.getProperty("useTightLabels"));if(o=d.getProperty("xAxisTitle"))k.xAxisTitle=f.textSubstitution.formatMessage(o);if(d=d.getProperty("yAxisTitle"))k.yAxisTitle=f.textSubstitution.formatMessage(d);k.show();c.text("");l.setXData(a.indicatorData);l.setYData(b.indicatorData);n.setXData(a.comparisonData);n.setYData(b.comparisonData);k.render();c=f.locale.formatter;l=l.correlationInfo;f.textSubstitution.setVariable("correlationCoeff",c.format(l.correlationCoeff,2));f.textSubstitution.setVariable("rSquare",
c.format(l.rSquare,2));f.textSubstitution.setVariable("gradient",c.format(l.gradient,2));f.textSubstitution.setVariable("intercept",c.format(l.intercept,2));f.updateDynamicText(f.textSubstitution)}}if(c=f.getWidget("table-panel"))l=f.config.getTable("table"),c=f.getComponent("table"),c.columns=l.getColumnsForIndicator(a.indicator,f.textSubstitution,[b.indicator]),c.setData(a.indicatorData),c.data2=b.indicatorData,c.render(),l.getProperty("sortColumnName")!=""&&(c.sort(l.getProperty("sortColumnName"),
l.getProperty("sortDirection")),l.setProperty("sortColumnName",""));if(c=f.getWidget("comparisonTable-panel"))l=f.config.getTable("comparisonTable"),c=f.getComponent("comparisonTable"),c.columns=l.getColumnsForIndicator(a.indicator,f.textSubstitution,[b.indicator]),c.setData(a.comparisonData),c.data2=b.comparisonData,c.render(),l.getProperty("sortColumnName")!=""&&(c.sort(l.getProperty("sortColumnName"),l.getProperty("sortDirection")),l.setProperty("sortColumnName",""))},250)}function c(){clearTimeout(g);
g=setTimeout(function(){clearTimeout(g);ia.log("renderBubbleComponents");var a=e[0],b=e[1],c=e[2],d=e[3],k=f.getWidget("scatterPlot-panel");if(k){var n=f.config.getComponent("scatterPlot"),l=f.getComponent("scatterPlot"),o=l.getLayers(),p=o[0],o=o[1],r=c.indicator.getDataType(p.xDataField),s=d.indicator.getDataType(p.yDataField);if(r==ia.Thematic.CATEGORIC||s==ia.Thematic.CATEGORIC)l.hide(),k.text(n.getProperty("notAvailableText"));else{r=a.indicator.getProperty(n.getProperty("minChartValue"));s=
a.indicator.getProperty(n.getProperty("maxChartValue"));r&&s?(l.useFixedValues=!0,l.useTightLabels=!0,l.fixedMinValue=r,l.fixedMaxValue=s):(l.useFixedValues=n.getProperty("useFixedValues"),l.useFixedValues?(l.useTightLabels=!0,l.fixedMinValue=n.getProperty("fixedMinValue"),l.fixedMaxValue=n.getProperty("fixedMaxValue")):l.useTightLabels=n.getProperty("useTightLabels"));if(r=n.getProperty("xAxisTitle"))l.xAxisTitle=f.textSubstitution.formatMessage(r);if(r=n.getProperty("yAxisTitle"))l.yAxisTitle=f.textSubstitution.formatMessage(r);
l.show();k.text("");p.setXData(c.indicatorData);p.setYData(d.indicatorData);p.setColorData(a.indicatorData);n.getProperty("sizeData")!=void 0&&p.setSizeData(b.indicatorData);o.setXData(c.comparisonData);o.setYData(d.comparisonData);o.setColorData(a.comparisonData);n.getProperty("sizeData")!=void 0&&o.setSizeData(b.comparisonData);l.render();k=f.locale.formatter;p=p.correlationInfo;f.textSubstitution.setVariable("correlationCoeff",k.format(p.correlationCoeff,2));f.textSubstitution.setVariable("rSquare",
k.format(p.rSquare,2));f.textSubstitution.setVariable("gradient",k.format(p.gradient,2));f.textSubstitution.setVariable("intercept",k.format(p.intercept,2));f.updateDynamicText(f.textSubstitution)}}if(k=f.getWidget("table-panel"))p=f.config.getTable("table"),k=f.getComponent("table"),k.columns=p.getColumnsForIndicator(a.indicator,f.textSubstitution,[b.indicator,c.indicator,d.indicator]),k.setData(a.indicatorData),k.data2=b.indicatorData,k.data3=c.indicatorData,k.data4=d.indicatorData,k.render(),p.getProperty("sortColumnName")!=
""&&(k.sort(p.getProperty("sortColumnName"),p.getProperty("sortDirection")),p.setProperty("sortColumnName",""));if(k=f.getWidget("comparisonTable-panel"))p=f.config.getTable("comparisonTable"),k=f.getComponent("comparisonTable"),k.columns=p.getColumnsForIndicator(a.indicator,f.textSubstitution,[b.indicator,c.indicator,d.indicator]),k.setData(a.comparisonData),k.data2=b.comparisonData,k.data3=c.comparisonData,k.data4=d.comparisonData,k.render(),p.getProperty("sortColumnName")!=""&&(k.sort(p.getProperty("sortColumnName"),
p.getProperty("sortDirection")),p.setProperty("sortColumnName",""))},250)}function d(){var a=f.getComponent("gMap"),b=f.getComponent("gMap2");if(a&&b){var c=!1,d=!1;google.maps.event.addListener(a.gMap,"bounds_changed",function(){d==!1&&(c=!0,b.gMap.setZoom(a.gMap.getZoom()),b.gMap.setCenter(a.gMap.getCenter()))});google.maps.event.addListener(a.gMap,"idle",function(){c=!1});google.maps.event.addListener(b.gMap,"bounds_changed",function(){c==!1&&(d=!0,a.gMap.setZoom(b.gMap.getZoom()),a.gMap.setCenter(b.gMap.getCenter()))});
google.maps.event.addListener(b.gMap,"idle",function(){d=!1})}else if(a=f.getComponent("map"),b=f.getComponent("map2"),a&&b){var e=!1,g=function(a){e==!1&&(e=!0,b.controller.zoomToBBox(a.bBox),e=!1)};a.addEventListener(ia.BBoxEvent.BBOX_TRANSLATE,g);a.addEventListener(ia.BBoxEvent.BBOX_SCALE,g);g=function(b){e==!1&&(e=!0,a.controller.zoomToBBox(b.bBox),e=!1)};b.addEventListener(ia.BBoxEvent.BBOX_TRANSLATE,g);b.addEventListener(ia.BBoxEvent.BBOX_SCALE,g)}}var e=[],f;ia.readingWebMap=!1;ia.init=function(g,
j,i){function m(){var a,b;a=(new Date).getTime();f.config.loadSource(f.url.params.config,function(){b=(new Date).getTime();ia.log("config.xml : "+(b-a)+" ms");for(var c in f.url.params){if(c.indexOf("prop_")==0){var d=c.split("_")[1],e=f.url.params[c];f.config.setProperty(d,e)}if(c.indexOf("comp_")==0){var g=c.split("_")[1],d=c.split("_")[2],e=f.url.params[c],g=f.config.getComponent(g);g!=void 0&&(g.setProperty(d,e),g[d]=e)}c.indexOf("pal_")==0&&(g=f.config.getMapPalette(),d=c.split("_")[1],e=f.url.params[c],
g[d]=e)}f.build(k)})}function k(){t1=(new Date).getTime();f.data.loadSource(f.url.params.dataPath+f.url.params.data,n)}function n(){t2=(new Date).getTime();ia.log("data : "+(t2-t1)+" ms");var d=f.config.getProperty("selectionMode"),g=new ia.InteractionGroup;if(d)g.selectionMode=d;var h=new ia.InteractionGroup,j=new ia.DataGroup(f,"",g,h);e[e.length]=j;f.addComponent("dataGroup",j);j.build(function(){if(f.config.template==ia.SINGLE_MAP_REPORT||f.config.template==ia.PYRAMID_REPORT||f.config.template==
ia.SPINE_REPORT||f.config.template==ia.ELECTION_REPORT||f.config.template==ia.BUBBLE_PLOT_REPORT_SINGLE)l();else{var a;if(f.config.template==ia.DOUBLE_GEOG_REPORT){var i=new ia.InteractionGroup;if(d)i.selectionMode=d;var k=new ia.InteractionGroup;a=new ia.DataGroup(f,"2",i,k);e[e.length]=a;f.addComponent("dataGroup2",a);i=f.config.getComponent("dataExplorer2");i==void 0&&j.addEventListener(ia.DataEvent.INDICATOR_CHANGED,function(){a.setData(a.geography.id,j.indicator.id,j.indicator.date)});i=f.config.getButton("filterExplorer2");
i==void 0&&j.addEventListener(ia.FilterEvent.FILTER_CHANGED,function(b){b.filterId!=""?a.setFilter(b.filterId,b.filterValue):a.clearFilter()});a.build(l)}else if(f.config.template==ia.DOUBLE_PLOT_REPORT)a=new ia.DataGroup(f,"2",g,h),e[e.length]=a,f.addComponent("dataGroup2",a),j.addEventListener(ia.DataEvent.GEOG_CHANGED,function(b){r=!0;a.setData(b.geography.id,a.indicator.id,a.indicator.date)}),j.addEventListener(ia.FilterEvent.FILTER_CHANGED,function(){p=!0;a.refresh()}),(i=f.config.getComponent("dataExplorer"))&&
i.getProperty("syncDates")==!0&&j.addEventListener(ia.DataEvent.INDICATOR_CHANGED,function(b){a.setData(b.geography.id,a.indicator.id,j.indicator.date)}),j.addEventListener(ia.Event.RENDER,function(){p==!1&&r==!1&&b()}),a.addEventListener(ia.Event.RENDER,function(){p=r=!1;b()}),a.build(l);else if(f.config.template==ia.BUBBLE_PLOT_REPORT){a=new ia.DataGroup(f,"2",g,h);e[e.length]=a;f.addComponent("dataGroup2",a);var m=new ia.DataGroup(f,"3",g,h);e[e.length]=m;f.addComponent("dataGroup3",m);var n=new ia.DataGroup(f,
"4",g,h);e[e.length]=n;f.addComponent("dataGroup4",n);j.addEventListener(ia.DataEvent.GEOG_CHANGED,function(b){r=!0;a.setData(b.geography.id,a.indicator.id,a.indicator.date);m.setData(b.geography.id,m.indicator.id,m.indicator.date);n.setData(b.geography.id,n.indicator.id,n.indicator.date)});j.addEventListener(ia.FilterEvent.FILTER_CHANGED,function(){p=!0;a.refresh();m.refresh();n.refresh()});(i=f.config.getComponent("dataExplorer"))&&i.getProperty("syncDates")==!0&&j.addEventListener(ia.DataEvent.INDICATOR_CHANGED,
function(b){a.setData(b.geography.id,a.indicator.id,j.indicator.date);m.setData(b.geography.id,m.indicator.id,j.indicator.date);n.setData(b.geography.id,n.indicator.id,j.indicator.date)});j.addEventListener(ia.Event.RENDER,function(){p==!1&&r==!1&&c()});a.addEventListener(ia.Event.RENDER,function(){p==!1&&r==!1&&c()});m.addEventListener(ia.Event.RENDER,function(){p==!1&&r==!1&&c()});n.addEventListener(ia.Event.RENDER,function(){p=r=!1;c()});a.build(function(){m.build(function(){n.build(l)})})}else if(f.config.template==
ia.DOUBLE_BASELAYER_REPORT_NEW)a=new ia.DataGroup(f,"2",g,h),e[e.length]=a,f.addComponent("dataGroup2",a),j.addEventListener(ia.DataEvent.INDICATOR_CHANGED,function(){a.setData(a.geography.id,j.indicator.id,j.indicator.date)}),a.addEventListener(ia.Event.RENDER,function(){var a=f.getComponent("map");a&&a.render();b()}),a.build(l);else if(f.config.template==ia.DOUBLE_BASELAYER_REPORT){i=new ia.InteractionGroup;if(d)i.selectionMode=d;k=new ia.InteractionGroup;a=new ia.DataGroup(f,"2",i,k);e[e.length]=
a;f.addComponent("dataGroup2",a);a.addEventListener(ia.Event.RENDER,function(){var a=f.getComponent("map");a&&a.render();b()});i=f.config.getComponent("dataExplorer2");i==void 0&&j.addEventListener(ia.DataEvent.INDICATOR_CHANGED,function(){a.setData(a.geography.id,j.indicator.id,j.indicator.date)});i=f.config.getButton("filterExplorer2");i==void 0&&j.addEventListener(ia.FilterEvent.FILTER_CHANGED,function(b){b.filterId!=""?a.setFilter(b.filterId,b.filterValue):a.clearFilter()});a.build(l)}}});a();
addHelp()}function l(){ia.log("onReportComplete");if(f.config.template==ia.DOUBLE_GEOG_REPORT||f.config.template==ia.DOUBLE_PLOT_REPORT){var a=f.config.getComponent("map");a&&a.getProperty("syncMaps")&&d();b()}else if(f.config.template==ia.DOUBLE_BASELAYER_REPORT_NEW)(a=f.getComponent("map"))&&a.render(),b();else if(f.config.template==ia.DOUBLE_BASELAYER_REPORT)(a=f.getComponent("map"))&&a.render();else if(f.config.template==ia.BUBBLE_PLOT_REPORT&&(c(),f.url.params.select)){var a=f.getComponent("interactionGroup"),
e=f.url.params.select.split(",");a.setSelection(e)}f.isLoaded=!0;if(f.url.params.custom)f._callbackFunction=onIAReportComplete;f.removeLoadingPage()}f=new ia.Report(new ia.ReportConfig,$j("#"+g),j);if(BrowserDetect.browser=="Explorer"&&BrowserDetect.version=="10")ia.IS_IE_TEN=!0;if(ia.isTouchDevice())ia.IS_TOUCH_DEVICE=!0,ia.CLICK_TYPE="touchend",ia.MOUSE_DOWN_TYPE="touchstart";$j.support.cors=!0;f.url=new ia.UrlParams(window.location.href);f.url.params.style&&ia.loadCssfile(f.url.params.style+".css");
f.url.params.config=f.url.params.config||"config";f.url.params.dataPath=f.url.params.dataPath||"";f.url.params.map=f.url.params.map||"map";f.url.params.data=f.url.params.data||"data";if(f.url.params.custom=f.url.params.custom)g=document.createElement("script"),g.type="text/javascript",g.src=f.url.params.custom+".js",document.body.appendChild(g);f.url.params.printmode&&(f.container.addClass("ia-report-printmode"),g=new ia.PrintBar(f),g.render(),$j("body").prepend(g.container));f.url.params.appid=f.url.params.appid||
"";f.url.params.webmap=f.url.params.webmap||"";if(i){i.style&&ia.loadCssfile(i.style+".css");f.url.params.config=i.config||f.url.params.config;f.url.params.dataPath=i.dataPath||f.url.params.dataPath;f.url.params.map=i.map||f.url.params.map;f.url.params.data=i.data||f.url.params.data;ia.File.errorHandler=i.errorHandler;ia.IAS_PATH=ia.File.getFileDirectory(f.url.params.config);for(var o in i)!f.url.params[o]&&o!="errorHandler"&&o!="style"&&o!="printmode"&&(f.url.params[o]=i[o])}if(f.url.params.webmap!=
"")f.url.params.data="http://www.arcgis.com/sharing/rest/content/items/"+f.url.params.webmap+"/data?f=json",f.url.params.config+=".xml",m();else if(f.url.params.appid!="")if(ia.readingWebMap)g="http://www.arcgis.com/sharing/rest/content/items/"+f.url.params.appid+"/data?f=json",ia.File.load(g,"json",function(a){f.url.params.data="http://www.arcgis.com/sharing/rest/content/items/"+a.values.webmap+"/data?f=json";f.url.params.config=a.values.template||"config";f.url.params.config+=".xml";var b=a.values.fontFamily||
"Arial",c=a.values.fontSize||"14",d=a.values.padding||"10",a=ia.Color.toHSVA(a.values.theme||"#A6DADE"),a=ia.Color.toRGBA(a),e=ia.Color.lighten(a,0.1),e=ia.Color.desaturate(e,0.8),g=ia.Color.lighten(a,0.2),g=ia.Color.desaturate(g,0.9),h=ia.Color.darken(a,0.5),j=ia.Color.saturate(a,1),j=ia.Color.triad(j)[0],i=ia.Color.darken(j,0.3);less.modifyVars({"@font-size":c+"px","@font-family":b,"@padding":d+"px","@text-color":ia.Color.toHex(h),"@dark-color":ia.Color.toHex(a),"@medium-color":ia.Color.toHex(e),
"@light-color":ia.Color.toHex(g),"@highlight-color":ia.Color.toHex(j),"@selection-color":ia.Color.toHex(i),"@background-color":ia.Color.toHex("#ffffff")});m()});else{if(window.location.hash){g=window.location.hash.substring(1).split("&");for(j=0;j<g.length;j++)if(g[j].substring(0,13)=="access_token=")ia.accessToken=g[j].substring(13)}g="https://www.arcgis.com/sharing/rest/content/items/"+f.url.params.appid+"?f=json";ia.File.load(g,"json",function(a){if(a.error==void 0)document.title=a.title});g="https://www.arcgis.com/sharing/rest/content/items/"+
f.url.params.appid+"/info/";j=g+"defaultcss.txt";f.url.params.config=g+f.url.params.config+".xml";f.url.params.map=g+f.url.params.map+".json";f.url.params.data=g+f.url.params.data+".json";ia.log(j);ia.log(f.url.params.config);ia.log(f.url.params.map);ia.log(f.url.params.data);ia.loadCssfile(j,function(){m()})}else f.url.params.config+=".xml",f.url.params.data+=".js",f.url.params.map+=".js",m();var p=!1,r=!1;$j("body").keydown(function(a){a.which==73&&a.ctrlKey==!0&&(a="About This InstantAtlas Report",
a+="\n___________________________________________________________\n",a+="\nTemplate",a+="\n",a+="\nName: "+f.template,a+="\nVersion: "+f.version,a+="\nEvaluation: "+f.evaluation,a+="\nUID: "+f.uid,a+="\n___________________________________________________________\n",a+="\nConfig",a+="\n",a+="\nName: "+f.config.name,a+="\nVersion: "+f.config.version,a+="\nId: "+f.config.template,alert(a))});for(o in i)!f.url.params[o]&&o!="errorHandler"&&o!="style"&&o!="printmode"&&(f.url.params[o]=i[o])};ia.loadData=
function(a){f.data.loadSource(a,function(){for(var a=0;a<e.length;a++)e[a].refreshData()})};ia.loadMap=function(a){for(var b=0;b<e.length;b++)e[b].loadMap(a)};ia.googleMapsLoaded=!1;ia.initGoogleMaps=function(){ia.googleMapsLoaded=!0;e[0].initGoogleMaps()};ia.getUrl=function(){for(var a=f.url.href,b="",c=0;c<e.length;c++){var d=e[c];c!=0&&(b=c+1);a+=a.indexOf("?")==-1?"?":"&";a+="geog"+b+"="+d.indicator.geography.index;a+="&indicator"+b+"="+d.indicator.id;d.indicator.date&&(a+="&date"+b+"="+d.indicator.date);
if(d=f.getComponent("map"+b))d=d.getBBox(),a+="&bbox"+b+"="+d.getXMin()+","+d.getYMin()+","+d.getXMax()+","+d.getYMax();d=f.getComponent("interactionGroup"+b);d.getSelection().length>0&&(a+="&select"+b+"="+d.getSelection().join(","))}a+="&printmode=true";return a};ia.toggleCallout=function(a,b){var c=f.getCallout(a);if(c!=void 0){if(ia.IS_TOUCH_DEVICE){var d=b.originalEvent.changedTouches[0];c.position(d.pageX,d.pageY)}else c.position(b.pageX,b.pageY);c.toggle()}};addHelp=function(){var a=new ia.Panel("popup-panel");
a.setDimensions(15,15,70,70);a.closeable(!0);a.popup(!0);a.resizeable(!0);a.zIndex(300);f.addPanel(a);var b=new ia.HTMLContainer("popup");a.append(b.container);f.addComponent("popup",b)};var g;ia.tipFunction=function(a,b,c){var d=f.config.getComponent(b).getProperty("tip");c&&(d=f.config.getComponent(b).getProperty("tip"+c));for(var b=a.name,c="",g=0;g<e.length;g++){var n=e[g],l=n.indicator;g!=0&&(c=g+1);if(n=n.geography.getFeature(a.id)){var n=n.getProperties(),o;for(o in n)f.textSubstitution.setVariable(o+
""+c,n[o])}n=l.getFormattedValue(a.id);f.textSubstitution.setVariable("featureName"+c,b);f.textSubstitution.setVariable("indicatorValue"+c,n);for(var n=l.getAssociates(),p=n.length,r=0;r<p;r++)f.textSubstitution.setVariable(n[r].name+""+c,n[r].getFormattedValue(a.id));n=l.getLowerLimits();l=l.getUpperLimits();n&&l?(f.textSubstitution.setVariable("lowerLimit"+c,n.getFormattedValue(a.id)),f.textSubstitution.setVariable("upperLimit"+c,l.getFormattedValue(a.id))):(f.textSubstitution.setVariable("lowerLimit"+
c,""),f.textSubstitution.setVariable("upperLimit"+c,""))}return f.textSubstitution.formatMessage(d)};iaToggle=function(a){var b=a+"-panel";f.closePopups(b);b=f.getWidget(b);b!=void 0?b.toggle():(b=f.getWidget(a),b!=void 0&&b.toggle())};iaTogglePopup=function(a){a.indexOf("http")==-1&&(a=ia.IAS_PATH+a);ia.IS_TOUCH_DEVICE?window.open(a,"_blank"):(iaToggle("popup"),f.getComponent("popup").setHtml(a))};iaToggleCallout=function(a,b){ia.toggleCallout(a,b)};iaToggleShare=function(a){iaToggleCallout("shareCallout",
a)};iaToggleProfileTree=function(){f.getComponent("spineChart").toggleTree()};iaOpenPrintPreview=function(){window.open(ia.getUrl(),"_blank")}})();ia.EventDispatcher=function(){this._eventListeners=[];this._eventTypes=[]};ia.EventDispatcher.prototype.addEventListener=function(a,b){this._eventTypes.push(a);this._eventListeners.push(b)};
ia.EventDispatcher.prototype.dispatchEvent=function(a){for(var b=this._eventListeners.concat(),c=this._eventTypes.concat(),d=0;d<b.length;d++)c[d]==a.type&&b[d].call(null,a)};ia.Event=function(a,b){this.type=a;this.object=b};ia.Event.MAP_READY="mapReady";ia.Event.MAP_RESIZE="mapResize";ia.Event.LAYER_READY="layerReady";ia.Event.LAYER_VISIBLE_CHANGED="layerVisibleChanged";ia.Event.THEME_CHANGED="themeChanged";ia.Event.RENDER="render";ia.Event.CLEAR_SELECTION="clearSelection";
ia.MouseEvent=function(a,b,c,d,e){ia.MouseEvent.baseConstructor.call(this,b,e);this.x=c;this.y=d;this.shiftKey=a.shiftKey;this.ctrlKey=a.ctrlKey;a=window.event||a;this.delta=a.detail?a.detail*-120:a.wheelDelta};ia.extend(ia.Event,ia.MouseEvent);
ia.Report=function(a,b,c){ia.Report.baseConstructor.call(this);this._widgetArray=[];this._widgetHash={};this._panelArray=[];this._panelHash={};this._buttonArray=[];this._buttonHash={};this._textArray=[];this._textHash={};this._imageArray=[];this._imageHash={};this._calloutArray=[];this._calloutHash={};this._componentArray=[];this._componentHash={};this._callbackFunction=c;this.config=a;this.selectionColor="#ff0000";this.highlightColor="#00ff00";this.highlightOpacity=this.selectionOpacity=0.3;this.isLoaded=
!1;this.uid="";this.evaluation=!0;this.container=$j('<div id="ia-report" class="ia-report">');b.append(this.container);this.$loadingContainer=$j('<div class="ia-report-loading">');this.container.append(this.$loadingContainer);this.$busyContainer=$j('<div class="ia-report-busy">');this.$busyContainer.bind(ia.CLICK_TYPE,function(){event.stopPropagation()});this.$busyContainer.bind("touchstart touchmove touchend mousemove mouseup mouseenter mouseleave mousedown click",function(a){a.stopPropagation()});
b.append(this.$busyContainer)};ia.extend(ia.EventDispatcher,ia.Report);this.evaluation=!0;ia.Report.prototype.addComponent=function(a,b){this._componentHash[a]=b;this._componentArray[this._componentArray.length]=b};ia.Report.prototype.getComponents=function(){return this._componentArray};ia.Report.prototype.getComponent=function(a){return this._componentHash[a]};ia.Report.prototype.addCallout=function(a){this._calloutArray[this._calloutArray.length]=a;this._calloutHash[a.id]=a;this.addWidget(a)};
ia.Report.prototype.getCallouts=function(){return this._calloutArray};ia.Report.prototype.getCallout=function(a){return this._calloutHash[a]};ia.Report.prototype.addWidget=function(a){this._widgetArray[this._widgetArray.length]=a;this._widgetHash[a.id]=a;this.container.append(a.container)};ia.Report.prototype.getWidgets=function(){return this._widgetArray};ia.Report.prototype.getWidget=function(a){return this._widgetHash[a]};
ia.Report.prototype.addPanel=function(a){this._panelArray[this._panelArray.length]=a;this._panelHash[a.id]=a;this.addWidget(a)};ia.Report.prototype.getPanels=function(){return this._panelArray};ia.Report.prototype.getPanel=function(a){return this._panelHash[a]};ia.Report.prototype.addButton=function(a){this._buttonArray[this._buttonArray.length]=a;this._buttonHash[a.id]=a;this.addWidget(a)};ia.Report.prototype.getButtons=function(){return this._buttonArray};ia.Report.prototype.getButton=function(a){return this._buttonHash[a]};
ia.Report.prototype.addText=function(a){this._textArray[this._textArray.length]=a;this._textHash[a.id]=a;this.addWidget(a)};ia.Report.prototype.getTexts=function(){return this._textArray};ia.Report.prototype.getText=function(a){return this._textHash[a]};ia.Report.prototype.addImage=function(a){this._imageArray[this._imageArray.length]=a;this._imageHash[a.id]=a;this.addWidget(a)};ia.Report.prototype.getImages=function(){return this._imageArray};ia.Report.prototype.getImage=function(a){return this._imageHash[a]};
ia.Report.prototype.build=function(a){var b=$j('<div class="ia-highlight-color ia-map-highlight-opacity">');this.container.append(b);var c=$j('<div class="ia-selection-color ia-map-selection-opacity">');this.container.append(c);this.highlightColor=ia.Color.toHex(b.css("color"));this.selectionColor=ia.Color.toHex(c.css("color"));this.highlightOpacity=b.css("opacity");this.selectionOpacity=c.css("opacity");b.remove();c.remove();b=this.config.getWidgets();this._panelArray=[];this._panelHash={};this._textArray=
[];this._textHash={};this._imageArray=[];this._imageHash={};this._buttonArray=[];this._buttonHash={};this._widgetArray=[];this._widgetHash={};this._calloutArray=[];this._calloutHash={};this._componentArray=[];this._componentHash={};c=$j('<div class="ia-panel">');this.container.append(c);for(var d=0;d<b.length;d++){var e=b[d],f,g=e.id;if(e.type=="component"||e.type=="table"){var h=e.getProperty("isPopUp")||!1,j=!0;if(e.id.indexOf("menuBar")!=-1||e.id.indexOf("timeControl")!=-1||e.id.indexOf("featureLegend")!=
-1||e.id.indexOf("profileLegend")!=-1)j=!1;var i=e.getProperty("isExportable")||!1,g=e.id+"-panel";f=new ia.Panel(g);f.popup(h);f.closeable(h);f.resizeable(j);f.exportable(i);this.addPanel(f)}else if(e.type=="button")f=new ia.Button(g),f.onclick(e.href,e.target),f.tooltip(e.tooltip),f.addCssClass(e.cssClass),f.container.css("visibility","hidden"),this.addButton(f);else if(e.type=="text")f=new ia.Text(g),f.onclick(e.href,e.target),f.tooltip(e.tooltip),f.addCssClass(e.cssClass),e.href&&f.addCssClass("ia-link"),
$j.each(e.cssProps,function(a,b){f.container.css(a,b)}),this.addText(f);else if(e.type=="image"||e.type=="img")f=new ia.Image(g,e.src),f.onclick(e.href,e.target),f.tooltip(e.tooltip),f.addCssClass(e.cssClass),f.rescale=e.rescale,this.addImage(f);e.id.indexOf("filterButton")==-1&&e.id.indexOf("geographyButton")==-1&&f.visible(e.visible);f.setDimensions(e.x,e.y,e.width,e.height,e.xAnchor,e.yAnchor);f.zIndex(e.zIndex)}c.remove();this.locale=new ia.Locale(this.config.getProperty("locale"));this.locale.formatter.noDataValue=
this.config.getProperty("noDataValue");this.data=this.url.params.appid!=""&&ia.readingWebMap||this.url.params.webmap!=""?new ia.WebMapData:this.url.params.appid!=""?new ia.AGOLData:new ia.ReportData;this.data.formatter=this.locale.formatter;b=this.config.getProperty("ndecimal");if(b!=-1)this.data.precision=b;this.data.setProperty(this.config.getProperty("customBreaksKey"),this.config.getProperty("legendBreaks"));this.data.setProperty(this.config.getProperty("customLabelsKey"),this.config.getProperty("legendLabels"));
this.data.setProperty(this.config.getProperty("customBreaksKey2"),this.config.getProperty("legendBreaks2"));this.data.setProperty(this.config.getProperty("customLabelsKey2"),this.config.getProperty("legendLabels2"));this.textSubstitution=new ia.TextSubstitution;a!=null&&a.call(null,this)};
ia.Report.prototype.updateDynamicText=function(a){for(var b=this.config.getComponents().concat(this.config.getTables()),c=0;c<b.length;c++){var d=b[c],e=a.formatMessage(d.title);this.getWidget(d.id+"-panel").title(e)}b=this.config.getTexts().concat(this.config.getButtons());for(c=0;c<b.length;c++)d=b[c],e=a.formatMessage(d.text),this.getWidget(d.id).text(e)};
ia.Report.prototype.startProgress=function(a,b){this.$busyContainer.css("display","inline");a&&ia.showWaitCursor();setTimeout(function(){b.call(null)},100)};ia.Report.prototype.endProgress=function(){this.$busyContainer.css("display","none");ia.showDefaultCursor()};ia.Report.prototype.removeLoadingPage=function(){var a=this;this.$loadingContainer.fadeOut("slow",function(){a._callbackFunction&&a._callbackFunction.call(null,a);a.$loadingContainer.remove()})};
ia.Report.prototype.displayEvaluationMessage=function(a){var b="This report was prepared using an InstantAtlas&#153 evaluation license. It is not licensed for distribution or publication of any kind. For more information contact <a href='mailto:support@geowise.co.uk'>support@geowise.co.uk</a>, or visit <a href='http://www.instantatlas.com/' target='_blank'>http://www.instantatlas.com/</a>.",c="Evaluation";this.locale&&(this.locale.getLanguage()=="de"?b="Dieser Bericht wurde mit einer InstantAtlas&#153 Testlizenz erstellt. Er ist nicht zur Verbreitung oder Ver\u00f6ffentlichung jeglicher Art lizensiert. F\u00fcr weitere Informationen kontaktieren Sie bitte <a href='mailto:support@geowise.co.uk'>support@geowise.co.uk</a> oder besuchen Sie <a href='http://www.instantatlas.com/de/' target='_blank'>http://www.instantatlas.com/</a>.":
this.locale.getLanguage()=="fr"?b="Ce rapport a \u00e9t\u00e9 cr\u00e9e avec une licence d\u2019\u00e9valuation. Cette licence ne permet pas la distribution ou la publication du rapport. Pour plus de renseignements veuillez contacter <a href='mailto:support@geowise.co.uk'>support@geowise.co.uk</a> ou consulter <a href='http://www.instantatlas.com/fr/' target='_blank'>http://www.instantatlas.com</a>.":this.locale.getLanguage()=="es"&&(b="Este informe ha sido generado con una licencia de evaluaci\u00f3n. La distribuci\u00f3n o publicaci\u00f3n del informe est\u00e1 prohibida. Para m\u00e1s informaci\u00f3n mande un email a <a href='mailto:support@geowise.co.uk'>support@geowise.co.uk</a> o consulte <a href='http://www.instantatlas.com/es/' target='_blank'>http://www.instantatlas.com</a>.",
c="Evaluaci\u00f3n"));var d=$j("<div>");d.css({position:"absolute",left:"5px",bottom:"5px","border-color":"#DCDCDC","border-width":"1px","border-style":"solid","background-color":"#f9f9f9","border-radius":"4px",padding:"5px","text-align":"right"});c=$j("<div>").text(c);c.css({"font-family":"Arial Black","font-size":"30px",color:"#bbbbbb"});var e=$j("<a href='http://www.instantatlas.com/' target='_blank'>").text("http://www.instantatlas.com");this.locale&&(this.locale.getLanguage()=="de"?e=$j("<a href='http://www.instantatlas.com/de/' target='_blank'>").text("http://www.instantatlas.com"):
this.locale.getLanguage()=="fr"?e=$j("<a href='http://www.instantatlas.com/fr/' target='_blank'>").text("http://www.instantatlas.com"):this.locale.getLanguage()=="es"&&(e=$j("<a href='http://www.instantatlas.com/es/' target='_blank'>").text("http://www.instantatlas.com")));e.css({"font-family":"Verdana","font-size":"11px",color:"#888888"});var f=$j("<div>").html(b);f.css({position:"absolute",left:"30%",top:"40%",width:"40%","border-color":"#DCDCDC","border-width":"1px","border-style":"solid","background-color":"#f9f9f9",
"border-radius":"5px",padding:"10px","z-index":999999});$j("body").bind(ia.CLICK_TYPE,function(){f.hide()});a.append(d);d.append(c);d.append(e);this.container.append(f)};ia.Report.prototype.closePopups=function(a){for(var b=this.getPanels(),c=0;c<b.length;c++){var d=b[c];d.popup()&&d.id!=a&&d.hide()}b=this.getCallouts();for(c=0;c<b.length;c++)d=b[c],d.id!=a&&d.hide()};ia.InteractionEvent=function(a,b,c){ia.InteractionEvent.baseConstructor.call(this,a,b);this.ids=c||[]};ia.extend(ia.Event,ia.InteractionEvent);
ia.InteractionEvent.SELECTION_CHANGED="selectionChanged";ia.InteractionEvent.HIGHLIGHT_CHANGED="highlightChanged";ia.InteractionGroup=function(){ia.InteractionGroup.baseConstructor.call(this);this._selection=[];this._highlight="";this._components=[];this._legendComponents=[];this.filteredFeatures=[];this.selectionMode="multiple"};ia.extend(ia.EventDispatcher,ia.InteractionGroup);ia.InteractionGroup.prototype.getComponents=function(){return this._components.concat(this._legendComponents)};
ia.InteractionGroup.prototype.addComponent=function(a){function b(a){this.dispatchEvent(a)}a.isLegendComponent?this._legendComponents.push(a):this._components.push(a);a.addEventListener(ia.ItemEvent.ITEM_MOUSE_OVER,this._itemEventHandler.bind(this));a.addEventListener(ia.ItemEvent.ITEM_MOUSE_OUT,this._itemEventHandler.bind(this));a.addEventListener(ia.ItemEvent.ITEM_MOUSE_UP,this._itemEventHandler.bind(this));a.addEventListener(ia.ItemEvent.ITEM_CLICK,this._itemEventHandler.bind(this));a.addEventListener(ia.ItemEvent.NONE_ITEM_CLICK,
this._itemEventHandler.bind(this));a.addEventListener(ia.ItemEvent.ITEM_MOUSE_DOWN,b.bind(this));a.addEventListener(ia.ItemEvent.ITEM_MOUSE_MOVE,b.bind(this))};ia.InteractionGroup.prototype.getHighlight=function(){return this._highlight};
ia.InteractionGroup.prototype.clearHighlight=function(){this._highlight="";for(var a=0;a<this._components.length;a++){var b=this._components[a];b.clearHighlight()}for(a=0;a<this._legendComponents.length;a++)b=this._legendComponents[a],b.clearHighlight();this.dispatchEvent(new ia.InteractionEvent(ia.InteractionEvent.HIGHLIGHT_CHANGED,this,[this._highlight]))};
ia.InteractionGroup.prototype.setHighlight=function(a){if(a!=""){this._highlight=a;for(var b=0;b<this._components.length;b++)this._components[b].clearHighlight(),this._components[b].highlight(a);this.dispatchEvent(new ia.InteractionEvent(ia.InteractionEvent.HIGHLIGHT_CHANGED,this,[this._highlight]))}else this.clearHighlight()};ia.InteractionGroup.prototype.getSelection=function(){return this._selection};
ia.InteractionGroup.prototype.setSelection=function(a){if(a.length>0){this._selection=a.concat();for(a=0;a<this._components.length;a++)for(var b=0;b<this._selection.length;++b)this._components[a].select(this._selection[b]);this.dispatchEvent(new ia.InteractionEvent(ia.InteractionEvent.SELECTION_CHANGED,this,this._selection))}else this.clearSelection()};
ia.InteractionGroup.prototype.clearSelection=function(){for(var a=0;a<this._components.length;a++){var b=this._components[a];b.clearSelection()}for(a=0;a<this._legendComponents.length;a++)b=this._legendComponents[a],b.clearSelection();this._selection=[];this.dispatchEvent(new ia.Event(ia.Event.CLEAR_SELECTION,{}));this.dispatchEvent(new ia.InteractionEvent(ia.InteractionEvent.SELECTION_CHANGED,this,this._selection))};
ia.InteractionGroup.prototype.select=function(a){if(this._selection.indexOf(a)==-1){this._selection.push(a);for(var b=0;b<this._components.length;b++)this._components[b].select(a);this.dispatchEvent(new ia.InteractionEvent(ia.InteractionEvent.SELECTION_CHANGED,this,this._selection))}};
ia.InteractionGroup.prototype.unselect=function(a){var b=this._selection.indexOf(a);if(b!=-1){this._selection.splice(b,1);for(b=0;b<this._components.length;b++)this._components[b].unselect(a);this.dispatchEvent(new ia.InteractionEvent(ia.InteractionEvent.SELECTION_CHANGED,this,this._selection))}};
ia.InteractionGroup.prototype._itemEventHandler=function(a){var b=a.item;a.type==ia.ItemEvent.NONE_ITEM_CLICK?this.clearSelection():b.parent.isLegendComponent?a.type==ia.ItemEvent.ITEM_CLICK&&this.selectionMode=="single"?b.parent.unselect(b.id):this._onLegendClassEvent(a,b):(this._updateComponents(a,b),this._updateLegendClassComponents(a,b));this._dispatchInteractionEvent(a.type)};
ia.InteractionGroup.prototype._dispatchInteractionEvent=function(a){a==ia.ItemEvent.NONE_ITEM_CLICK||a==ia.ItemEvent.ITEM_CLICK?this.dispatchEvent(new ia.InteractionEvent(ia.InteractionEvent.SELECTION_CHANGED,this,this._selection)):(a==ia.ItemEvent.ITEM_MOUSE_OUT||a==ia.ItemEvent.ITEM_MOUSE_UP||a==ia.ItemEvent.ITEM_MOUSE_OVER)&&this.dispatchEvent(new ia.InteractionEvent(ia.InteractionEvent.HIGHLIGHT_CHANGED,this,[this._highlight]))};
ia.InteractionGroup.prototype._onLegendClassEvent=function(a,b){for(var c=b.id,d=b.parent,e=b.state,f=0;f<this._legendComponents.length;f++){var g=this._legendComponents[f];g!=d&&d.thematic==g.thematic&&(a.type==ia.ItemEvent.ITEM_MOUSE_OUT||a.type==ia.ItemEvent.ITEM_MOUSE_UP?g.clearHighlight():a.type==ia.ItemEvent.ITEM_MOUSE_OVER?(g.clearHighlight(),g.highlight(c)):a.type==ia.ItemEvent.ITEM_CLICK&&(e==ia.ItemLayer.UNSELECTED?g.unselect(c):g.select(c)))}if(a.type==ia.ItemEvent.ITEM_CLICK){c=b.legendClass.items;
d=c.length;for(f=0;f<d;f++)this._updateComponents(a,c[f])}};ia.InteractionGroup.prototype._updateLegendClassComponents=function(a,b){for(var c=0;c<this._legendComponents.length;c++){var d=this._legendComponents[c];if(a.type==ia.ItemEvent.ITEM_MOUSE_OUT||a.type==ia.ItemEvent.ITEM_MOUSE_UP)d.clearHighlight();else if(a.type==ia.ItemEvent.ITEM_MOUSE_OVER){d.clearHighlight();var e=d.thematic.getData();e&&(e=e[b.id])&&d.highlight(e.legendClass.index)}}};
ia.InteractionGroup.prototype._updateComponents=function(a,b){var c=b.id,d=b.parent,e=a.item.state;a.type==ia.ItemEvent.ITEM_CLICK&&this.selectionMode=="single"&&this.clearSelection();if(a.type==ia.ItemEvent.ITEM_CLICK)if(e==ia.ItemLayer.UNSELECTED){var f=this._selection.indexOf(c);f!=-1&&this._selection.splice(f,1)}else this._selection.push(c);else if(a.type==ia.ItemEvent.ITEM_MOUSE_OUT||a.type==ia.ItemEvent.ITEM_MOUSE_UP)this._highlight="";else if(a.type==ia.ItemEvent.ITEM_MOUSE_OVER)this._highlight=
c;for(f=0;f<this._components.length;f++){var g=this._components[f];if(g!=d||this.selectionMode=="single")a.type==ia.ItemEvent.ITEM_MOUSE_OUT||a.type==ia.ItemEvent.ITEM_MOUSE_UP?g.clearHighlight():a.type==ia.ItemEvent.ITEM_MOUSE_OVER&&(g.clearHighlight(),g.highlight(c)),a.type==ia.ItemEvent.ITEM_CLICK&&(e==ia.ItemLayer.UNSELECTED?g.unselect(c):g.select(c))}this.dispatchEvent(a)};
ia.DataGroup=function(a,b,c,d){function e(c){q=(new Date).getTime();a.config.getComponent("map"+b);l.mapData=new ia.MapData;if(A)A.mapData=l.mapData;a.url.params.appid!=""&&ia.readingWebMap||a.url.params.webmap!=""?l.mapData.parseData(a.data.iaMapData,f):l.mapData.loadSource(c,f)}function f(){t=(new Date).getTime();a.isLoaded==!1&&ia.log("Map data: "+(t-q)+" ms");if(a.isLoaded==!1)a.template=l.mapData.template,a.version=l.mapData.version,a.evaluation=l.mapData.baseLayers[0].eval,a.uid=l.mapData.baseLayers[0].uid;
var d=a.getWidget("map"+b+"-panel");if(d){u!=void 0&&d.content.empty();var e=a.config.getComponent("map"+b),f=e.getProperty("minZoomAllowed"),h=e.getProperty("maxZoomAllowed"),j,i;if(a.url.params["bbox"+b]){var k=a.url.params["bbox"+b].split(",");i=new ia.BoundingBox(parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]))}if(l.mapData.useGoogleMaps)u=new ia.Map("map"+b),O=j=new ia.GoogleMap("map"+b,l.mapData.googleMapType,l.mapData.googleApiKey,f,h,e.getProperty("googleGreyscaleText"),
e.getProperty("googleOffText")),a.addComponent("gMap"+b,j);else{u=new ia.Map("map"+b);if(f!=-1)u.minZoom=f;if(h!=-1)u.maxZoom=h;u.useNavigation(!0);O=u}O.addEventListener(ia.Event.MAP_READY,function(){for(var d=0;d<l.mapData.baseLayers.length;d++){var e=l.mapData.baseLayers[d];e.dataLabel=a.config.getComponent("map"+b).getProperty("tip");e.interactive=!0;e.tipFunction=function(a){return ia.tipFunction(a,"map"+b)};e.highlightColor=a.highlightColor;e.selectionColor=a.selectionColor;e.highlightOpacity=
a.highlightOpacity;e.selectionOpacity=a.selectionOpacity;c.addComponent(e)}if(l.mapData.useGoogleMaps)l.mapData.mapBBox.getXMin()<-2E7&&l.mapData.mapBBox.setXMin(-2E7),l.mapData.mapBBox.getXMax()>2E7&&l.mapData.mapBBox.setXMax(2E7),j.controller.defaultBBox=l.mapData.mapBBox,i?j.controller.zoomToBBox(i):j.controller.zoomFull(),j.addMapOverlay(u);u.controller.defaultBBox=l.mapData.mapBBox;i?u.controller.zoomToBBox(i):u.controller.zoomFull();for(d=0;d<l.mapData.layers.length;d++)e=l.mapData.layers[d],
u.addLayer(l.mapData.layers[d]);a.isLoaded==!1?g():u.render()});d.append(O.container);a.addComponent("map"+b,u);a.addComponent("activeMap"+b,O);d.exportFunction=function(){u.exportData(a.config.getProperty("saveImageText"))};f=$j('<div id="map-copyright" class="ia-map-copyright"></div>');h=e.getProperty("copyrightText");h!=""&&h!=void 0&&(f.html(h),d.append(f));a.evaluation&&a.displayEvaluationMessage(d);f=e.getProperty("includeSearchTool");f==void 0&&(f=!1);if(f&&b=="")h=document.createElement("script"),
h.type="text/javascript",h.src="http://code.jquery.com/ui/1.9.2/jquery-ui.js",document.body.appendChild(h);f=new ia.MapTools(O,c,l.mapData.useGoogleMaps,f);f.clearButtonText=e.getProperty("clearButtonText");f.filterButtonText=e.getProperty("filterButtonText");f.filterFunction=function(){y.id="";y.value="";y.name="";a.textSubstitution.setVariable("filterName"+b,"");a.textSubstitution.setVariable("filterValue"+b,"");c.clearSelection();r=!0;m();v.commitChanges()};d.append(f.container);a.addComponent("mapTools"+
b,f);f.render()}else{if(a.config.template==ia.DOUBLE_BASELAYER_REPORT&&b!="")l.mapData.noneBaseLayers=[],d=l.mapData.baseLayers[b-1],d.dataLabel=a.config.getComponent("map").getProperty("tip"+b),d.interactive=!0,d.tipFunction=function(a){return ia.tipFunction(a,"map",b)},d.highlightColor=a.highlightColor,d.selectionColor=a.selectionColor,d.highlightOpacity=a.highlightOpacity,d.selectionOpacity=a.selectionOpacity,c.addComponent(d),a.getComponent("map").addLayer(d);else if(a.config.template==ia.DOUBLE_BASELAYER_REPORT_NEW&&
b!="")l.mapData.noneBaseLayers=[],d=l.mapData.baseLayers[1],d.showDataTips=!1,d.showLabels=!1,a.getComponent("map").addLayer(d);g()}}function g(){var d,e=a.data.getGeographies();a.url.params["geog"+b]&&(d=e[a.url.params["geog"+b]]);d==void 0&&(d=(a.config.template==ia.DOUBLE_GEOG_REPORT||a.config.template==ia.DOUBLE_BASELAYER_REPORT||a.config.template==ia.DOUBLE_BASELAYER_REPORT_NEW)&&b!=""?e.length>=b?e[b-1]:e[0]:e[0]);var f=a.getButton("geographyButton"+b);f&&(e.length>1?f.show():f.hide());var e=
!0,g;a.url.params["indicator"+b]&&(g=a.url.params["date"+b]?d.getIndicator(a.url.params["indicator"+b],a.url.params["date"+b]):d.getIndicator(a.url.params["indicator"+b],void 0,e));g==void 0&&(g=d.getFirstIndicator(e),a.url.params["date"+b]&&(g=d.getIndicator(g.id,a.url.params["date"+b])));if(a.url.params["filter"+b])f=a.url.params["filter"+b].split(","),e=f[0],f=f[1],c.filteredFeatures=d.getFilteredFeatures(e,f),a.textSubstitution.setVariable("filterName"+b,d.getFilter(e).name),a.textSubstitution.setVariable("filterValue"+
b,f);if(H){var f=a.config.getComponent("dataExplorer"+b),j=f.getProperty("showDates"),e=f.getProperty("reverseDates");e==void 0&&(e=!0);f=a.config.getComponent("geogExplorer");f!=void 0||a.config.template==ia.DOUBLE_GEOG_REPORT||a.config.template==ia.DOUBLE_BASELAYER_REPORT||a.config.template==ia.DOUBLE_PLOT_REPORT||a.config.template==ia.BUBBLE_PLOT_REPORT||a.config.template==ia.DOUBLE_BASELAYER_REPORT_NEW?(H.data(d.getDataTree(j,e)),H.build(d.id)):a.data.getGeographies().length>1?(H.data(a.data.getDataTree(j,
e)),H.build()):(H.data(d.getDataTree(j,e)),H.build(d.id));j&&g.date!=void 0?H.showItem(d.id+"~"+g.id+"~"+g.date):H.showItem(d.id+"~"+g.id)}na&&(na.data(a.data.getGeographyTree()),na.build());h(d.id,g.id,g.date)}function h(b,c,d){a.startProgress(!0,function(){var e=a.data.getGeography(b);if(E)E.geography=e;if(N)N.geography=e;if(x)x.geography=e;e.loadIndicator(c,d,function(b){a.isLoaded==!1||b.geography.id!=l.indicator.geography.id?(i(e),E||x||N||a.url.params.loadAllData?e.loadData(function(){j(b)}):
j(b)):j(b)})})}function j(a){l.indicator=a;l.theme=a.theme;l.geography=a.geography;m();n(v,l.indicator);v.commitChanges()}function i(e){o=!0;if(a.isLoaded)c.filteredFeatures=[],a.textSubstitution.setVariable("filterName"+b,""),a.textSubstitution.setVariable("filterValue"+b,""),c.clearSelection(),d.clearSelection();if(M)M.geography=e,M.clearSelection();U&&(U.data(e.getFilterTree()),U.build());var f=a.getButton("filterButton"+b);f&&(e.getFilters().length>0?f.show():f.hide());if(x){for(var f=e.getComparisonFeatures(),
g=[],h=0;h<f.length;h++)g.push(f[h].id);f=e.getProfileData(g);Z.setData(f.themes[0].indicators);V.setData(f.themes[1].indicators)}if(l.mapData){f=l.mapData.baseLayer.getVisible();l.mapData.baseLayer.setVisible(!1);l.mapData.baseLayer=l.mapData.baseLayers[e.index];if(l.mapData.baseLayer==void 0)l.mapData.baseLayer=l.mapData.baseLayers[0];l.mapData.baseLayer.isLoaded||l.mapData.baseLayer.loadSource();f&&l.mapData.baseLayer.setVisible(!0);var j,e=v.numericClassifier.sizePalette;if(a.config.template==
ia.BUBBLE_PLOT_REPORT&&b=="2"){if(f=a.config.getComponent("scatterPlot"))j="circle",v.setDataField(f.getProperty("sizeData")),s.legendType="continuous",e.minSize=f.getProperty("minBubbleSize"),e.maxSize=f.getProperty("maxBubbleSize"),v.categoricClassifier.symbolSize=8}else l.mapData.baseLayer.geometry=="point"?(j=a.config.getProperty("symbolShape"+b),e.minSize=a.config.getProperty("minSymbolSize"+b),e.maxSize=a.config.getProperty("maxSymbolSize"+b),v.categoricClassifier.symbolSize=l.mapData.baseLayer.symbolSize):
l.mapData.baseLayer.geometry=="line"?(j=ia.Shape.LINE,e.minSize=a.config.getProperty("minLineSize"+b),e.maxSize=a.config.getProperty("maxLineSize"+b),v.categoricClassifier.symbolSize=l.mapData.baseLayer.style.lineWidth):(j=ia.Shape.SQUARE,e.minSize=l.mapData.baseLayer.symbolSize,e.maxSize=l.mapData.baseLayer.symbolSize,v.categoricClassifier.symbolSize=l.mapData.baseLayer.symbolSize);l.mapData.baseLayer.symbol=j;v.symbol=j;if(A)A.render(),oa.style=l.mapData.baseLayer.style}}function m(){c.filteredFeatures.length>
0?(l.indicatorData=l.indicator.getData(c.filteredFeatures),L=l.theme.getData(l.indicator.id,c.filteredFeatures),fa&&(va=l.indicator.getData(c.filteredFeatures))):(l.indicatorData=l.indicator.getData(),L=l.theme.getData(l.indicator.id),fa&&(va=l.indicator.getData()));l.comparisonData=l.indicator.getComparisonData();wa=l.theme.getComparisonData(l.indicator.id);ga.setData(l.comparisonData);var d=l.indicator.getDataType(v.getDataField());v.setDataType(d);v.setData(l.indicatorData);fa&&fa.setData(va);
a.textSubstitution.setVariable("geogName"+b,l.geography.name);a.textSubstitution.setVariable("themeName"+b,l.theme.getParentThemes());a.textSubstitution.setVariable("indicatorName"+b,l.indicator.name);a.textSubstitution.setVariable("date"+b,l.indicator.date);var d=l.indicator.getProperties(),e;for(e in d)a.textSubstitution.setVariable(e+""+b,d[e]);a.updateDynamicText(a.textSubstitution);if(G){var f=a.config.getComponent("advancedPieChart"+b);e={};d=[];if(f.getProperty("datasource")=="associate"){G.setData(l.indicatorData);
var g=f.getProperty("ignoreAssociateIds");if(g)for(var h=l.indicator.getAssociates(),j=0;j<h.length;j++){for(var i=h[j],k=!0,m=0;m<g.length;m++)if(i.id==g[m]){k=!1;break}if(k&&i.type!=ia.Thematic.CATEGORIC)d[d.length]=i.id,e[i.id]={value:i.id}}else{h=l.indicator.getAssociates();for(j=0;j<h.length;j++)if(i=h[j],i.type!=ia.Thematic.CATEGORIC)e[i.id]={value:i.id},d[d.length]=i.id}if(f=f.getProperty("associateLabels"))G.thematic.categoricClassifier.labels=f}else if(l.indicator.date!=void 0){f=l.theme.getDataForDate(l.indicator.date);
G.setData(f);f=l.theme.getIndicators();for(j=0;j<f.length;j++)if(g=f[j],g.date==l.indicator.date&&g.type!=ia.Thematic.CATEGORIC)e[g.name]={value:g.name},d[d.length]=g.name}else{f=l.theme.getData();G.setData(f);f=l.theme.getIndicators();for(j=0;j<f.length;j++)if(g=f[j],g.type!=ia.Thematic.CATEGORIC)d[d.length]=g.name,e[g.name]={value:g.name}}xa=d.length>1?!0:!1;G.thematic.categoricClassifier.breaks=d;G.thematic.setData(e);G.thematic.commitChanges()}if(x){f=a.config.getComponent("pyramidChart"+b);(e=
l.indicator.getProperty(f.getProperty("maxChartValue")))?(x.useFixedValues=!0,x.useTightLabels=!0,x.fixedMaxValue=e):(x.useFixedValues=f.getProperty("useFixedValues"),x.useFixedValues?(x.useTightLabels=!0,x.fixedMaxValue=f.getProperty("fixedMaxValue")):x.useTightLabels=f.getProperty("useTightLabels"));if(e=f.getProperty("xAxisTitle"))x.xAxisTitle=a.textSubstitution.formatMessage(e);if(e=f.getProperty("yAxisTitle"))x.yAxisTitle=a.textSubstitution.formatMessage(e);e=l.geography.getThemes()[0];x.yAxisLabels=
e.getIndicatorNames().reverse();x.date=l.indicator.date}p=!0;t=(new Date).getTime();a.isLoaded==!1&&ia.log("Report data: "+(t-q)+" ms")}function k(){ga.commitChanges();fa&&fa.commitChanges();var d=v.numericClassifier;trenderstart=(new Date).getTime();if(da){var e=a.config.getComponent("metadata"+b).getProperty("metadataKey");l.indicator.getProperty(e)?da.setHtml(l.indicator.getProperty(e)):da.setHtml("")}l.mapData.baseLayer.setData(l.indicatorData);u&&(q=(new Date).getTime(),u.render(),t=(new Date).getTime(),
a.isLoaded==!1&&ia.log("Map "+(t-q)+" ms"));if(E)e=a.config.getTable("spineChart"+b),E.columns=e.getColumnsForIndicator(l.indicator,a.textSubstitution),E.indicator=l.indicator,E.render(),a.isLoaded==!1&&ia.log("Profile "+(t-q)+" ms");if(N)a.config.getComponent("featureCard"+b),N.indicator=l.indicator,N.render(),a.isLoaded==!1&&ia.log("Profile "+(t-q)+" ms");if(A){q=(new Date).getTime();var f=l.indicator.getDataType(v.getDataField());f!=ia.Thematic.CATEGORIC&&d.classificationName==ia.Thematic.CONTINUOUS?
(ta.show(),ta.render(),oa.renderCategoric()):(ta.hide(),oa.render());t=(new Date).getTime();a.isLoaded==!1&&ia.log("Layer list "+(t-q)+" ms")}pa&&(q=(new Date).getTime(),d.classificationName==ia.Thematic.CONTINUOUS?(pa.hide(),a.getWidget("pieChart"+b+"-panel").text(a.config.getComponent("pieChart"+b).getProperty("notAvailableText"))):(pa.render(),pa.show()),t=(new Date).getTime(),a.isLoaded==!1&&ia.log("Pie chart: "+(t-q)+" ms"));G&&(q=(new Date).getTime(),xa?(G.show(),a.getWidget("advancedPieChart"+
b+"-panel").text(""),G.render()):(G.hide(),a.getWidget("advancedPieChart"+b+"-panel").text(a.config.getComponent("advancedPieChart"+b).getProperty("notAvailableText"))),t=(new Date).getTime(),a.isLoaded==!1&&ia.log("Advanced pie chart: "+(t-q)+" ms"));if(P&&a.config.template!=ia.DOUBLE_PLOT_REPORT&&a.config.template!=ia.DOUBLE_BASELAYER_REPORT_NEW&&a.config.template!=ia.BUBBLE_PLOT_REPORT)q=(new Date).getTime(),e=a.config.getTable("table"+b),e.customColumns=l.indicator.customColumns,P.columns=e.getColumnsForIndicator(l.indicator,
a.textSubstitution),P.setData(l.indicatorData),P.render(),e.getProperty("sortColumnName")!=""&&(P.sort(e.getProperty("sortColumnName"),e.getProperty("sortDirection")),e.setProperty("sortColumnName","")),t=(new Date).getTime(),a.isLoaded==!1&&ia.log("Table: "+(t-q)+" ms");if(S&&a.config.template!=ia.DOUBLE_PLOT_REPORT&&a.config.template!=ia.DOUBLE_BASELAYER_REPORT_NEW&&a.config.template!=ia.BUBBLE_PLOT_REPORT)q=(new Date).getTime(),e=a.config.getTable("comparisonTable"+b),e.customColumns=l.indicator.customColumns,
S.columns=e.getColumnsForIndicator(l.indicator,a.textSubstitution),S.setData(l.comparisonData),S.render(),e.getProperty("sortColumnName")!=""&&(S.sort(e.getProperty("sortColumnName"),e.getProperty("sortDirection")),e.setProperty("sortColumnName","")),t=(new Date).getTime(),a.isLoaded==!1&&ia.log("Comparison table: "+(t-q)+" ms");if(F){q=(new Date).getTime();f=l.indicator.getDataType(Q.dataField);if(f==ia.Thematic.CATEGORIC||f==!1)F.hide(),a.getWidget("boxAndWhisker"+b+"-panel").text(a.config.getComponent("boxAndWhisker"+
b).getProperty("notAvailableText"));else{e=a.config.getComponent("boxAndWhisker"+b);d=l.indicator.getProperty(e.getProperty("minChartValue"));f=l.indicator.getProperty(e.getProperty("maxChartValue"));d&&f?(F.useFixedValues=!0,F.useTightLabels=!0,F.fixedMinValue=d,F.fixedMaxValue=f):(F.useFixedValues=e.getProperty("useFixedValues"),F.useFixedValues?(F.useTightLabels=!0,F.fixedMinValue=e.getProperty("fixedMinValue"),F.fixedMaxValue=e.getProperty("fixedMaxValue")):F.useTightLabels=e.getProperty("useTightLabels"));
if(d=e.getProperty("xAxisTitle"))F.xAxisTitle=a.textSubstitution.formatMessage(d);if(d=e.getProperty("yAxisTitle"))F.yAxisTitle=a.textSubstitution.formatMessage(d);F.show();a.getWidget("boxAndWhisker"+b+"-panel").text("");Q.setData(l.indicatorData);$.setData(l.comparisonData);F.render();e.getProperty("showComparison")&&$.selectAll()}t=(new Date).getTime();a.isLoaded==!1&&ia.log("Box chart "+(t-q)+" ms")}if(B){q=(new Date).getTime();f=l.indicator.getDataType(W.dataField);if(f==ia.Thematic.CATEGORIC)e=
a.config.getComponent("barChart"+b),d=l.indicator.getProperty(e.getProperty("minChartValue")),f=l.indicator.getProperty(e.getProperty("maxChartValue")),d&&f?(I.useFixedValues=!0,I.useTightLabels=!0,I.fixedMinValue=d,I.fixedMaxValue=f):(I.useFixedValues=e.getProperty("useFixedValues"),I.useFixedValues?(I.useTightLabels=!0,B.fixedMinValue=e.getProperty("fixedMinValue"),B.fixedMaxValue=e.getProperty("fixedMaxValue")):I.useTightLabels=e.getProperty("useTightLabels")),B.hide(),I.show(),I.container.css({visibility:"visible"}),
a.getWidget("barChart"+b+"-panel").text(""),ha.setData(l.indicatorData),I.render();else{e=a.config.getComponent("barChart"+b);d=l.indicator.getProperty(e.getProperty("minChartValue"));f=l.indicator.getProperty(e.getProperty("maxChartValue"));d&&f?(B.useFixedValues=!0,B.useTightLabels=!0,B.fixedMinValue=d,B.fixedMaxValue=f):(B.useFixedValues=e.getProperty("useFixedValues"),B.useFixedValues?(B.useTightLabels=!0,B.fixedMinValue=e.getProperty("fixedMinValue"),B.fixedMaxValue=e.getProperty("fixedMaxValue")):
B.useTightLabels=e.getProperty("useTightLabels"));if(d=e.getProperty("xAxisTitle"))B.xAxisTitle=a.textSubstitution.formatMessage(d);if(d=e.getProperty("yAxisTitle"))B.yAxisTitle=a.textSubstitution.formatMessage(d);I.hide();I.container.css({visibility:"hidden"});B.show();a.getWidget("barChart"+b+"-panel").text("");W.setData(l.indicatorData);ja.setData(l.comparisonData);B.render()}t=(new Date).getTime();a.isLoaded==!1&&ia.log("Bar chart "+(t-q)+" ms")}x&&(q=(new Date).getTime(),x.render(),t=(new Date).getTime(),
a.isLoaded==!1&&ia.log("Pyramid chart "+(t-q)+" ms"));if(C){q=(new Date).getTime();f=l.indicator.getDataType(X.dataField);if(f==ia.Thematic.CATEGORIC||l.indicator.date==void 0)C.hide(),a.getWidget("discreteTimeSeries"+b+"-panel").text(a.config.getComponent("discreteTimeSeries"+b).getProperty("notAvailableText"));else{e=a.config.getComponent("discreteTimeSeries"+b);d=l.indicator.getProperty(e.getProperty("minChartValue"));f=l.indicator.getProperty(e.getProperty("maxChartValue"));d&&f?(C.useFixedValues=
!0,C.useTightLabels=!0,C.fixedMinValue=d,C.fixedMaxValue=f):(C.useFixedValues=e.getProperty("useFixedValues"),C.useFixedValues?(C.useTightLabels=!0,C.fixedMinValue=e.getProperty("fixedMinValue"),C.fixedMaxValue=e.getProperty("fixedMaxValue")):C.useTightLabels=e.getProperty("useTightLabels"));if(d=e.getProperty("xAxisTitle"))C.xAxisTitle=a.textSubstitution.formatMessage(d);if(d=e.getProperty("yAxisTitle"))C.yAxisTitle=a.textSubstitution.formatMessage(d);C.show();a.getWidget("discreteTimeSeries"+b+
"-panel").text("");X.setData(L);aa.setData(wa);C.orientation=="vertical"?C.xAxisLabels=l.theme.getIndicatorDates(l.indicator.id):C.yAxisLabels=l.theme.getIndicatorDates(l.indicator.id);C.render()}t=(new Date).getTime();a.isLoaded==!1&&ia.log("Time bar chart "+(t-q)+" ms")}if(z){q=(new Date).getTime();e=a.config.getComponent("timeSeries"+b);f=l.indicator.getDataType(J.dataField);if(f==ia.Thematic.CATEGORIC||l.indicator.date==void 0||l.theme.getIndicatorDates(l.indicator.id).length<2)z.hide(),a.getWidget("timeSeries"+
b+"-panel").text(e.getProperty("notAvailableText"));else{d=l.indicator.getProperty(e.getProperty("minChartValue"));f=l.indicator.getProperty(e.getProperty("maxChartValue"));d&&f?(z.useFixedValues=!0,z.useTightLabels=!0,z.fixedMinValue=d,z.fixedMaxValue=f):(z.useFixedValues=e.getProperty("useFixedValues"),z.useFixedValues?(z.useTightLabels=!0,z.fixedMinValue=e.getProperty("fixedMinValue"),z.fixedMaxValue=e.getProperty("fixedMaxValue")):z.useTightLabels=e.getProperty("useTightLabels"));if(d=e.getProperty("xAxisTitle"))z.xAxisTitle=
a.textSubstitution.formatMessage(d);if(d=e.getProperty("yAxisTitle"))z.yAxisTitle=a.textSubstitution.formatMessage(d);z.show();a.getWidget("timeSeries"+b+"-panel").text("");J.selectedDate=l.indicator.date;J.setData(L);R.selectedDate=l.indicator.date;R.setData(wa);z.orientation=="vertical"?z.xAxisLabels=l.theme.getIndicatorDates(l.indicator.id):z.yAxisLabels=l.theme.getIndicatorDates(l.indicator.id);z.render()}t=(new Date).getTime();a.isLoaded==!1&&ia.log("Time chart: "+(t-q)+" ms")}qa&&(q=(new Date).getTime(),
e=a.config.getComponent("timeControl"+b),l.indicator.date==void 0?(qa.container.hide(),a.getWidget("timeControl"+b+"-panel").text(e.getProperty("notAvailableText"))):(qa.container.show(),a.getWidget("timeControl"+b+"-panel").text("")),t=(new Date).getTime(),a.isLoaded==!1&&ia.log("Time control: "+(t-q)+" ms"));if(D&&a.config.template!=ia.DOUBLE_PLOT_REPORT&&a.config.template!=ia.DOUBLE_BASELAYER_REPORT_NEW&&a.config.template!=ia.BUBBLE_PLOT_REPORT){q=(new Date).getTime();e=a.config.getComponent("scatterPlot"+
b);d=l.indicator.getDataType(K.xDataField);f=l.indicator.getDataType(K.yDataField);if(d==ia.Thematic.CATEGORIC||f==ia.Thematic.CATEGORIC)D.hide(),a.getWidget("scatterPlot"+b+"-panel").text(e.getProperty("notAvailableText"));else{d=l.indicator.getProperty(e.getProperty("minChartValue"));f=l.indicator.getProperty(e.getProperty("maxChartValue"));d&&f?(D.useFixedValues=!0,D.useTightLabels=!0,D.fixedMinValue=d,D.fixedMaxValue=f):(D.useFixedValues=e.getProperty("useFixedValues"),D.useFixedValues?(D.useTightLabels=
!0,D.fixedMinValue=e.getProperty("fixedMinValue"),D.fixedMaxValue=e.getProperty("fixedMaxValue")):D.useTightLabels=e.getProperty("useTightLabels"));if(d=e.getProperty("xAxisTitle"))D.xAxisTitle=a.textSubstitution.formatMessage(d);if(d=e.getProperty("yAxisTitle"))D.yAxisTitle=a.textSubstitution.formatMessage(d);D.show();a.getWidget("scatterPlot"+b+"-panel").text("");K.setXData(l.indicatorData);K.setYData(l.indicatorData);K.setColorData(l.indicatorData);e.getProperty("sizeData")!=void 0&&K.setSizeData(va);
T.setXData(l.comparisonData);T.setYData(l.comparisonData);for(var f=[],g=[],d=1;d<6;d++){var h=e.getProperty("line_xfield_"+d),j=e.getProperty("line_yfield_"+d);h!=void 0&&j!=void 0&&(f.push(h),g.push(j))}e=D.getLayers();for(d=0;d<f.length;d++){var h=e[d+2],i=l.indicator.getProperty(f[d]),j=l.indicator.getProperty(g[d]);if(i!=void 0&&j!=void 0){var i=i.split(","),k=[];if(ia.isNumber(j))for(var m=0;m<i.length;m++)k.push(j);else k=j.split(",");h.setXData(i);h.setYData(k)}}D.render();d=l.indicator.precision||
2;e=a.locale.formatter;f=K.correlationInfo;a.textSubstitution.setVariable("correlationCoeff",e.format(f.correlationCoeff,d));a.textSubstitution.setVariable("rSquare",e.format(f.rSquare,d));a.textSubstitution.setVariable("gradient",e.format(f.gradient,d));a.textSubstitution.setVariable("intercept",e.format(f.intercept,d));a.updateDynamicText(a.textSubstitution)}t=(new Date).getTime();a.isLoaded==!1&&ia.log("Scatter Plot: "+(t-q)+" ms")}if(a.isLoaded==!1){if(a.url.params["select"+b]){d=a.url.params["select"+
b].toString().split(",");c.setSelection(d);d=d[d.length-1];if(e=l.geography.getFeature(d))a.textSubstitution.setVariable("selectedFeature"+b,e.name),a.updateDynamicText(a.textSubstitution);if(x){e=l.geography.getProfileData([d]);for(d=0;d<Y.length;d++)Y[d].setData(e.themes[0].indicators),ra[d].setData(e.themes[1].indicators);x.render()}}a.url.params["filter"+b]&&(d=a.url.params["filter"+b].split(","),O.zoomToFeatureWithName(d[1],l.mapData.noneBaseLayers));E&&(e=a.config.getTable("spineChart"+b),d=
e.getProperty("expandedThemeIds"),d!=void 0&&E.expandThemes(d));qa&&qa.setData(l.indicator);d=(new Date).getTime();ia.log("Rendering: "+(d-trenderstart)+" ms");ia.log("Total loading: "+(d-ca)+" ms");w&&w.call(null)}else o&&(E&&(e=a.config.getTable("spineChart"+b),d=e.getProperty("expandedThemeIds"),d!=void 0&&E.expandThemes(d)),l.dispatchEvent(new ia.DataEvent(ia.DataEvent.GEOG_CHANGED,l,l.geography,l.theme,l.indicator))),r?(U&&c.filteredFeatures.length==0&&U.clearSelection(),l.dispatchEvent(new ia.FilterEvent(ia.FilterEvent.FILTER_CHANGED,
l,y.id,y.name,y.value))):p&&l.dispatchEvent(new ia.DataEvent(ia.DataEvent.INDICATOR_CHANGED,l,l.geography,l.theme,l.indicator)),l.dispatchEvent(new ia.Event(ia.Event.RENDER,l)),H&&H.hideOnSelection&&a.getWidget("dataExplorer"+b+"-panel").hide(),U&&U.hideOnSelection&&a.getWidget("filterExplorer"+b+"-panel").hide(),na&&na.hideOnSelection&&a.getWidget("geogExplorer"+b+"-panel").hide();p=r=o=!1;a.endProgress()}function n(c,d){var e=a.config.getMapPalette(),f=d.getProperty(a.config.getProperty("customClassifierKey"+
b)),g=d.getProperty(a.config.getProperty("customColoursKey"+b)),h=d.getProperty(a.config.getProperty("customPaletteKey"+b)),j=d.getProperty(a.config.getProperty("customBreaksKey"+b)),i=d.getProperty(a.config.getProperty("customLabelsKey"+b)),k=c.categoricClassifier;k.breaks=[];k.labels=[];k.colorPalette=e.getColorScheme(s.schemeId);var l=c.numericClassifier;l.labels=[];l.classificationName=s.legendType;l.colorPalette=e.getColorPalette(s.paletteId);if(d.type===ia.Thematic.CATEGORIC){a.textSubstitution.setVariable("legendType"+
b,"");a.updateDynamicText(a.textSubstitution);if(j)k.breaks=j.split(";");if(i)k.labels=i.split(";");if(h)k.colorPalette=e.getColorScheme(h);if(g)e=g.split(";"),k.colorPalette=new ia.ColorPalette(e)}else{if(f)l.classificationName=f;a.textSubstitution.setVariable("legendType"+b,l.classificationName);a.updateDynamicText(a.textSubstitution);if(j){var m=j.split(";");l.getCalculator().addFunction("customClassifier",function(){return m});l.classificationName="customClassifier"}if(i)l.labels=i.split(";");
if(h)l.colorPalette=e.getColorPalette(h);if(g)e=g.split(";"),l.colorPalette=new ia.ColorPalette(e)}}ia.DataGroup.baseConstructor.call(this);var l=this,o=!1,p=!1,r=!1,s={},w,q,t,ca,v,L,O,u,da,ea,A,B,W,I,ha,z,J,F,Q,pa,sa,P,na,U,H,oa,ta,G,xa,C,X,M,E,D,K,x,ka,ba,Y,ra,N,qa,wa,ga,S,R,ja,aa,$,T,Z,V,fa,va,y={id:"",name:"",value:""};this.setData=function(c,d,e){var f=a.data.getGeography(c),d=f.getIndicator(d,e);if(d==void 0){e=!0;if(H){var g=a.config.getComponent("dataExplorer"+b),e=g.getProperty("reverseDates");
e==void 0&&(e=!0)}d=f.getFirstIndicator(e)}if(H){var g=a.config.getComponent("dataExplorer"+b),j=g.getProperty("showDates"),e=g.getProperty("reverseDates");e==void 0&&(e=!0);g=a.config.getComponent("geogExplorer");if(g!=void 0||a.config.template==ia.DOUBLE_GEOG_REPORT||a.config.template==ia.DOUBLE_BASELAYER_REPORT||a.config.template==ia.DOUBLE_PLOT_REPORT||a.config.template==ia.BUBBLE_PLOT_REPORT||a.config.template==ia.DOUBLE_BASELAYER_REPORT_NEW)H.data(f.getDataTree(j,e)),H.build(f.id);j&&d.date!=
void 0?H.showItem(f.id+"~"+d.id+"~"+d.date):H.showItem(f.id+"~"+d.id)}h(c,d.id,d.date)};this.setFilter=function(d,e){y.id=d;y.name=l.geography.getFilter(d).name;y.value=e;c.filteredFeatures=l.geography.getFilteredFeatures(y.id,y.value);a.textSubstitution.setVariable("filterName"+b,y.name);a.textSubstitution.setVariable("filterValue"+b,y.value);O!=void 0&&O.zoomToFeatureWithName(y.value,l.mapData.noneBaseLayers);c.clearSelection();r=!0;m();v.commitChanges()};this.clearFilter=function(){y.id="";y.name=
"";y.value="";c.filteredFeatures=[];a.textSubstitution.setVariable("filterName"+b,"");a.textSubstitution.setVariable("filterValue"+b,"");r=!0;m();v.commitChanges()};this.refresh=function(){h(l.geography.id,l.indicator.id,l.indicator.date)};this.refreshData=function(){g()};this.loadMap=function(a){e(a)};this.initGoogleMaps=function(){l.mapData.loadVisibleLayers()};this.build=function(g){w=g;ca=(new Date).getTime();q=(new Date).getTime();a.textSubstitution.setVariable("geogName"+b," ");a.textSubstitution.setVariable("themeName"+
b," ");a.textSubstitution.setVariable("indicatorName"+b," ");a.textSubstitution.setVariable("date"+b," ");a.textSubstitution.setVariable("filterName"+b,"");a.textSubstitution.setVariable("filterValue"+b,"");a.textSubstitution.setVariable("legendType"+b,"");a.updateDynamicText(a.textSubstitution);a.addComponent("interactionGroup"+b,c);a.addComponent("comparisonInteractionGroup"+b,d);c.addEventListener(ia.ItemEvent.ITEM_CLICK,function(c){if(c.item.state==ia.ItemLayer.UNSELECTED)a.textSubstitution.setVariable("selectedFeature"+
b,"");else if(c.item.parent==void 0||!c.item.parent.isLegendComponent){var d=c.item.name||l.geography.getFeature(c.item.id).name;a.textSubstitution.setVariable("selectedFeature"+b,d)}else a.textSubstitution.setVariable("selectedFeature"+b,"");a.updateDynamicText(a.textSubstitution);if(x){if(c.item.id!=void 0&&c.item.state==ia.ItemLayer.SELECTED){c=l.geography.getProfileData([c.item.id]);for(d=0;d<Y.length;d++)Y[d].setData(c.themes[0].indicators),ra[d].setData(c.themes[1].indicators)}else for(d=0;d<
Y.length;d++)Y[d].setData({}),ra[d].setData({});x.render()}if(z&&J.matchAxisToSelectedData)J.dataChanged=!0,z.render()});c.addEventListener(ia.Event.CLEAR_SELECTION,function(){a.textSubstitution.setVariable("selectedFeature"+b,"");a.updateDynamicText(a.textSubstitution);if(x){for(var c=0;c<Y.length;c++)Y[c].setData({}),ra[c].setData({});x.render()}if(z&&J.matchAxisToSelectedData)J.dataChanged=!0,z.render()});d.addEventListener(ia.ItemEvent.ITEM_CLICK,function(){k()});v=new ia.Thematic;v.noDataValue=
a.locale.formatter.noDataValue;v.setDataField(a.config.getProperty("data"+b));v.addEventListener(ia.Event.THEME_CHANGED,function(){if(l.indicator.getDataType(v.getDataField())==ia.Thematic.CATEGORIC)a.textSubstitution.setVariable("mean"+b,""),a.textSubstitution.setVariable("median"+b,""),a.textSubstitution.setVariable("sum"+b,""),a.textSubstitution.setVariable("maxValue"+b,""),a.textSubstitution.setVariable("range"+b,""),a.textSubstitution.setVariable("lowerQuartile"+b,""),a.textSubstitution.setVariable("upperQuartile"+
b,""),a.textSubstitution.setVariable("interquartileRange"+b,""),a.textSubstitution.setVariable("variance"+b,""),a.textSubstitution.setVariable("standardDeviation"+b,"");else{var c=-1;ea&&(c=a.config.getComponent("statsbox"+b),c=c.getProperty("ndecimal"));c==-1&&(c=l.indicator.precision||2,c==void 0&&(c=2));var d=a.locale.formatter,e=v.numericClassifier.getCalculator().getStats();a.textSubstitution.setVariable("sum"+b,d.format(e.sum,c));a.textSubstitution.setVariable("mean"+b,d.format(e.mean,c));a.textSubstitution.setVariable("median"+
b,d.format(e.median,c));a.textSubstitution.setVariable("minValue"+b,d.format(e.minValue,c));a.textSubstitution.setVariable("maxValue"+b,d.format(e.maxValue,c));a.textSubstitution.setVariable("range"+b,d.format(e.range,c));a.textSubstitution.setVariable("lowerQuartile"+b,d.format(e.lowerQuartile,c));a.textSubstitution.setVariable("upperQuartile"+b,d.format(e.upperQuartile,c));a.textSubstitution.setVariable("interquartileRange"+b,d.format(e.interquartileRange,c));a.textSubstitution.setVariable("variance"+
b,d.format(e.variance,c));a.textSubstitution.setVariable("standardDeviation"+b,d.format(e.standardDeviation,c))}a.updateDynamicText(a.textSubstitution);ea&&(c=a.config.getComponent("statsbox"+b),c=a.textSubstitution.formatMessage(c.getProperty("text")),ea.setHtml(c));a.startProgress(!1,function(){k()})});var j=a.config.getMapPalette(),g=v.categoricClassifier;g.formatter=a.locale.formatter;g.colorPalette=j.getColorScheme(j.defaultSchemeId);s.schemeId=j.defaultSchemeId;s.paletteId=b!=""?a.config.getProperty("mapPalette"+
b)||j.defaultPaletteId:j.defaultPaletteId;s.legendType=a.config.getProperty("legendClassifier"+b)||"quantile";g=v.numericClassifier;g.noClasses=j.noClasses;g.formatter=a.locale.formatter;g.classificationName=s.legendType;g.colorPalette=j.getColorPalette(s.paletteId);g.sdLabels=[a.config.getProperty("sd1"),a.config.getProperty("sd2"),a.config.getProperty("sd3"),a.config.getProperty("sd4"),a.config.getProperty("sd5"),a.config.getProperty("sd6")];if(a.config.getProperty("sdSize"))g.getCalculator().sdSize=
a.config.getProperty("sdSize");ga=new ia.Thematic;ga.setDataType(ia.Thematic.CATEGORIC);ga.setDataField("id");if(g=a.getWidget("featureLegend"+b+"-panel")){var i=a.config.getComponent("featureLegend"+b);M=new ia.FeatureLegend("feature-legend");M.highlightColor=a.highlightColor;M.selectionColor=a.selectionColor;if(i.getProperty("layout"))M.layout=i.getProperty("layout");var n=i.getProperty("colorSchemeId");M.colorPalette=j.getColorScheme(n);c.addComponent(M);g.append(M.container);a.addComponent("featureLegend"+
b,M)}if(g=a.getWidget("dataExplorer"+b+"-panel"))i=a.config.getComponent("dataExplorer"+b),H=new ia.DataExplorer("dataExplorer"+b,function(b){var c=b.split("~"),b=c[0],d=c[1],c=c[2];if(a.config.template==ia.BUBBLE_PLOT_REPORT){var e=a.config.getComponent("scatterPlot");if(e&&e.getProperty("syncDates")==!0)c=l.indicator.date}if(c==void 0)c=l.indicator.date;h(b,d,c)}),H.closeBranchesOnSelection=i.getProperty("closeBranchesOnSelection"),H.hideOnSelection=i.getProperty("hideOnSelection"),g.append(H.container),
a.addComponent("dataExplorer"+b,H);if(g=a.getWidget("geogExplorer"+b+"-panel"))i=a.config.getComponent("geogExplorer"+b),na=new ia.DataExplorer("geogExplorer"+b,function(b){a.data.getGeography(b);l.setData(b,l.indicator.id,l.indicator.date)}),na.hideOnSelection=i.getProperty("hideOnSelection"),g.append(na.container),a.addComponent("geogExplorer"+b,na);if(g=a.getWidget("filterExplorer"+b+"-panel"))i=a.config.getComponent("filterExplorer"+b),U=new ia.DataExplorer("filterExplorer"+b,function(d){if(d==
"clearFilter")y.id="",y.value="",y.name="",c.filteredFeatures=[],a.textSubstitution.setVariable("filterName"+b,""),a.textSubstitution.setVariable("filterValue"+b,"");else{var d=d.split("~"),e=l.indicator.geography;y.id=d[0];y.value=d[1];y.name=e.getFilter(y.id).name;c.filteredFeatures=e.getFilteredFeatures(y.id,y.value);a.textSubstitution.setVariable("filterName"+b,y.name);a.textSubstitution.setVariable("filterValue"+b,y.value);O&&O.zoomToFeatureWithName(y.value,l.mapData.noneBaseLayers)}c.clearSelection();
r=!0;m();v.commitChanges()}),U.closeBranchesOnSelection=i.getProperty("closeBranchesOnSelection"),U.hideOnSelection=i.getProperty("hideOnSelection"),U.isFilterExplorer=!0,g.append(U.container),a.addComponent("filterExplorer"+b,U);if(g=a.getWidget("timeControl"+b+"-panel"))i=a.config.getComponent("timeControl"+b),qa=new ia.TimeControl("timeControl"+b,l,function(a){if(J)J.animationMode=a;if(R)R.animationMode=a}),qa.delay=i.getProperty("delay"),g.append(qa.container),a.addComponent("timeControl"+b,qa);
if(g=a.getWidget("comparisonTable"+b+"-panel"))i=a.config.getTable("comparisonTable"+b),S=new ia.ComparisonTable("comparisonTable"+b),S.thematic=ga,S.highlightColor=a.highlightColor,S.selectionColor=a.selectionColor,S.showLegendColor=i.getProperty("showLegendColor"),S.allowUserSorting=i.getProperty("allowUserSorting"),g.append(S.container),d.addComponent(S),n=i.getProperty("colorSchemeId"),ga.categoricClassifier.colorPalette=j.getColorScheme(n),g.exportFunction=function(){S.exportData(a.config.getProperty("saveTableText"))},
a.addComponent("comparisonTable"+b,S);if(g=a.getWidget("boxAndWhisker"+b+"-panel"))i=a.config.getComponent("boxAndWhisker"+b),F=new ia.BoxChart("boxAndWhisker"+b),F.formatter=a.locale.formatter,F.orientation=i.getProperty("orientation"),g.append(F.container),Q=new ia.BoxLayer,Q.sortDirection=i.getProperty("sortDirection"),Q.setVisible(!0),Q.interactive=!0,Q.tipFunction=function(a){return ia.tipFunction(a,"boxAndWhisker"+b)},Q.highlightColor=a.highlightColor,Q.selectionColor=a.selectionColor,c.addComponent(Q),
Q.largestObservationField=i.getProperty("largestObservationField"),Q.upperQuartileField=i.getProperty("upperQuartileField"),Q.medianField=i.getProperty("medianField"),Q.lowerQuartileField=i.getProperty("lowerQuartileField"),Q.smallestObservationField=i.getProperty("smallestObservationField"),F.addLayer(Q),$=new ia.ComparisonLineLayer,$.dataField="value",$.setVisible(!0),$.interactive=!0,$.tipFunction=function(a){return ia.tipFunction(a,"boxAndWhisker"+b)},$.highlightColor=a.highlightColor,$.selectionColor=
a.selectionColor,$.displayAll=i.getProperty("showComparison"),d.addComponent($),F.addLayer($),g.exportFunction=function(){F.exportData(a.config.getProperty("saveImageText"))},a.addComponent("boxAndWhisker"+b,F);if(g=a.getWidget("barChart"+b+"-panel"))i=a.config.getComponent("barChart"+b),B=new ia.BarChart("barChart"+b),B.formatter=a.locale.formatter,B.orientation=i.getProperty("orientation"),B.drawBarsFromZero=i.getProperty("drawBarsFromZero"),g.append(B.container),W=new ia.BarLayer,W.sortDirection=
i.getProperty("sortDirection"),W.dataField=i.getProperty("data")||"value",W.setVisible(!0),W.interactive=!0,W.errorBarColor=i.getProperty("errorBarColor"),W.tipFunction=function(a){return ia.tipFunction(a,"barChart"+b)},W.highlightColor=a.highlightColor,W.selectionColor=a.selectionColor,c.addComponent(W),B.addLayer(W),ja=new ia.ComparisonLineLayer,ja.dataField=i.getProperty("data")||"value",ja.setVisible(!0),ja.interactive=!0,ja.tipFunction=function(a){return ia.tipFunction(a,"barChart"+b)},ja.highlightColor=
a.highlightColor,ja.selectionColor=a.selectionColor,ja.displayAll=i.getProperty("showComparison"),d.addComponent(ja),B.addLayer(ja),I=new ia.BarChart("countChart"+b),I.orientation=i.getProperty("orientation"),I.formatter=a.locale.formatter,I.drawBarsFromZero=i.getProperty("drawBarsFromZero"),g.append(I.container),ha=new ia.CountLayer,ha.thematic=v,ha.sortDirection=i.getProperty("sortDirection"),ha.dataField=i.getProperty("data")||"value",ha.setVisible(!0),ha.interactive=!0,ha.highlightColor=a.highlightColor,
ha.selectionColor=a.selectionColor,c.addComponent(ha),I.addLayer(ha),g.exportFunction=function(){B.isVisible?B.exportData(a.config.getProperty("saveImageText")):I.isVisible&&I.exportData(a.config.getProperty("saveImageText"))},a.addComponent("barChart"+b,B),a.addComponent("countChart"+b,I);if(g=a.getWidget("pyramidChart"+b+"-panel")){i=a.config.getComponent("pyramidChart"+b);x=new ia.PyramidChart("pyramidChart"+b);x.formatter=a.locale.formatter;x.orientation="horizontal";x.drawBarsFromZero=i.getProperty("drawBarsFromZero");
x.showYAxisLabels=i.getProperty("showYAxisLabels");g.append(x.container);ra=[];Y=[];ka=new ia.PyramidLayer;ka.dataField=i.getProperty("data")||"value";ka.setVisible(!0);ka.interactive=!0;ka.tip=i.getProperty("tip");ka.highlightColor=a.highlightColor;ka.selectionColor=a.selectionColor;x.addLayer(ka);ka.style.fillStyle=ia.Color.toRGBA(i.getProperty("maleColor"),0.8);ka.style.strokeStyle=i.getProperty("maleColor");Y[Y.length]=ka;ba=new ia.PyramidLayer;ba.gender="female";ba.dataField=i.getProperty("data")||
"value";ba.setVisible(!0);ba.interactive=!0;ba.tip=i.getProperty("tip");ba.highlightColor=a.highlightColor;ba.selectionColor=a.selectionColor;x.addLayer(ba);ba.style.fillStyle=ia.Color.toRGBA(i.getProperty("femaleColor"),0.8);ba.style.strokeStyle=i.getProperty("femaleColor");ra[ra.length]=ba;Z=new ia.ComparisonPyramidLayer;Z.dataField=i.getProperty("data")||"value";Z.setVisible(!0);Z.interactive=!0;Z.thematic=ga;Z.displayAll=i.getProperty("showComparison");Z.tip=i.getProperty("tip");Z.highlightColor=
a.highlightColor;Z.selectionColor=a.selectionColor;x.addLayer(Z);d.addComponent(Z);V=new ia.ComparisonPyramidLayer;V.gender="female";V.dataField=i.getProperty("data")||"value";V.setVisible(!0);V.interactive=!0;V.tip=i.getProperty("tip");V.thematic=ga;V.displayAll=i.getProperty("showComparison");V.highlightColor=a.highlightColor;V.selectionColor=a.selectionColor;x.addLayer(V);d.addComponent(V);var n=[],p=i.getProperty("femaleLabel"),o=new ia.CategoricClass(p);o.color=i.getProperty("femaleColor");o.symbol=
ia.Shape.SQUARE;o.size=12;o.value=p;n[n.length]=o;o=new ia.CategoricClass(i.getProperty("maleLabel"));p=i.getProperty("maleLabel");o=new ia.CategoricClass(p);o.color=i.getProperty("maleColor");o.symbol=ia.Shape.SQUARE;o.size=12;o.value=p;n[n.length]=o;for(var u=1;u<=3;u++)if(i.getProperty("line_value_"+u)!=void 0){var o=i.getProperty("line_value_"+u),L=i.getProperty("line_color_"+u),p=i.getProperty("line_label_"+u),ma=new ia.ComparisonPyramidLayer;ma.dataField=o;ma.setVisible(!0);ma.interactive=!0;
ma.displayAll=!0;ma.tip=i.getProperty("tip");ma.highlightColor=a.highlightColor;x.addLayer(ma);ma.style.strokeStyle=L;var la=new ia.ComparisonPyramidLayer;la.gender="female";la.dataField=o;la.setVisible(!0);la.interactive=!0;la.tip=i.getProperty("tip");la.displayAll=!0;la.highlightColor=a.highlightColor;x.addLayer(la);la.style.strokeStyle=L;ra[ra.length]=la;Y[Y.length]=ma;o=new ia.CategoricClass(p);o.color=L;o.symbol=ia.Shape.HORIZONTAL_LINE;o.size=12;o.value=p;n[n.length]=o}g.exportFunction=function(){x.isVisible&&
x.exportData(a.config.getProperty("saveImageText"))};a.addComponent("pyramidChart"+b,x);if(g=a.getWidget("pyramidLegend"+b+"-panel")){i=a.config.getComponent("pyramidLegend"+b);o=new ia.ProfileLegend("pyramid-legend");o.legendClasses=n;if(i.getProperty("layout"))o.layout=i.getProperty("layout");g.append(o.container);a.addComponent("pyramidLegend"+b,o);o.render()}}if(g=a.getWidget("discreteTimeSeries"+b+"-panel")){i=a.config.getComponent("discreteTimeSeries"+b);C=new ia.TimeBarChart("discreteTimeSeries"+
b);C.orientation=i.getProperty("orientation");C.formatter=a.locale.formatter;C.drawBarsFromZero=i.getProperty("drawBarsFromZero");g.append(C.container);X=new ia.TimeBarLayer;X.dataField=i.getProperty("data")||"value";X.setVisible(!0);X.interactive=!0;X.highlightColor=a.highlightColor;X.selectionColor=a.selectionColor;X.tip=i.getProperty("tip");if(M)X.colorPalette=M.colorPalette;else if(a.getComponent("featureLegend"))X.colorPalette=a.getComponent("featureLegend").colorPalette;c.addComponent(X);C.addLayer(X);
aa=new ia.ComparisonTimeBarLayer;aa.dataField=i.getProperty("data")||"value";aa.setVisible(!0);aa.interactive=!0;aa.highlightColor=a.highlightColor;aa.selectionColor=a.selectionColor;aa.displayAll=i.getProperty("showComparison");aa.tip=i.getProperty("tip");aa.thematic=ga;d.addComponent(aa);C.addLayer(aa);g.exportFunction=function(){C.exportData(a.config.getProperty("saveImageText"))};a.addComponent("discreteTimeSeries"+b,C)}if(g=a.getWidget("timeSeries"+b+"-panel")){i=a.config.getComponent("timeSeries"+
b);z=new ia.TimeChart("timeSeries"+b);z.orientation=i.getProperty("orientation");z.formatter=a.locale.formatter;g.append(z.container);J=new ia.TimeLayer;J.dataField=i.getProperty("data")||"value";J.setVisible(!0);J.interactive=!0;J.highlightColor=a.highlightColor;J.selectionColor=a.selectionColor;J.tip=i.getProperty("tip");J.drawLinesThroughMissingValues=i.getProperty("drawLinesThroughMissingValues");J.matchAxisToSelectedData=i.getProperty("matchAxisToSelectedData");if(M)J.colorPalette=M.colorPalette;
else if(a.getComponent("featureLegend"))J.colorPalette=a.getComponent("featureLegend").colorPalette;c.addComponent(J);z.addLayer(J);R=new ia.ComparisonTimeLayer;R.dataField=i.getProperty("data")||"value";R.setVisible(!0);R.interactive=!0;R.highlightColor=a.highlightColor;R.selectionColor=a.selectionColor;R.displayAll=i.getProperty("showComparison");R.tip=i.getProperty("tip");R.drawLinesThroughMissingValues=i.getProperty("drawLinesThroughMissingValues");R.thematic=ga;d.addComponent(R);z.addLayer(R);
g.exportFunction=function(){z.exportData(a.config.getProperty("saveImageText"))};a.addComponent("timeSeries"+b,z)}if(g=a.getWidget("scatterPlot"+b+"-panel")){i=a.config.getComponent("scatterPlot"+b);D=new ia.Plot("scatterPlot"+b);D.formatter=a.locale.formatter;g.append(D.container);K=new ia.PlotLayer;K.pointSize=i.getProperty("minBubbleSize")||i.getProperty("pointSize");K.xDataField=i.getProperty("xData");K.yDataField=i.getProperty("yData");K.showCorrelationLine=i.getProperty("showCorrelationLine");
K.setVisible(!0);K.interactive=!0;K.tipFunction=function(a){return ia.tipFunction(a,"scatterPlot"+b)};K.highlightColor=a.highlightColor;K.selectionColor=a.selectionColor;c.addComponent(K);D.addLayer(K);T=new ia.ComparisonPlotLayer;T.pointSize=i.getProperty("minBubbleSize")||i.getProperty("pointSize");T.xDataField=i.getProperty("xData");T.yDataField=i.getProperty("yData");T.setVisible(!0);T.interactive=!0;T.tipFunction=function(a){return ia.tipFunction(a,"scatterPlot"+b)};T.highlightColor=a.highlightColor;
T.selectionColor=a.selectionColor;T.displayAll=i.getProperty("showComparison");d.addComponent(T);D.addLayer(T);for(u=1;u<6;u++)if(n=i.getProperty("line_xfield_"+u),o=i.getProperty("line_yfield_"+u),n!=void 0&&o!=void 0){var ua=new ia.LineLayer;ua.highlightColor=a.highlightColor;ua.selectionColor=a.selectionColor;ua.style.strokeStyle=i.getProperty("line_color_"+u);ua.setVisible(!0);ua.interactive=!0;(function(){var a=i.getProperty("line_label_"+u);ua.tipFunction=function(){return a}})();D.addLayer(ua)}if(a.config.template==
ia.BUBBLE_PLOT_REPORT_SINGLE&&i.getProperty("sizeData")!=void 0)fa=new ia.Thematic,fa.setDataField(i.getProperty("sizeData")),fa.classificationName=ia.Thematic.CONTINUOUS,n=fa.numericClassifier.sizePalette,n.minSize=i.getProperty("minBubbleSize"),n.maxSize=i.getProperty("maxBubbleSize"),fa.categoricClassifier.symbolSize=8;g.exportFunction=function(){D.exportData(a.config.getProperty("saveImageText"))};a.addComponent("scatterPlot"+b,D)}if(g=a.getWidget("pieChart"+b+"-panel"))i=a.config.getComponent("pieChart"+
b),pa=new ia.PieChart("pieChart"+b),g.append(pa.container),sa=new ia.PieLayer,sa.thematic=v,sa.setVisible(!0),sa.interactive=!0,sa.highlightColor=a.highlightColor,sa.selectionColor=a.selectionColor,sa.tip=i.getProperty("tip"),c.addComponent(sa),pa.addLayer(sa),g.exportFunction=function(){pa.exportData(a.config.getProperty("saveImageText"))},a.addComponent("pieChart"+b,pa);if(g=a.getWidget("advancedPieChart"+b+"-panel"))i=a.config.getComponent("advancedPieChart"+b),G=new ia.AdvancedPieComponent("advancedPieChart"+
b,i.getProperty("layout")),G.highlightColor=a.highlightColor,G.selectionColor=a.selectionColor,G.tip=i.getProperty("tip"),G.build(),G.title1=i.getProperty("title1"),G.title2=i.getProperty("title2"),c.addComponent(G),g.append(G.container),n=i.getProperty("colorSchemeId"),G.thematic.categoricClassifier.colorPalette=j.getColorScheme(n),a.addComponent("advancedPieChart"+b,G);if(g=a.getWidget("table"+b+"-panel")){i=a.config.getTable("table"+b);P=new ia.Table("table"+b);P.highlightColor=a.highlightColor;
P.selectionColor=a.selectionColor;P.showLegendColor=i.getProperty("showLegendColor");P.allowUserSorting=i.getProperty("allowUserSorting");g.append(P.container);c.addComponent(P);i.getProperty("zoomOnSelection")&&P.addEventListener(ia.ItemEvent.ITEM_CLICK,function(a){a=a.item;(a.state==ia.ItemLayer.SELECTED||a.state==ia.ItemLayer.ROLLOVER_SELECTED)&&O&&O.zoomToFeatureWithId(a.id)});if(i.getProperty("clearButtonText")!=void 0||i.getProperty("filterButtonText")!=void 0)n=new ia.TableTools(P,c),n.clearButtonText=
i.getProperty("clearButtonText"),n.filterButtonText=i.getProperty("filterButtonText"),n.filterFunction=function(){y.id="";y.value="";y.name="";a.textSubstitution.setVariable("filterName"+b,"");a.textSubstitution.setVariable("filterValue"+b,"");c.clearSelection();r=!0;m();v.commitChanges()},g.appendToFooter(n.container),n.render();g.exportFunction=function(){P.exportData(a.config.getProperty("saveTableText"))};a.addComponent("table"+b,P)}if(g=a.getWidget("spineChart"+b+"-panel")){i=a.config.getTable("spineChart"+
b);n=i.getProperty("useMouseClick");n==void 0&&(n=!0);E=new ia.Profile("spineChart"+b,n,function(b){a.config.template!=ia.ELECTION_REPORT&&(b=b.split("~"),h(l.geography.id,b[0],b[1]))});if(M)d.addComponent(M),E.colorPalette=M.colorPalette;n=[];j=[];for(u=1;u<=12;u++)if(i.getProperty("symbol_value_"+u)!=void 0)p={},p.shape=i.getProperty("symbol_shape_"+u),p.color=i.getProperty("symbol_color_"+u),p.size=i.getProperty("symbol_size_"+u),p.label=i.getProperty("symbol_label_"+u),p.value=i.getProperty("symbol_value_"+
u),j[j.length]=p,o=new ia.CategoricClass(p.label),o.color=p.color,o.symbol=p.shape,o.size=p.size,o.value=p.label,n[n.length]=o;E.symbols=j;j=[];for(u=1;u<=4;u++)if(i.getProperty("target_data_"+u)!=void 0)p={},p.shape=i.getProperty("target_shape_"+u),p.color=i.getProperty("target_color_"+u),p.size=i.getProperty("target_size_"+u),p.label=i.getProperty("target_label_"+u),p.data=i.getProperty("target_data_"+u),j[j.length]=p,o=new ia.CategoricClass(p.label),o.color=p.color,o.symbol=p.shape,o.size=p.size,
o.value=p.label,n[n.length]=o;E.targets=j;j={};j.data=i.getProperty("barData");j.color=i.getProperty("barColor");j.symbolValue=i.getProperty("symbolValue");j.height=i.getProperty("barHeight");j.minValue=i.getProperty("minValue");j.maxValue=i.getProperty("maxValue");j.breaksData=i.getProperty("breakData");j.breaksFlip=i.getProperty("breakFlipData");E.bar=j;E.displayMode=i.getProperty("displayMode");E.displayDatesInProfile=i.getProperty("displayDatesInProfile");E.useMouseClick=i.getProperty("useMouseClick");
j=[];for(u=1;u<=5;u++)if(i.getProperty("break_label_"+u)!=void 0)p={},p.color=i.getProperty("break_color_"+u),p.label=i.getProperty("break_label_"+u),j[j.length]=p,o=new ia.CategoricClass(p.label),o.color=p.color,o.symbol=ia.Shape.SQUARE,o.size=10,o.value=p.label,n[n.length]=o;E.breaks=j;g.append(E.container);c.addComponent(E);d.addComponent(E);a.addComponent("spineChart"+b,E);if(g=a.getWidget("profileLegend"+b+"-panel")){i=a.config.getComponent("profileLegend"+b);j=new ia.ProfileLegend("profile-legend");
j.legendClasses=n;if(i.getProperty("layout"))j.layout=i.getProperty("layout");g.append(j.container);a.addComponent("profileLegend"+b,j);j.render()}}if(g=a.getWidget("featureCard"+b+"-panel")){i=a.config.getComponent("featureCard"+b);N=new ia.FeatureCard("featureCard"+b,i.getProperty("snippet"));N.displayMode=i.getProperty("displayMode");N.dataOrder=i.getProperty("dataOrder");N.displaySelectedDateOnly=i.getProperty("displaySelectedDateOnly");N.displayFeatureHeader=i.getProperty("displayFeatureHeader");
N.displayThemeHeader=i.getProperty("displayThemeHeader");if(i.getProperty("ignoreThemeIds")!=void 0)N.ignoreThemeIds=i.getProperty("ignoreThemeIds");if(i.getProperty("ignoreIndicatorIds")!=void 0)N.ignoreIndicatorIds=i.getProperty("ignoreIndicatorIds");g.append(N.container);c.addComponent(N);a.addComponent("featureCard"+b,N)}if(g=a.getWidget("legend"+b+"-panel")){oa=new ia.DiscreteLegend("legend"+b+"-discrete");oa.highlightColor=a.highlightColor;oa.selectionColor=a.selectionColor;oa.thematic=v;c.addComponent(oa);
ta=new ia.GradientLegend("legend"+b+"-gradient");ta.highlightColor=a.highlightColor;ta.thematic=v;c.addComponent(ta);A=new ia.LayerList("legend"+b);A.discreteLegend=oa;A.gradientLegend=ta;i=a.config.getComponent("legend"+b);if(i.getProperty("showLegendEditorButton")==!0)j=new ia.CalloutBox("legend"+b+"-callout","left-right"),j.popup(!0),a.addCallout(j),n=new ia.LegendEditor(v,a.config,s),j.container.append(n.container),j=a.config.getProperty("showLegendTypePanel"),j==void 0&&(j=!0),o=a.config.getProperty("showLegendTools"),
o==void 0&&(o=!0),p=a.config.getProperty("showPalettePanel"),p==void 0&&(p=!0),L=a.config.getProperty("showSizePanel"),L==void 0&&(L=!0),n.showLegendTypePanel=j,n.showLegendTools=o,n.showPalettePanel=p,n.showSizePanel=L,g.hasSettings(!0),g.settingsFunction=function(a){ia.toggleCallout("legend"+b+"-callout",a)};g.append(A.container);a.addComponent("legend"+b,A)}if(g=a.getWidget("metadata"+b+"-panel"))da=new ia.Metadata("metadata"+b),g.append(da.container),a.addComponent("metadata"+b,da);if(g=a.getWidget("statsbox"+
b+"-panel"))ea=new ia.Metadata("statsbox"+b),g.append(ea.container),a.addComponent("statsbox"+b,ea);if(g=a.getWidget("menuBar"+b+"-panel"))ia.File.getFileDirectory(a.url.params.config),i=a.config.getComponent("menuBar"+b),n=new ia.MenuBar("menuBar"+b,i),g.append(n.container),a.addComponent("menuBar"+b,n);t=(new Date).getTime();a.isLoaded==!1&&ia.log("Build components: "+(t-q)+" ms");e(a.url.params.dataPath+a.url.params.map,f)}};ia.extend(ia.EventDispatcher,ia.DataGroup);ia.Color=function(){};
ia.Color.r=function(a){var b;ia.Color.isHSV(a)?b=ia.parseInt(ia.Color.cutRgb(ia.Color.HSVtoRGB(a))[0]):ia.Color.isHex(a)?b=ia.parseInt(ia.Color.cutHex(a).substring(0,2),16):ia.Color.isRGB(a)&&(b=ia.parseInt(ia.Color.cutRgb(a)[0]));return b};ia.Color.g=function(a){var b;ia.Color.isHSV(a)?b=ia.parseInt(ia.Color.cutRgb(ia.Color.HSVtoRGB(a))[1]):ia.Color.isHex(a)?b=ia.parseInt(ia.Color.cutHex(a).substring(2,4),16):ia.Color.isRGB(a)&&(b=ia.parseInt(ia.Color.cutRgb(a)[1]));return b};
ia.Color.b=function(a){var b;ia.Color.isHSV(a)?b=ia.parseInt(ia.Color.cutRgb(ia.Color.HSVtoRGB(a))[2]):ia.Color.isHex(a)?b=ia.parseInt(ia.Color.cutHex(a).substring(4,6),16):ia.Color.isRGB(a)&&(b=ia.parseInt(ia.Color.cutRgb(a)[2]));return b};ia.Color.a=function(a){var b;ia.Color.isHSV(a)?b=parseFloat(a[3]):ia.Color.isHex(a)?b=parseFloat(ia.Color.cutHex(a).substring(6,8),16):ia.Color.isRGB(a)&&(b=parseFloat(ia.Color.cutRgb(a)[3]));return b};ia.Color.h=function(a){return ia.Color.toHSVA(a)[0]};
ia.Color.s=function(a){return ia.Color.toHSVA(a)[1]};ia.Color.v=function(a){return ia.Color.toHSVA(a)[2]};ia.Color.toRGBA=function(a,b){var c=b;c==void 0&&(c=1);var d=ia.Color.r(a),e=ia.Color.g(a),f=ia.Color.b(a);return ia.Color.rgba(d,e,f,c)};ia.Color.toHex=function(a){var b=ia.Color.r(a),c=ia.Color.g(a),a=ia.Color.b(a);return"#"+ia.Color.intToHex(b)+ia.Color.intToHex(c)+ia.Color.intToHex(a)};
ia.Color.toHSVA=function(a,b){var c=ia.Color.r(a),d=ia.Color.g(a),e=ia.Color.b(a),f,g=Math.max(c,d,e),h=Math.min(c,d,e);g===h?f=0:g===c?f=(60*(d-e)/(g-h)+360)%360:g===d?f=60*(e-c)/(g-h)+120:g===e&&(f=60*(c-d)/(g-h)+240);return[f,g===0?0:(1-h/g)*100,g/255*100,b]};
ia.Color.HSVtoRGB=function(a){var b=a[0],c=a[1]/100,d=a[2]/100*255,a=a[3];b<0&&(b+=360);var e=b/60-Math.floor(b/60),f=d*(1-c),g=d*(1-e*c),c=d*(1-(1-e)*c),h,j,i;switch(Math.floor(b/60)%6){case 0:h=d;j=c;i=f;break;case 1:h=g;j=d;i=f;break;case 2:h=f;j=d;i=c;break;case 3:h=f;j=g;i=d;break;case 4:h=c;j=f;i=d;break;case 5:h=d,j=f,i=g}return ia.Color.rgba(h,j,i,a)};
ia.Color.validHex=function(a){a=a.replace(/[^#a-fA-F0-9]/g,"");a=a.toLowerCase();a.match(/#/g)&&a.match(/#/g).length>1&&(a=a.replace(/#/g,""));a.indexOf("#")==-1&&(a="#"+a);a.length>7&&(a=a.substr(0,7));return a};ia.Color.intToHex=function(a){if(a==null)return"00";a=ia.parseInt(a);if(a==0||isNaN(a))return"00";a=Math.max(0,a);a=Math.min(a,255);a=Math.round(a);return"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16)};
ia.Color.cutHex=function(a){return a.charAt(0)=="#"?a.substring(1,7):a};ia.Color.cutRgb=function(a){return a.substring(a.indexOf("(")+1,a.indexOf(")")).split(",")};ia.Color.isHex=function(a){return a.indexOf("#")==0};ia.Color.isRGB=function(a){return a.indexOf("rgb")!=-1};ia.Color.isHSV=function(a){return Object.prototype.toString.call(a)==="[object Array]"};ia.Color.rgba=function(a,b,c,d){d==void 0&&(d=1);return"rgba("+Math.floor(a)+","+Math.floor(b)+","+Math.floor(c)+","+d+")"};
ia.Color.getInterpolatedColor=function(a,b,c){var d;return ia.Color.rgba((d=ia.Color.r(a))+c*(ia.Color.r(b)-d),(d=ia.Color.g(a))+c*(ia.Color.g(b)-d),(d=ia.Color.b(a))+c*(ia.Color.b(b)-d))};ia.Color.getRandomColor=function(){return ia.Color.rgba(Math.round(Math.random()*255),Math.round(Math.random()*255),Math.round(Math.random()*255))};ia.Color.lighten=function(a,b){var c=ia.Color.toHSVA(a),d=c[2];d+=d*b;d>100&&(d=100);d<0&&(d=0);c[2]=d;return ia.Color.toHex(c)};
ia.Color.darken=function(a,b){return ia.Color.lighten(a,b*-1)};ia.Color.adjustSV=function(a,b,c){a=ia.Color.toHSVA(a);a[1]=b;a[2]=c;return ia.Color.toHex(a)};ia.Color.saturate=function(a,b){var c=ia.Color.toHSVA(a),d=c[1];d+=d*b;d>100&&(d=100);d<0&&(d=0);c[1]=d;return ia.Color.toHex(c)};ia.Color.desaturate=function(a,b){return ia.Color.saturate(a,b*-1)};ia.Color.hueShift=function(a,b){for(a+=b;a>=360;)a-=360;for(;a<0;)a+=360;return a};
ia.Color.complement=function(a){a=ia.Color.toHSVA(a);a[0]=ia.Color.hueShift(a[0],180);return ia.Color.toHex(a)};ia.Color.triad=function(a){var b=ia.Color.toHSVA(a),c=b[0],a=[ia.Color.hueShift(c,156),b[1],b[2]],b=[ia.Color.hueShift(c,204),b[1],b[2]];return[ia.Color.toHex(a),ia.Color.toHex(b)]};ia.Shape=function(){};ia.Shape.CIRCLE="circle";ia.Shape.SQUARE="square";ia.Shape.LINE="line";ia.Shape.VERTICAL_LINE="vertical line";ia.Shape.HORIZONTAL_LINE="horizontal line";ia.Shape.MINUS="minus";
ia.Shape.PLUS="plus";ia.Shape.X="x";ia.Shape.DIAMOND="diamond";ia.Shape.STAR="star";ia.Shape.TRIANGLE_UP="triangle up";ia.Shape.TRIANGLE_DOWN="triangle down";ia.Shape.TRIANGLE_RIGHT="triangle right";ia.Shape.TRIANGLE_LEFT="triangle left";ia.Shape.ARROW_UP="arrow up";ia.Shape.ARROW_DOWN="arrow down";ia.Shape.ARROW_RIGHT="arrow right";ia.Shape.ARROW_LEFT="arrow left";
ia.Shape.draw=function(a,b,c,d,e){switch(a){case ia.Shape.SQUARE:this.drawSquare(b,c,d,e);break;case ia.Shape.LINE:this.drawLine(b,c,d,e);break;case ia.Shape.VERTICAL_LINE:this.drawVerticalLine(b,c,d,e);break;case ia.Shape.HORIZONTAL_LINE:this.drawHorizontalLine(b,c,d,e);break;case ia.Shape.MINUS:this.drawMinus(b,c,d,e);break;case ia.Shape.PLUS:this.drawPlus(b,c,d,e);break;case ia.Shape.X:this.drawX(b,c,d,e);break;case ia.Shape.CIRCLE:this.drawCircle(b,c,d,e);break;case ia.Shape.DIAMOND:this.drawDiamond(b,
c,d,e);break;case ia.Shape.TRIANGLE_UP:this.drawTriangleUp(b,c,d,e);break;case ia.Shape.TRIANGLE_DOWN:this.drawTriangleDown(b,c,d,e);break;case ia.Shape.TRIANGLE_RIGHT:this.drawTriangleRight(b,c,d,e);break;case ia.Shape.TRIANGLE_LEFT:this.drawTriangleLeft(b,c,d,e);break;case ia.Shape.ARROW_UP:this.drawArrowUp(b,c,d,e);break;case ia.Shape.ARROW_DOWN:this.drawArrowDown(b,c,d,e);break;case ia.Shape.ARROW_RIGHT:this.drawArrowRight(b,c,d,e);break;case ia.Shape.ARROW_LEFT:this.drawArrowLeft(b,c,d,e);break;
case ia.Shape.STAR:this.drawStar(b,c,d,e)}};ia.Shape.drawSquare=function(a,b,c,d){var e=d/2;a.rect(b-e,c-e,d,d)};ia.Shape.drawLine=function(a,b,c,d){d/=2;a.moveTo(b-d,c);a.lineTo(b+d,c)};ia.Shape.drawVerticalLine=function(a,b,c,d){var e=d*0.3;a.rect(b-e/2,c-d/2,e,d)};ia.Shape.drawHorizontalLine=function(a,b,c,d){var e=d*0.3;a.rect(b-d/2,c-e/2,d,e)};ia.Shape.drawMinus=function(a,b,c,d){var e=d*0.3;a.rect(b-d/2,c-e/2,d,e)};
ia.Shape.drawPlus=function(a,b,c,d){var e=d/2,d=d*0.3/2;a.moveTo(b-d,c-e);a.lineTo(b+d,c-e);a.lineTo(b+d,c-d);a.lineTo(b+e,c-d);a.lineTo(b+e,c+d);a.lineTo(b+d,c+d);a.lineTo(b+d,c+e);a.lineTo(b-d,c+e);a.lineTo(b-d,c+d);a.lineTo(b-e,c+d);a.lineTo(b-e,c-d);a.lineTo(b-d,c-d);a.lineTo(b-d,c-e)};
ia.Shape.drawX=function(a,b,c,d){var e=d/2,d=d*0.3/2,f=b-d-b,g=c-e-c,h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180),f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.moveTo(h+b,f+c);f=b+d-b;g=c-e-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b+d-b;g=c-d-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b+e-b;g=
c-d-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b+e-b;g=c+d-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b+d-b;g=c+d-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b+d-b;g=c+e-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=
f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b-d-b;g=c+e-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b-d-b;g=c+d-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b-e-b;g=c+d-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+
b,f+c);f=b-e-b;g=c-d-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b-d-b;g=c-d-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c);f=b-d-b;g=c-e-c;h=f*Math.cos(45*Math.PI/180)-g*Math.sin(45*Math.PI/180);f=f*Math.sin(45*Math.PI/180)+g*Math.cos(45*Math.PI/180);a.lineTo(h+b,f+c)};
ia.Shape.drawCircle=function(a,b,c,d){a.arc(b,c,d/2,0,2*Math.PI,!1)};ia.Shape.drawDiamond=function(a,b,c,d){d/=2;a.moveTo(b,c-d);a.lineTo(b+d,c);a.lineTo(b,c+d);a.lineTo(b-d,c);a.lineTo(b,c-d)};ia.Shape.drawTriangleUp=function(a,b,c,d){d/=2;a.moveTo(b,c-d);a.lineTo(b+d,c+d);a.lineTo(b-d,c+d);a.lineTo(b,c-d)};ia.Shape.drawTriangleDown=function(a,b,c,d){d/=2;a.moveTo(b-d,c-d);a.lineTo(b+d,c-d);a.lineTo(b,c+d);a.lineTo(b-d,c-d)};
ia.Shape.drawTriangleRight=function(a,b,c,d){d/=2;a.moveTo(b-d,c-d);a.lineTo(b+d,c);a.lineTo(b-d,c+d);a.lineTo(b-d,c-d)};ia.Shape.drawTriangleLeft=function(a,b,c,d){d/=2;a.moveTo(b+d,c-d);a.lineTo(b+d,c+d);a.lineTo(b-d,c);a.lineTo(b+d,c-d)};ia.Shape.drawArrowUp=function(a,b,c,d){var e=d/2,f=d*0.5,g=d*1;d*=0.5;a.moveTo(b,c-e);a.lineTo(b+g/2,c-e+d);a.lineTo(b+f/2,c-e+d);a.lineTo(b+f/2,c+e);a.lineTo(b-f/2,c+e);a.lineTo(b-f/2,c-e+d);a.lineTo(b-g/2,c-e+d);a.lineTo(b,c-e)};
ia.Shape.drawArrowDown=function(a,b,c,d){var e=d/2,f=d*0.5,g=d*1;d*=0.5;a.moveTo(b,c+e);a.lineTo(b+g/2,c+e-d);a.lineTo(b+f/2,c+e-d);a.lineTo(b+f/2,c-e);a.lineTo(b-f/2,c-e);a.lineTo(b-f/2,c+e-d);a.lineTo(b-g/2,c+e-d);a.lineTo(b,c+e)};ia.Shape.drawArrowRight=function(a,b,c,d){var e=d/2,f=d*0.5,g=d*1;d*=0.5;a.moveTo(b+e,c);a.lineTo(b+e-d,c+g/2);a.lineTo(b+e-d,c+f/2);a.lineTo(b-e,c+f/2);a.lineTo(b-e,c-f/2);a.lineTo(b+e-d,c-f/2);a.lineTo(b+e-d,c-g/2);a.lineTo(b+e,c)};
ia.Shape.drawArrowLeft=function(a,b,c,d){var e=d/2,f=d*0.5,g=d*1;d*=0.5;a.moveTo(b-e,c);a.lineTo(b-e+d,c+g/2);a.lineTo(b-e+d,c+f/2);a.lineTo(b+e,c+f/2);a.lineTo(b+e,c-f/2);a.lineTo(b-e+d,c-f/2);a.lineTo(b-e+d,c-g/2);a.lineTo(b-e,c)};
ia.Shape.drawStar=function(a,b,c,d){var e=0.25*d;d*=0.5;var f,g,h,j,i;f=Math.PI*2/5;g=f/2;h=0.5*Math.PI;a.moveTo(b+Math.cos(h)*d,c-Math.sin(h)*d);for(var m=1;m<=5;m++)j=b+Math.cos(h+f*m-g)*e,i=c-Math.sin(h+f*m-g)*e,a.lineTo(j,i),j=b+Math.cos(h+f*m)*d,i=c-Math.sin(h+f*m)*d,a.lineTo(j,i)};
ia.Shape.drawGradient=function(a,b,c){c==null&&(c="bottomToTop");var d=a.getContext("2d"),e;c=="leftToRight"?e=d.createLinearGradient(0,0,a.width,0):c=="rightToLeft"?e=d.createLinearGradient(a.width,0,0,0):c=="topToBottom"?e=d.createLinearGradient(0,0,0,a.height):c=="bottomToTop"&&(e=d.createLinearGradient(0,a.height,0,0));for(var c=b.length,f=0;f<c;f++)e.addColorStop(f/(c-1),b[f]);d.rect(0,0,a.width,a.height);d.fillStyle=e};
ia.Formatter=function(){this.language="en";this.noDataValue="No Data";this.decimalSeparatorTo=".";this.thousandsSeparatorTo=","};ia.Formatter.prototype.format=function(a,b){b=b==void 0?this.precision:b;return this.language=="none"&&b==void 0?this.formatText(a):ia.isNumber(a)?this.formatNumber(a,b):this.formatText(a)};ia.Formatter.prototype.unformat=function(a){return parseFloat(a.split(this.thousandsSeparatorTo).join("").split(this.decimalSeparatorTo).join("."))};
ia.Formatter.prototype.formatNumber=function(a,b){var c=a<0?"-":"";if(b==void 0){var d=String(a).split("."),e=Math.abs(d[0])+"",f=e.length>3?e.length%3:0;return c+(f?e.substr(0,f)+this.thousandsSeparatorTo:"")+e.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+this.thousandsSeparatorTo)+(d.length==2?this.decimalSeparatorTo+d[1]:"")}else return b==0?(e=Math.abs(parseInt(Math.abs(a||0).toFixed(b),10))+"",f=e.length>3?e.length%3:0,c+(f?e.substr(0,f)+this.thousandsSeparatorTo:"")+e.substr(f).replace(/(\d{3})(?=\d)/g,
"$1"+this.thousandsSeparatorTo)):(e=Math.abs(parseInt(Math.abs(a||0).toFixed(b),10))+"",f=e.length>3?e.length%3:0,c+(f?e.substr(0,f)+this.thousandsSeparatorTo:"")+e.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+this.thousandsSeparatorTo)+(b?this.decimalSeparatorTo+Math.abs(a).toFixed(b).split(".")[1]:""))};ia.Formatter.prototype.formatText=function(a){return a=="null"||a==null||a=="NaN"||a==""||a=="No Data"||a==void 0?this.noDataValue:String(a)};
ia.Locale=function(a){this._propertyHash={};this.formatter=new ia.Formatter;this.setLanguage(a||"en")};ia.Locale.prototype.getLanguage=function(){return this._language};
ia.Locale.prototype.setLanguage=function(a){this._language=a;if(this._language=="be")this._displayLanguage="\u0431\u0435\u043b\u0430\u0440\u0443\u0441\u043a\u0456",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="bg")this._displayLanguage="\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="ca")this._displayLanguage="catal\u00e0",
this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="cs")this._displayLanguage="\u010de\u0161tina",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="da")this._displayLanguage="dansk",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="de")this._displayLanguage="Deutsch",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=
".";else if(this._language=="el")this._displayLanguage="\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="en")this._displayLanguage="English",this.formatter.decimalSeparatorTo=".",this.formatter.thousandsSeparatorTo=",";else if(this._language=="es")this._displayLanguage="espa\u00f1ol",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="et")this._displayLanguage=
"Eesti",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="fi")this._displayLanguage="suomi",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="fr")this._displayLanguage="fran\u00e7ais",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="hr")this._displayLanguage="hrvatski",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=
".";else if(this._language=="hu")this._displayLanguage="magyar",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="is")this._displayLanguage="\u00edslenska",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="it")this._displayLanguage="italiano",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="lt")this._displayLanguage="Lietuvi\u0173",this.formatter.decimalSeparatorTo=
",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="lv")this._displayLanguage="Latvie\u0161u",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="mk")this._displayLanguage="\u043c\u0430\u043a\u0435\u0434\u043e\u043d\u0441\u043a\u0438",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="nl")this._displayLanguage="Nederlands",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=
".";else if(this._language=="no")this._displayLanguage="norsk",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="pl")this._displayLanguage="polski",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="pt")this._displayLanguage="portugu\u00eas",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="ro")this._displayLanguage="rom\u00e2n\u0103",
this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="ru")this._displayLanguage="\u0440\u0443\u0441\u0441\u043a\u0438\u0439",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="sk")this._displayLanguage="Sloven\u010dina",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language=="sl")this._displayLanguage="Sloven\u0161\u010dina",this.formatter.decimalSeparatorTo=
",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="sq")this._displayLanguage="shqipe",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="sr")this._displayLanguage="\u0421\u0440\u043f\u0441\u043a\u0438",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="sv")this._displayLanguage="svenska",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo="\u00a0";else if(this._language==
"tr")this._displayLanguage="T\u00fcrk\u00e7e",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else if(this._language=="uk")this._displayLanguage="\u0443\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430",this.formatter.decimalSeparatorTo=",",this.formatter.thousandsSeparatorTo=".";else{if(this._language.toLowerCase()!="none")this._language="en";this._displayLanguage="English";this.formatter.decimalSeparatorTo=".";this.formatter.thousandsSeparatorTo=","}this.formatter.language=
this._language};ia.Statistics=function(a){a!=void 0&&this.setData(a)};ia.Statistics.prototype.getData=function(){return this._data};ia.Statistics.prototype.setData=function(a){this._data=a;this._invalidateData()};ia.Statistics.prototype.getPercentile=function(a,b){if(a<0||a>1)return NaN;var c=a*(b.length+1),d=Math.floor(c);c-=d;var e=b[d-1],d=b[d];return parseFloat(e)+c*(d-e)};
ia.Statistics.prototype.toString=function(){return"-----Data-----\n Data: "+this.getData()+"\n Sorted data: "+this.sorted+"\n Unique data: "+this.unique+"\n -----Central tendency-----\n Mean: "+this.mean+"\n Median: "+this.median+"\n Mode: "+this.mode+"\n Mode Count: "+this.modeCount+"\n\n -----Variability-----\n Min: "+this.minValue+"\n Max: "+this.maxValue+"\n Range: "+this.range+"\n Lower quartile: "+this.lowerQuartile+"\n Upper quartile: "+this.upperQuartile+"\n Interquartile range: "+this.interquartileRange+
"\n Population Variance: "+this.variance+"\n Population Standard deviation: "+this.standardDeviation};
ia.Statistics.prototype.statsToString=function(){return"-----Central tendency-----\n Mean: "+this.mean+"\n Median: "+this.median+"\n Mode: "+this.mode+"\n Mode Count: "+this.modeCount+"\n\n -----Variability-----\n Min: "+this.minValue+"\n Max: "+this.maxValue+"\n Range: "+this.range+"\n Lower quartile: "+this.lowerQuartile+"\n Upper quartile: "+this.upperQuartile+"\n Interquartile range: "+this.interquartileRange+"\n Population Variance: "+this.variance+"\n Population Standard deviation: "+this.standardDeviation};
ia.Statistics.prototype._invalidateData=function(){this.sorted=this._data.concat();this.sorted.sort(function(a,b){return a-b});this.unique=[];var a,b=this.sum=0,c;this.mode=[];this.modeCount=0;for(var d=1,e=this.sorted.length,f=0;f<e;f++){c=this.sorted[f];if(c!=a){this.unique.push(c);if(d>this.modeCount)this.mode=[];if(d==this.modeCount)this.mode.push(a),this.modeCount=d;d=1}else d++;a=c;this.sum+=parseFloat(c);c*=c;b+=c}this.mean=this.sum/e;this.lowerQuartile=this.getPercentile(0.25,this.sorted);
this.median=this.getPercentile(0.5,this.sorted);this.upperQuartile=this.getPercentile(0.75,this.sorted);this.interquartileRange=this.upperQuartile-this.lowerQuartile;for(f=a=0;f<e;f++)c=this.sorted[f],b=c-this.mean,a+=b*b;this.variance=a/(e-1);this.standardDeviation=Math.sqrt(Math.abs(this.variance));this.minValue=this.sorted[0];this.maxValue=this.sorted[e-1];this.range=this.maxValue-this.minValue};
ia.TextSubstitution=function(){this._TAB=9;this._LINEFEED=10;this._CARRIAGE=13;this._SPACE=32;this._substitutionVariables={}};ia.TextSubstitution.prototype.setVariable=function(a,b){this._substitutionVariables[a]=b};ia.TextSubstitution.prototype.clearVariables=function(){this._substitutionVariables={}};
ia.TextSubstitution.prototype.formatMessage=function(a){for(a+="";a.indexOf("${")>=0;){var b=a.indexOf("${"),c=a.indexOf("}",b),b=a.substring(b,c+1);if((b.indexOf("&&")!=-1||b.indexOf("||")!=-1)&&b.indexOf("==")!=-1){for(var d=b.split("=="),c=this._trim(d[1]),c=c.substring(c.indexOf("(")+1,c.indexOf(")")),d=this._trim(d[0]),e=d.split(/&&|\|\|/),f=0;f<e.length;f++){var g=e[f],h;h=f==0?this._processVariable(this._trim(g)+"}"):this._processVariable("${"+this._trim(g)+"}");d=this._replace(d,g,h)}h=this._processVariable("${andOrTest('"+
d+"',"+c+")}")}else h=this._processVariable(b);a=this._replace(a,b,h)}return a};
ia.TextSubstitution.prototype._processVariable=function(a){var b=a.substring(a.indexOf("{")+1,a.indexOf("("));if(b.indexOf("themeName")!=-1){var b=this._substitutionVariables[b],c="";if(b!=void 0)if(b.length==1)c=b[0];else for(var a=a.substring(a.indexOf("'")+1,a.lastIndexOf("'")),d=0,e=0;e<b.length;e++){var f=b[e],c=d==0?f:c+a+f;d++}return c}if(b=="${")return this._formatValue(a.substring(2,a.length-1));a=this._trim(a.substring(a.indexOf("(")+1,a.lastIndexOf(")}")));c=a.split(",");b=b.toLowerCase();
if(b=="andortest"){a=this._formatValue(c[0]);d=this._formatValue(c[1]);e=this._formatValue(c[2]);try{if(b=eval(a),b==!0)return d;else if(b==!1)return e}catch(g){}}else if(b=="empty")if(a=this._formatValue(c[0]),d=this._formatValue(c[1]),e=this._formatValue(c[2]),c.length<2&&(d=!0,e=!1),a==void 0||a.toString()=="")return d;else{if(e!=void 0)return e}else if(b=="notempty")if(a=this._formatValue(c[0]),d=this._formatValue(c[1]),e=this._formatValue(c[2]),c.length<2&&(d=!0,e=!1),a!=void 0&&a.toString()!=
"")return d;else{if(e!=void 0)return e}else if(b=="equals")if(a=this._formatValue(c[0]),b=this._formatValue(c[1]),d=this._formatValue(c[2]),e=this._formatValue(c[3]),c.length<3&&(d=!0,e=!1),a==b)return d;else{if(e!=void 0)return e}else if(b=="notequals")if(a=this._formatValue(c[0]),b=this._formatValue(c[1]),d=this._formatValue(c[2]),e=this._formatValue(c[3]),c.length<3&&(d=!0,e=!1),a!=b)return d;else{if(e!=void 0)return e}else if(b=="greaterthan")if(a=this._formatValue(c[0]),b=this._formatValue(c[1]),
d=this._formatValue(c[2]),e=this._formatValue(c[3]),c.length<3&&(d=!0,e=!1),a>b)return d;else{if(e!=void 0)return e}else if(b=="greaterthanorequalto")if(a=this._formatValue(c[0]),b=this._formatValue(c[1]),d=this._formatValue(c[2]),e=this._formatValue(c[3]),c.length<3&&(d=!0,e=!1),a>=b)return d;else{if(e!=void 0)return e}else if(b=="lessthan")if(a=this._formatValue(c[0]),b=this._formatValue(c[1]),d=this._formatValue(c[2]),e=this._formatValue(c[3]),c.length<3&&(d=!0,e=!1),a<b)return d;else{if(e!=void 0)return e}else if(b==
"lessthanorequalto")if(a=this._formatValue(c[0]),b=this._formatValue(c[1]),d=this._formatValue(c[2]),e=this._formatValue(c[3]),c.length<3&&(d=!0,e=!1),a<=b)return d;else{if(e!=void 0)return e}else if(b=="even")return a=this._formatValue(c[0]),d=this._formatValue(c[1]),e=this._formatValue(c[2]),c.length<2&&(d=!0,e=!1),a%2==0?d:e;else if(b=="odd")return a=this._formatValue(c[0]),d=this._formatValue(c[1]),e=this._formatValue(c[2]),c.length<2&&(d=!0,e=!1),a%2==0?e:d;else if(b=="multiply")return a=this._formatValue(c[0]),
b=this._formatValue(c[1]),a*b;else if(b=="divide")return a=this._formatValue(c[0]),b=this._formatValue(c[1]),a/b;else if(b=="add")return a=this._formatValue(c[0]),b=this._formatValue(c[1]),a+b;else if(b=="subtract")return a=this._formatValue(c[0]),b=this._formatValue(c[1]),a-b;else if(b=="min")return a=this._formatValue(c[0]),b=this._formatValue(c[1]),Math.min(a,b);else if(b=="max")return a=this._formatValue(c[0]),b=this._formatValue(c[1]),Math.max(a,b);else if(b=="pow")return a=this._formatValue(c[0]),
b=this._formatValue(c[1]),Math.pow(a,b);else if(b=="sqrt")return a=this._formatValue(c[0]),Math.sqrt(a);else if(b=="exp")return a=this._formatValue(c[0]),Math.exp(a);else if(b=="log")return a=this._formatValue(c[0]),Math.log(a);else if(b=="abs")return a=this._formatValue(c[0]),Math.abs(a);return""};
ia.TextSubstitution.prototype._formatValue=function(a){if(a!=void 0){var b=this._trim(a),a="";if(b.indexOf("[")!=-1&&b.indexOf("]")!=-1){var c=b.substring(0,b.indexOf("[")),b=b.substring(b.indexOf("[")+1,b.indexOf("]")),c=this._substitutionVariables[c];c.indexOf(";")!=-1?a=c.split(";")[b]:c.indexOf(",")!=-1&&(a=c.split(",")[b])}else a=ia.isNumber(b)?parseFloat(b):b.charAt(0)=='"'||b.charAt(0)=="'"?b.substring(1,b.length-1):this._substitutionVariables[b];if(a!=void 0)return a}return""};
ia.TextSubstitution.prototype._trim=function(a){return this._leftTrim(this._rightTrim(a))};ia.TextSubstitution.prototype._rightTrim=function(a){for(var b=a.length-1;a.charCodeAt(b)==this._SPACE||a.charCodeAt(b)==this._CARRIAGE||a.charCodeAt(b)==this._LINEFEED||a.charCodeAt(b)==this._TAB;)b--;return a.substring(0,b+1)};
ia.TextSubstitution.prototype._leftTrim=function(a){for(var b=0;a.charCodeAt(b)==this._SPACE||a.charCodeAt(b)==this._CARRIAGE||a.charCodeAt(b)==this._LINEFEED||a.charCodeAt(b)==this._TAB;)b++;return a.substring(b,a.length)};ia.TextSubstitution.prototype._replace=function(a,b,c){return a.split(b).join(c)};
ia.UrlParams=function(a){this.href=decodeURIComponent(a);a=decodeURIComponent(a);this.path=ia.File.getFileDirectory(a);if(location.href.indexOf("#")!=-1)this.href=this.href.split("#")[0],a=a.split("#")[0];this.params={};for(var a=a.slice(a.indexOf("?")+1).split("&"),b=0;b<a.length;b++){var c=a[b].split("="),d=c[1];d=="false"&&(d=!1);d=="true"&&(d=!0);ia.isNumber(d)&&(d=parseFloat(d));this.params[c[0]]=d}};
var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].substring)!=-1)return a[b].identity}else if(d)return a[b].identity}},
searchVersion:function(a){var b=a.indexOf(this.versionSearchString);return b==-1?void 0:parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,substring:"Chrome",identity:"Chrome"},{string:navigator.userAgent,substring:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,substring:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,substring:"iCab",
identity:"iCab"},{string:navigator.vendor,substring:"KDE",identity:"Konqueror"},{string:navigator.userAgent,substring:"Firefox",identity:"Firefox"},{string:navigator.vendor,substring:"Camino",identity:"Camino"},{string:navigator.userAgent,substring:"Netscape",identity:"Netscape"},{string:navigator.userAgent,substring:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,substring:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,substring:"Mozilla",
identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,substring:"Win",identity:"Windows"},{string:navigator.platform,substring:"Mac",identity:"Mac"},{string:navigator.userAgent,substring:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,substring:"Linux",identity:"Linux"}]};BrowserDetect.init();ia.File=function(){};
ia.File.postJSON=function(a,b,c,d){a=ia.getDomainSafeUrl(a);d==void 0&&(d=!0);ia.accessToken!=""&&d&&(b+="&token="+ia.accessToken);$j.ajax({type:"POST",url:a,data:b,dataType:"json",success:c,error:function(b,c,d){ia.log(a);ia.log(b.status);ia.log(c);ia.log(d);ia.File.errorHandler!=void 0?ia.File.errorHandler(a,b,c,d):b.status=="404"&&(d=="Not Found"?alert("File not found: '"+a+"'"):alert(BrowserDetect.browser+" does not currently display InstantAtlas HTML5 reports from local or networked drives."))}})};
ia.File.load=function(a,b,c,d){a=ia.getDomainSafeUrl(a);d==void 0&&(d=!0);ia.accessToken!=""&&d&&(a+=a.indexOf("?")==-1?"?":"&",a+="token="+ia.accessToken);$j.ajax({type:"GET",url:a,dataType:b,success:c,error:function(b,c,d){ia.log(a);ia.log(b.status);ia.log(c);ia.log(d);if(ia.File.errorHandler!=void 0)ia.File.errorHandler(a,b,c,d);else if(b.status=="404")d=="Not Found"?alert("File not found: '"+a+"'"):alert(BrowserDetect.browser+" does not currently display InstantAtlas HTML5 reports from local or networked drives.");
else if(b.status=="403")b="https://www.arcgis.com/sharing/oauth2/authorize?client_id=83wV2txRMBrDpKjq&response_type=token&redirect_uri="+encodeURI(window.location.href),window.location.href=b}})};
ia.File.loadCSV=function(a,b,c){a=ia.getDomainSafeUrl(a);ia.accessToken!=""&&(a+=a.indexOf("?")==-1?"?":"&",a+="token="+ia.accessToken);$j.ajax({type:"GET",url:a,dataType:b,contentType:"text/csv; charset=utf-8",success:c,error:function(b,c,f){ia.log(a);ia.log(b.status);ia.log(c);ia.log(f);if(ia.File.errorHandler!=void 0)ia.File.errorHandler(a,b,c,f);else if(b.status=="404")f=="Not Found"?alert("File not found: '"+a+"'"):alert(BrowserDetect.browser+" does not currently display InstantAtlas HTML5 reports from local or networked drives.");
else if(b.status=="403")b="https://www.arcgis.com/sharing/oauth2/authorize?client_id=83wV2txRMBrDpKjq&response_type=token&redirect_uri="+encodeURI(window.location.href),window.location.href=b}})};ia.File.getFileDirectory=function(a){var b=a;a.indexOf("?")>0&&(b=a.substring(0,a.lastIndexOf("?")));return b.indexOf("/")<0?b.substring(0,b.lastIndexOf("\\")+1):b.substring(0,b.lastIndexOf("/")+1)};
ia.File.getFileName=function(a){var b=a;a.indexOf("?")>0&&(b=a.substring(0,a.lastIndexOf("?")));return a.indexOf("/")<0?b.substring(a.lastIndexOf("\\")+1):b.substring(a.lastIndexOf("/")+1)};ia.ReportConfig=function(){};ia.ReportConfig.prototype.getWidgets=function(){return this._componentArray.concat(this._tableArray).concat(this._buttonArray).concat(this._textArray).concat(this._imageArray)};ia.ReportConfig.prototype.getComponents=function(){return this._componentArray};
ia.ReportConfig.prototype.getComponent=function(a){return this._componentHash[a]};ia.ReportConfig.prototype.getTables=function(){return this._tableArray};ia.ReportConfig.prototype.getTable=function(a){return this._tableHash[a]};ia.ReportConfig.prototype.getButtons=function(){return this._buttonArray};ia.ReportConfig.prototype.getButton=function(a){return this._buttonHash[a]};ia.ReportConfig.prototype.getTexts=function(){return this._textArray};ia.ReportConfig.prototype.getText=function(a){return this._textHash[a]};
ia.ReportConfig.prototype.getImages=function(){return this._imageArray};ia.ReportConfig.prototype.getImage=function(a){return this._imageHash[a]};ia.ReportConfig.prototype.getProperty=function(a){if(a=this._propertyHash[a])return a.value};ia.ReportConfig.prototype.setProperty=function(a,b){var c=this._propertyHash[a];if(c)c.value=c.formatValue(b)};ia.ReportConfig.prototype.getProperties=function(){return this._propertyHash};ia.ReportConfig.prototype.getMapPalette=function(){return this._palette};
ia.ReportConfig.prototype.loadSource=function(a,b){var c=this;ia.File.load(a,"xml",function(a){a=$j(a);c.template=$j(a.find("AtlasInterface")).attr("template");c.name=$j(a.find("AtlasInterface")).attr("name");c.version=$j(a.find("AtlasInterface")).attr("template-version");var e=c.template.indexOf("::arcgisonline");if(e!=-1)c.template=c.template.substring(0,e);c._componentArray=[];c._componentHash={};e=a.find("Component");$j.each(e,function(a,b){if($j(b).attr("visible")=="true"){var d=new ia.ComponentConfig(b);
c._componentArray[c._componentArray.length]=d;c._componentHash[d.id]=d}});c._propertyHash={};e=a.find("PropertyGroup");$j.each(e,function(a,b){var d=$j(b).find("Property");$j.each(d,function(a,b){var d=new ia.PropertyConfig(b);c._propertyHash[d.id]=d})});c._tableArray=[];c._tableHash={};e=a.find("Table");$j.each(e,function(a,b){if($j(b).attr("visible")=="true"){var d=new ia.TableConfig(b);c._tableArray[c._tableArray.length]=d;c._tableHash[d.id]=d}});c._buttonArray=[];c._buttonHash={};e=a.find("Button");
$j.each(e,function(a,b){var d=new ia.ButtonConfig(b);c._buttonArray[a]=d;c._buttonHash[d.id]=d});c._textArray=[];c._textHash={};e=a.find("Text");$j.each(e,function(a,b){var d=new ia.TextConfig(b);c._textArray[a]=d;c._textHash[d.id]=d});c._imageArray=[];c._imageHash={};e=a.find("Image");$j.each(e,function(a,b){var d=new ia.ImageConfig(b);c._imageArray[a]=d;c._imageHash[d.id]=d});c._palette=new ia.PaletteConfig(a.find("MapPalettes"),c.getProperty("noDataColor"));b.call(null,c)})};
ia.WidgetConfig=function(a){a=$j(a);this.xAnchor="left";this.yAnchor="top";this.visible=!0;this.type=this.cssClass="";if(a.attr("id")!=void 0)this.id=a.attr("id");if(a.attr("name")!=void 0)this.name=a.attr("name");if(a.attr("x")!=void 0)this.x=parseFloat(a.attr("x"))/800*100,this.x=Math.round(this.x*10)/10;if(a.attr("y")!=void 0)this.y=parseFloat(a.attr("y"))/600*100,this.y=Math.round(this.y*10)/10;if(a.attr("width")!=void 0)this.width=parseFloat(a.attr("width"))/800*100,this.width=Math.round(this.width*
10)/10;if(a.attr("height")!=void 0)this.height=parseFloat(a.attr("height"))/600*100,this.height=Math.round(this.height*10)/10;if(a.attr("zIndex")!=void 0)this.zIndex=ia.parseInt(a.attr("zIndex"));if(a.attr("css-class")!=void 0)this.cssClass=a.attr("css-class");if(a.attr("anchor")!=void 0)if(this.xAnchor=a.attr("anchor"),this.xAnchor=="end"||this.xAnchor=="right")this.x-=this.width;else if(this.xAnchor=="middle"||this.xAnchor=="center")this.x-=this.width/2;this.type=a.get(0).nodeName.toLowerCase()};
ia.ComponentConfig=function(a){ia.ComponentConfig.baseConstructor.call(this,a);var b=this;b._propertyHash={};a=$j(a).find("Property");$j.each(a,function(a,d){var e=new ia.PropertyConfig(d);b._propertyHash[e.id]=e;if(e.id=="title")b.title=e.value;if(e.id=="visible")b.visible=e.value;if(e.id=="zIndex")b.zIndex=e.value})};ia.extend(ia.WidgetConfig,ia.ComponentConfig);ia.ComponentConfig.prototype.getProperties=function(){return this._propertyHash};
ia.ComponentConfig.prototype.getProperty=function(a){if(a=this._propertyHash[a])return a.value};ia.ComponentConfig.prototype.setProperty=function(a,b){var c=this._propertyHash[a];if(c)c.value=c.formatValue(b)};ia.PropertyConfig=function(a){a=$j(a);this.id=a.attr("id");this.type=a.attr("type");this.value=this.formatValue(a.attr("value"))};
ia.PropertyConfig.prototype.formatValue=function(a){if(this.type=="float"){if(a!="")return parseFloat(a)}else if(this.type=="integer"){if(a!="")return ia.parseInt(a)}else if(this.type=="boolean")return a==!0||a==!1?a:a=="true";else if(this.type=="string-array"||this.type=="colour-array"){if(a!=""){for(var b=a.split(","),a=0;a<b.length;a++)b[a].substring(0,1)=="'"&&(b[a]=b[a].substring(1)),b[a].substring(b[a].length-1)=="'"&&(b[a]=b[a].substring(0,b[a].length-1));return b}}else if(this.type=="float-array"){if(a!=
""){for(var b=a.split(","),c=Array(b.length),a=0;a<b.length;a++)c[a]=parseFloat(b[a]);return c}}else if(this.type=="integer-array"){if(a!=""){b=a.split(",");c=Array(b.length);for(a=0;a<b.length;a++)c[a]=ia.parseInt(b[a]);return c}}else if(this.type=="boolean-array"){b=a.split(",");c=Array(b.length);for(a=0;a<b.length;a++)c[a]=b[a]=="true";return c}else if(a!="")return a};
ia.TableConfig=function(a){ia.TableConfig.baseConstructor.call(this,a);var b=this,a=$j(a);this.customColumns=[];b._columnArray=[];b._columnHash={};var a=a.find("Column"),c=0;$j.each(a,function(a,d){var g={},h=$j(d).attr("name");h!="name"&&(h+="_formatted");g.id=$j(d).attr("name");g.formattedId=h;g.label=$j(d).attr("alias");g.width=parseFloat($j(d).attr("width"));b._columnArray[a]=g;b._columnHash[g.id]=g;c+=g.width});a=1-c;if(a!=0){a/=b._columnArray.length;for(var d=0;d<b._columnArray.length;d++)b._columnArray[d].width+=
a}};ia.extend(ia.ComponentConfig,ia.TableConfig);ia.TableConfig.prototype.getColumn=function(){return this._columnHash[id]};ia.TableConfig.prototype.getColumns=function(){return this._columnArray};
ia.TableConfig.prototype.getColumnsForIndicator=function(a,b,c){for(var d=[],d=this.customColumns.length>0?this.customColumns.concat():this._columnArray.concat(),e=[],f=0;f<d.length;f++){var g=d[f],h={};h.id=g.id;h.formattedId=g.formattedId;h.label=b.formatMessage(g.label);h.width=g.width;h.type="categoric";if(h.id=="name")h.type="categoric";else if(h.id=="value")h.type=a.type;else if(h.id.indexOf("~")!=-1){var g=h.id.split("~")[0],j=h.id.split("~")[1],j=c[j-2];if(j!=void 0)if(g=="value")h.type=j.type;
else if(g=j.getAssociate(g),g!=null)h.type=g.type}else if(g=a.getAssociate(h.id),g!=null)h.type=g.type;e.push(h)}return e};ia.ButtonConfig=function(a){ia.ButtonConfig.baseConstructor.call(this,a);a=$j(a);this.text=a.attr("text")||"";this.target=a.attr("target")||"_blank";this.tooltip=a.attr("tooltip")||"";this.href=a.attr("href")||"";if(this.href.indexOf("http")==-1&&this.href.indexOf("javascript")==-1)this.href=ia.IAS_PATH+this.href};ia.extend(ia.WidgetConfig,ia.ButtonConfig);
ia.TextConfig=function(a){ia.TextConfig.baseConstructor.call(this,a);a=$j(a);this.cssProps={};if(a.attr("wrap-width")!=void 0)this.width=parseFloat(a.attr("wrap-width"))/800*100,this.width=Math.round(this.width*10)/10;a.attr("fill")!=void 0&&(this.cssProps.color=a.attr("fill"));a.attr("font-family")!=void 0&&(this.cssProps["font-family"]=a.attr("font-family"));a.attr("font-size")!=void 0&&(this.cssProps["font-size"]=a.attr("font-size")+"px");a.attr("font-style")!=void 0&&(this.cssProps["font-style"]=
a.attr("font-style"));a.attr("font-weight")!=void 0&&(this.cssProps["font-weight"]=a.attr("font-weight"));this.text=a.text()};ia.extend(ia.ButtonConfig,ia.TextConfig);
ia.ImageConfig=function(a){ia.ImageConfig.baseConstructor.call(this,a);a=$j(a);this.src=a.attr("src")||"";if(this.src.indexOf("http")==-1&&this.src.indexOf("javascript")==-1)this.src=ia.IAS_PATH+this.src;if(a.attr("rescale")!=void 0&&(this.rescale=a.attr("rescale")=="true",this.rescale==!1))this.width=parseFloat(a.attr("width")),this.height=parseFloat(a.attr("height"))};ia.extend(ia.ButtonConfig,ia.ImageConfig);
ia.PaletteConfig=function(a,b){var c=this,d=$j(a);this.defaultSchemeId=this.defaultPaletteId="";this.noClasses=5;this.minNoClasses=2;this.maxNoClasses=10;this.noDataValue="";if(d.attr("default")!=void 0)this.defaultPaletteId=d.attr("default");if(d.attr("classes")!=void 0)this.noClasses=ia.parseInt(d.attr("classes"));if(d.attr("maxclasses")!=void 0)this.maxNoClasses=ia.parseInt(d.attr("maxclasses"));c._paletteArray=[];c._paletteHash={};var e=d.find("ColourRange");$j.each(e,function(a,b){var d=$j(b).find("Colour"),
e=[];$j.each(d,function(a,b){e.push($j(b).text())});d=new ia.ColorPalette(e);d.id=$j(b).attr("id");c._paletteHash[d.id]=d;c._paletteArray.push(d)});var f=b==void 0?"#f9f9f9":b,g=["null",null,"NaN","","No Data",void 0];c._schemeArray=[];c._schemeHash={};e=d.find("ColourScheme");$j.each(e,function(a,b){var d=[],e=new ia.ColorPalette,k=$j(b).find("ColourMatch");$j.each(k,function(a,b){var c=$j(b).attr("for"),f=$j(b).text();d.push(f);e.matchColorsToValues[c]=f});for(a=0;a<g.length;a++)e.matchColorsToValues[g[a]]=
f;e.setColorList(d);e.id=$j(b).attr("id");c._schemeHash[e.id]=e;c._schemeArray.push(e)});this.defaultSchemeId=c._schemeArray[0].id};ia.PaletteConfig.prototype.noDataValue="";ia.PaletteConfig.prototype.getColorPalettes=function(){return this._paletteArray};ia.PaletteConfig.prototype.getColorPalette=function(a){return this._paletteHash[a]};ia.PaletteConfig.prototype.getColorSchemes=function(){return this._schemeArray};ia.PaletteConfig.prototype.getColorScheme=function(a){return this._schemeHash[a]};
ia.BaseData=function(a,b){this.data=a;this.parent=b;this._properties={};this.hasData=!0;this.type="categoric";if(this.parent!=void 0){this.type=this.parent.type;this.precision=this.parent.precision;var c=this.parent.getProperties();if(c!=void 0){var d=c.length,e;for(e in c)this._properties[e]=c[e]}}this.id=this.data.themeId||this.data.id;this.name=this.data.themeName||this.data.name;this.href=this.data.href;this.fileName=this.data.fileName;if(this.data.fileName!=void 0)this.hasData=!1;if(this.data.type!=
void 0)this.type=this.data.type;if(this.data.precision!=void 0)this.precision=this.data.precision;c=this.data.properties;if(c!=void 0){d=c.length;for(e=0;e<d;e++){var f=c[e];this._properties[f.name]=f.value}}this.customColumns=[];for(var g in this._properties)if(g.indexOf("column_")!=-1){c={};c.id=g.substring(g.indexOf("_")+1,g.length);if(c.id=="indicator")c.id="value";c.formattedId=c.id!="name"?c.id+"_formatted":c.id;c.label=this._properties[g];this.customColumns.push(c)}};
ia.BaseData.prototype.getProperty=function(a){return this._properties[a]};ia.BaseData.prototype.getProperties=function(){return this._properties};ia.BaseData.prototype.getChildren=function(){};
ia.BaseData.prototype.getDataTree=function(a,b,c,d){var c=c==void 0?{}:c,e={};e.id=this.geography?this.geography.id+"~"+this.id:this.id;e.label=this.name;if(this.href!=void 0)e.href=this.href;if(d!=void 0)e.parent=d;var f=this.getChildren(),d=[];if(f!=null){e.type="branch";for(var g=f.length,h,j=0;j<g;j++){var i=f[j];i.id!=h&&(this.geography?d.push(this.geography.id+"~"+i.id):d.push(this.id+"~"+i.id),i.getDataTree(a,b,c,e.id));h=i.id}if(d.length>0)e.children=d}else if(a!=!1&&this.date!=void 0){e.type=
"branch";a=this.theme.getIndicators(this.id);g=a.length;if(b)for(j=g-1;j>=0;j--){b=a[j];h={};h.id=this.geography.id+"~"+b.id+"~"+b.date;h.label=b.date;h.type="leaf";h.parent=e.id;if(b.href!=void 0)h.href=b.href;d.push(h.id);c[h.id]=h}else for(j=0;j<g;j++){b=a[j];h={};h.id=this.geography.id+"~"+b.id+"~"+b.date;h.label=b.date;h.type="leaf";h.parent=e.id;if(b.href!=void 0)h.href=b.href;d.push(h.id);c[h.id]=h}if(d.length>0)e.children=d}else e.type="leaf";c[e.id]=e;return c};
ia.ReportData=function(){ia.ReportData.baseConstructor.call(this);this._propertyHash={};this.path=this.url="";this.formatter=new ia.Formatter};ia.extend(ia.EventDispatcher,ia.ReportData);ia.ReportData.prototype.getGeographies=function(){return this._geogArray};ia.ReportData.prototype.getProperty=function(a){return this._propertyHash[a]};ia.ReportData.prototype.setProperty=function(a,b){this._propertyHash[a]=b};ia.ReportData.prototype.getProperties=function(){return this._propertyHash};
ia.ReportData.prototype.getGeography=function(a){return this._geogHash[a]};ia.ReportData.prototype.loadSource=function(a,b){var c=this;this.url=a;this.path=ia.File.getFileDirectory(a);ia.File.load(a,"json",function(a){c.parseData(a,b)})};ia.ReportData.prototype.parseData=function(a,b){this.data=a;this._geogArray=[];this._geogHash={};var c=a.geographies;if(c!=void 0)for(var d=c.length,e=0;e<d;e++){var f=new ia.Geography(this,c[e]);f.index=e;this._geogArray[e]=f;this._geogHash[f.id]=f}b.call(null,this)};
ia.ReportData.prototype.getDataTree=function(a,b){var c={},d={id:"topLevel",label:"topLevel",type:"branch"};c[d.id]=d;ia.log(b);var e=[],f;for(f in this._geogHash)e.push(f),this._geogHash[f].getDataTree(a,b,c,d.id);d.children=e;return c};
ia.ReportData.prototype.getGeographyTree=function(){var a={},b={id:"topLevel",label:"topLevel",type:"branch"};a[b.id]=b;for(var c=[],d=0;d<this._geogArray.length;d++){var e=this._geogArray[d],f={};f.id=e.id;f.label=e.name;f.type="leaf";a[f.id]=f;c.push(e.id)}b.children=c;return a};ia.Geography=function(a,b){ia.Geography.baseConstructor.call(this,b,a);this.reportData=a;this.parseData(b)};ia.extend(ia.BaseData,ia.Geography);
ia.Geography.prototype.parseData=function(){this._featureArray=[];this._featureHash={};var a=this.data.features;if(a!=void 0)for(var b=a.length,c=0;c<b;c++){var d=new ia.Feature(a[c]);this._featureArray[c]=d;this._featureHash[d.id]=d}this._comparisonArray=[];this._comparisonHash={};a=this.data.comparisonFeatures;if(a!=void 0){b=a.length;for(c=0;c<b;c++)d=new ia.Feature(a[c]),this._comparisonArray[c]=d,this._comparisonHash[d.id]=d}this._filterArray=[];this._filterHash={};a=this.data.filters;if(a!=
void 0){b=a.length;for(c=0;c<b;c++)d=new ia.Filter(a[c]),this._filterArray[c]=d,this._filterHash[d.id]=d}this._themeArray=[];this._themeHash={};d=this.data.themes;if(d!=void 0){b=d.length;for(c=0;c<b;c++)a=new ia.Theme(this,void 0,d[c]),this._themeArray[c]=a,this._themeHash[a.id]=a}};ia.Geography.prototype.getThemes=function(){return this._themeArray};ia.Geography.prototype.getTheme=function(a){return this._themeHash[a]};ia.Geography.prototype.getFeatures=function(){return this._featureArray};
ia.Geography.prototype.getFeature=function(a){return this._featureHash[a]!=void 0?this._featureHash[a]:this.getComparisonFeature(a)};ia.Geography.prototype.getComparisonFeatures=function(){return this._comparisonArray};ia.Geography.prototype.getComparisonFeature=function(a){return this._comparisonHash[a]};ia.Geography.prototype.getFilters=function(){return this._filterArray};ia.Geography.prototype.getFilter=function(a){return this._filterHash[a]};ia.Geography.prototype.getChildren=function(){return this._themeArray};
ia.Geography.prototype.getFirstIndicator=function(a){return this._themeArray[0].getFirstIndicator(a)};ia.Geography.prototype.getIndicator=function(a,b,c){for(var d=this._themeArray.length,e=0;e<d;e++){var f=this._themeArray[e].getNestedIndicator(a,b,c);if(f!=void 0)return f}};ia.Geography.prototype.loadIndicator=function(a,b,c){for(var d=this._themeArray.length,e=0;e<d;e++)this._themeArray[e].loadIndicator(a,b,c)};
ia.Geography.prototype.getFilteredFeatures=function(a,b){for(var c=this._featureArray.length,d=[],e=0;e<c;e++){var f=this._featureArray[e];f.getFilterValue(a)==b&&d.push(f.id)}return d};
ia.Geography.prototype.getFilterTree=function(){var a={},b={id:"topLevel",label:"topLevel",type:"branch"};a[b.id]=b;for(var c=[],d=this._filterArray.length,e=this._featureArray.length,f=0;f<d;f++){var g=this._filterArray[f],h={};h.id=g.id;h.label=g.name;h.type="branch";h.parent=b.id;a[h.id]=h;c.push(h.id);for(var j=[],i=0;i<e;i++){var m=this._featureArray[i].getFilterValue(g.id);if(m!=void 0&&j.indexOf(g.id+"~"+m)==-1){var k={};k.id=g.id+"~"+m;k.label=m;k.type="leaf";k.parent=g.id;a[k.id]=k;j.push(k.id)}}j.sort();
h.children=j}b.children=c;return a};ia.Geography.prototype.loadData=function(a){function b(){d++;d==c._themeArray.length&&a.call(null,this)}for(var c=this,d=0,e=this._themeArray.length,f=0;f<e;f++)this._themeArray[f].loadData(b)};
ia.Geography.prototype.getFeatureData=function(a,b){var c={};c.id=this.id;c.name=this.name;c.features=[];for(var d=this.getThemes(),e=d.length,f=a.length,g=0;g<f;g++){var h=this.getFeature(a[g]),j={};j.id=h.id;j.name=h.name;j.href=h.href;j.properties=[];var i=h.getProperties(),m;for(m in i){var k={};k.name=m;k.value=i[m];j.properties[j.properties.length]=k}j.themes=[];c.features[c.features.length]=j;for(i=0;i<e;i++)k=d[i],k.hasData&&(k=k.getFeatureData(h,b),j.themes[j.themes.length]=k)}return c};
ia.Geography.prototype.getIndicatorData=function(a,b){var c={};c.id=this.id;c.name=this.name;c.themes=[];for(var d=this.getThemes(),e=d.length,f=0;f<e;f++){var g=d[f];g.hasData&&(g=g.getIndicatorData(a,b),c.themes[c.themes.length]=g)}return c};ia.Geography.prototype.getProfileData=function(a,b,c){var d={};d.id=this.id;d.name=this.name;d.themes=[];for(var e=this.getThemes(),f=e.length,g=0;g<f;g++)e[g].getProfileData(a,d.themes,b,c);return d};
ia.Theme=function(a,b,c){ia.Theme.baseConstructor.call(this,c,b||a);this.hasThemes=!1;this.geography=a;this.parseData(c)};ia.extend(ia.BaseData,ia.Theme);
ia.Theme.prototype.parseData=function(){if(this.data.fileName!=void 0)this.fileName=this.geography.reportData.path+this.data.fileName;this._themeArray=[];var a=this.data.themes;if(a!=void 0)for(var b=a.length,c=0;c<b;c++)this.hasThemes=!0,this._themeArray[c]=new ia.Theme(this.geography,this,a[c]);this._indicatorArray=[];this._indicatorHash={};this._indicatorDateHash={};a=this.data.indicators;if(a!=void 0)for(var d=[],e,b=a.length,c=0;c<b;c++){var f=new ia.Indicator(this.geography,this,a[c]);this._indicatorArray[c]=
f;f.date?(this._indicatorHash[f.id+"_"+f.date]=f,f.id!=e&&(d=[]),d.push(f.date),e=f.id,this._indicatorDateHash[f.id]=d):this._indicatorHash[f.id]=f}};ia.Theme.prototype.getThemes=function(){return this._themeArray};ia.Theme.prototype.getParentThemes=function(){for(var a=[this.name],b=this.parent;b.hasThemes==!0;)a.push(b.name),b=b.parent;return a.reverse()};ia.Theme.prototype.getChildren=function(){return this.hasThemes?this._indicatorArray.concat(this._themeArray):this._indicatorArray};
ia.Theme.prototype.getData=function(a,b){var c={dates:[]},d;d=a?this.getIndicators(a):this.getIndicators();for(var e=d.length,f=0;f<e;f++){var g=d[f];g.date!=void 0?(c.dates[c.dates.length]=g.date,c[g.date]=g.getData(b)):(c.dates[c.dates.length]=g.name,c[g.name]=g.getData(b))}return c};ia.Theme.prototype.getDataForDate=function(a,b){for(var c={dates:[]},d=this.getIndicators(),e=d.length,f=0;f<e;f++){var g=d[f];if(g.date==a)c.dates[c.dates.length]=g.name,c[g.name]=g.getData(b)}return c};
ia.Theme.prototype.getComparisonData=function(a){for(var b={dates:[]},a=this.getIndicators(a),c=a.length,d=0;d<c;d++){var e=a[d];if(e.date!=void 0)b.dates[d]=e.date,b[e.date]=e.getComparisonData()}return b};ia.Theme.prototype.getComparisonDataForDate=function(a){for(var b={dates:[]},c=this.getIndicators(),d=c.length,e=0;e<d;e++){var f=c[e];if(f.date==a)b.dates[b.dates.length]=f.name,b[f.name]=f.getComparisonData()}return b};
ia.Theme.prototype.loadIndicator=function(a,b,c){function d(){var d=e.getIndicator(a,b);c.call(null,d)}var e=this,f=e.getIndicator(a,b);if(f!=void 0)e.hasData==!1?ia.File.load(e.fileName,"json",function(a){e.data=a;e.hasData=!0;e.parseData();d()}):d();else if(e.hasThemes)for(var g=this._themeArray.length,h=0;h<g;h++){var j=this._themeArray[h],f=j.getIndicator(a,b);j.loadIndicator(a,b,c);if(f!=void 0)break}};
ia.Theme.prototype.getIndicators=function(a){if(a==null)return this._indicatorArray;else{var b=this.getIndicatorDates(a),c=[];if(b!=void 0)for(var d=b.length,e=0;e<d;e++)c.push(this.getIndicator(a,b[e]));else c.push(this.getIndicator(a));return c}};ia.Theme.prototype.getIndicatorsWithDate=function(a){for(var b=this.getIndicatorIds(),c=[],d=0;d<b.length;d++)c[c.length]=this.getIndicator(b[d],a);return c};
ia.Theme.prototype.getFirstIndicator=function(a){a==void 0&&(a=!0);if(this._indicatorArray.length>0){var b=this.getIndicators(this._indicatorArray[0].id);return a?b[b.length-1]:b[0]}else if(this.hasThemes)for(b=this._themeArray.length;0<b;)return this._themeArray[0].getFirstIndicator(a)};
ia.Theme.prototype.getIndicator=function(a,b,c){c==void 0&&(c=!0);if(b!=void 0&&b!=""&&this._indicatorHash[a+"_"+b]!=void 0)return this._indicatorHash[a+"_"+b];else if(this._indicatorHash[a]!=void 0)return this._indicatorHash[a];else if(b=this.getIndicatorDates(a))return c?this._indicatorHash[a+"_"+b[b.length-1]]:this._indicatorHash[a+"_"+b[0]]};
ia.Theme.prototype.getNestedIndicator=function(a,b,c){var d=this.getIndicator(a,b,c);if(d!=void 0)return d;if(this.hasThemes)for(var e=this._themeArray.length,f=0;f<e;f++)if(d=this._themeArray[f].getNestedIndicator(a,b,c),d!=void 0)return d};ia.Theme.prototype.getIndicatorDates=function(a){return this._indicatorDateHash[a]};ia.Theme.prototype.getIndicatorIds=function(){for(var a=this._indicatorArray.length,b=[],c=0;c<a;c++){var d=this._indicatorArray[c];b.indexOf(d.id)==-1&&b.push(d.id)}return b};
ia.Theme.prototype.getIndicatorNames=function(){for(var a=this._indicatorArray.length,b=[],c=0;c<a;c++){var d=this._indicatorArray[c];b.indexOf(d.name)==-1&&b.push(d.name)}return b};
ia.Theme.prototype.loadData=function(a){function b(){d++;d==c._indicatorArray.length&&a.call(null,this)}for(var c=this,d=0,e=this._indicatorArray.length,f=0;f<e;f++){var g=this._indicatorArray[f];this.loadIndicator(g.id,g.date,b)}if(this.hasThemes)for(var h=0,g=function(){h++;h==c._themeArray.length&&a.call(null,this)},e=this._themeArray.length,f=0;f<e;f++)this._themeArray[f].loadData(g)};
ia.Theme.prototype.getProfileData=function(a,b,c,d){var e={};e.id=this.id;e.name=this.name;e.indicators=[];b[b.length]=e;if(this.hasThemes)for(var f=this._themeArray.length,g=0;g<f;g++)this._themeArray[g].getProfileData(a,b,c,d);d&&c!=void 0?b=this.getIndicatorsWithDate(c):d&&c==void 0?(c=this.getFirstIndicator(!0).date,b=this.getIndicatorsWithDate(c)):b=this.getIndicators();c=b.length;for(g=0;g<c;g++){d=b[g];f={};f.id=d.id;f.name=d.name;f.date=d.date;f.type=d.type;f.href=d.href;f.features=[];e.indicators[e.indicators.length]=
f;for(var h=a.length,j=0;j<h;j++){var i=this.geography.getFeature(a[j]),m={};m.id=i.id;m.name=i.name;m.value=d.getValue(i.id);m.value_formatted=d.getFormattedValue(i.id);for(var k=d.getAssociates(),n=k.length,l=0;l<n;l++){var o=k[l];m[o.name]=o.getValue(i.id);m[o.name+"_formatted"]=o.getFormattedValue(i.id);m[o.name+"_type"]=o.type}var i=d.getProperties(),p;for(p in i)m[p]=i[p],m[p+"_formatted"]=i[p],m[p+"_type"]=ia.Thematic.CATEGORIC;f.features[f.features.length]=m}}};
ia.Theme.prototype.getFeatureData=function(a,b){var c={};c.id=this.id;c.name=this.name;c.href=this.href;c.precision=this.precision;c.themes=[];c.indicators=[];if(this.hasThemes)for(var d=this._themeArray.length,e=0;e<d;e++){var f=this._themeArray[e];f.hasData&&(f=f.getFeatureData(a,b),c.themes[c.themes.length]=f)}d=this.getIndicators();f=d.length;for(e=0;e<f;e++){var g=d[e];if(b==void 0||b==g.date){var h={};h.id=g.id;h.name=g.name;h.date=g.date;h.type=g.type;h.href=g.href;h.precision=g.precision;
h.value=g.getValue(a.id);h.formattedValue=g.getFormattedValue(a.id);h.associates=[];h.properties=[];for(var j=g.getAssociates(),i=j.length,m=0;m<i;m++){var k=j[m],n={};n.name=k.name;n.type=k.type;n.precision=k.precision;n.value=k.getValue(a.id);n.formattedValue=k.getFormattedValue(a.id);h.associates[h.associates.length]=n}if(i=g.getLowerLimits())j={},j.value=i.getValue(a.id),j.precision=i.precision,j.formattedValue=i.getFormattedValue(a.id),h.lowerLimit=j;if(i=g.getUpperLimits())j={},j.value=i.getValue(a.id),
j.precision=i.precision,j.formattedValue=i.getFormattedValue(a.id),h.upperLimit=j;var g=g.getProperties(),l;for(l in g)j={},j.name=l,j.value=g[l],h.properties[h.properties.length]=j;c.indicators[c.indicators.length]=h}}return c};
ia.Theme.prototype.getIndicatorData=function(a,b){var c={};c.id=this.id;c.name=this.name;c.href=this.href;c.precision=this.precision;c.themes=[];c.indicators=[];if(this.hasThemes)for(var d=this._themeArray.length,e=0;e<d;e++){var f=this._themeArray[e];f.hasData&&(f=f.getIndicatorData(l,b),c.themes[c.themes.length]=f)}d=this.getIndicators();f=d.length;for(e=0;e<f;e++){var g=d[e];if(b==void 0||b==g.date){var h={};h.id=g.id;h.name=g.name;h.date=g.date;h.type=g.type;h.href=g.href;h.precision=g.precision;
h.properties=[];var j=g.getProperties(),i;for(i in j){var m={};m.name=i;m.value=j[i];h.properties[h.properties.length]=m}h.features=[];for(var k=a.length,n=0;n<k;n++){var l=this.geography.getFeature(a[n]),o={};o.id=l.id;o.name=l.name;o.href=l.href;o.value=g.getValue(l.id);o.formattedValue=g.getFormattedValue(l.id);o.associates=[];o.properties=[];j=l.getProperties();for(i in j)m={},m.name=i,m.value=j[i],o.properties[o.properties.length]=m;for(var j=g.getAssociates(),m=j.length,p=0;p<m;p++){var r=j[p],
s={};s.name=r.name;s.type=r.type;s.precision=r.precision;s.value=r.getValue(l.id);s.formattedValue=r.getFormattedValue(l.id);o.associates[o.associates.length]=s}if(m=g.getLowerLimits())j={},j.value=m.getValue(l.id),j.precision=m.precision,j.formattedValue=m.getFormattedValue(l.id),o.lowerLimit=j;if(m=g.getUpperLimits())j={},j.value=m.getValue(l.id),j.precision=m.precision,j.formattedValue=m.getFormattedValue(l.id),o.upperLimit=j;h.features[h.features.length]=o}c.indicators[c.indicators.length]=h}}return c};
ia.Associate=function(a,b,c){ia.Associate.baseConstructor.call(this,c,b);this.indicator=b;this.geography=a;this.parseData()};ia.extend(ia.BaseData,ia.Associate);
ia.Associate.prototype.parseData=function(){this.id=this.data.name;this._indexHash={};this._valueArray=this.data.values;this._fValueArray=[];if(this._valueArray){var a=this.geography.getFeatures(),b=a.length;this.minValue=Infinity;this.maxValue=-Infinity;for(var c,d,e,f=0;f<b;f++)e=a[f].id,c=this._valueArray[f],d=this.geography.reportData.formatter.format(c,this.precision),this._indexHash[e]=f,this.minValue=c<this.minValue?c:this.minValue,this.maxValue=c>this.maxValue?c:this.maxValue,this._fValueArray.push(d)}this._comparisonIndexHash=
{};this._comparisonArray=this.data.comparisonValues;this._fComparisonArray=[];if(this._comparisonArray){a=this.geography.getComparisonFeatures();b=a.length;for(f=0;f<b;f++)e=a[f].id,c=this._comparisonArray[f],this._comparisonIndexHash[e]=f,d=this.geography.reportData.formatter.format(c,this.precision),this._fComparisonArray.push(d)}};ia.Associate.prototype.getValue=function(a){return this._indexHash[a]!=void 0?this._valueArray[this._indexHash[a]]:this.getComparisonValue(a)};
ia.Associate.prototype.getValues=function(){return this._valueArray};ia.Associate.prototype.getFormattedValue=function(a){return this._indexHash[a]!=void 0?this._fValueArray[this._indexHash[a]]:this.getFormattedComparisonValue(a)};ia.Associate.prototype.getFormattedValues=function(){return this._fValueArray};ia.Associate.prototype.getComparisonValue=function(a){if(this._comparisonIndexHash[a]!=void 0)return this._comparisonArray[this._comparisonIndexHash[a]]};
ia.Associate.prototype.getComparisonValues=function(){return this._comparisonArray};ia.Associate.prototype.getFormattedComparisonValue=function(a){if(this._comparisonIndexHash[a]!=void 0)return this._fComparisonArray[this._comparisonIndexHash[a]]};ia.Associate.prototype.getFormattedComparisonValues=function(){return this._fComparisonArray};ia.Indicator=function(a,b,c){ia.Indicator.baseConstructor.call(this,c,b);this.theme=b;this.geography=a;this.parseData()};ia.extend(ia.BaseData,ia.Indicator);
ia.Indicator.prototype.parseData=function(){if(this.data.fileName!=void 0)this.fileName=this.geography.reportData.path+this.data.fileName;if(this.data.date!=void 0)this.date=this.data.date;this._indexHash={};this._valueArray=this.data.values;this._fValueArray=[];if(this._valueArray){var a=this.geography.getFeatures(),b=a.length;this.minValue=Infinity;this.maxValue=-Infinity;for(var c,d,e,f=0;f<b;f++)e=a[f].id,c=this._valueArray[f],d=this.geography.reportData.formatter.format(c,this.precision),this._indexHash[e]=
f,this.minValue=c<this.minValue?c:this.minValue,this.maxValue=c>this.maxValue?c:this.maxValue,this._fValueArray.push(d)}this._comparisonIndexHash={};this._comparisonArray=this.data.comparisonValues;this._fComparisonArray=[];if(this._comparisonArray){a=this.geography.getComparisonFeatures();b=a.length;for(f=0;f<b;f++)e=a[f].id,c=this._comparisonArray[f],this._comparisonIndexHash[e]=f,d=this.geography.reportData.formatter.format(c,this.precision),this._fComparisonArray.push(d)}this._associateArray=
[];this._associateHash={};c=this.data.associates;if(c!=void 0){d=c.length;for(f=0;f<d;f++)e=new ia.Associate(this.geography,this,c[f]),this._associateArray[f]=e,this._associateHash[e.id]=e}if(this.data.limits!=void 0)this._lowerLimits=new ia.Limits(this.geography,this,this.data.limits.lower),this._upperLimits=new ia.Limits(this.geography,this,this.data.limits.upper)};ia.Indicator.prototype.getLowerLimits=function(){return this._lowerLimits};ia.Indicator.prototype.getUpperLimits=function(){return this._upperLimits};
ia.Indicator.prototype.getValue=function(a){return this._indexHash[a]!=void 0?this._valueArray[this._indexHash[a]]:this.getComparisonValue(a)};ia.Indicator.prototype.getValues=function(){return this._valueArray};ia.Indicator.prototype.getFormattedValue=function(a){return this._indexHash[a]!=void 0?this._fValueArray[this._indexHash[a]]:this.getFormattedComparisonValue(a)};ia.Indicator.prototype.getFormattedValues=function(){return this._fValueArray};
ia.Indicator.prototype.getComparisonValue=function(a){if(this._comparisonIndexHash[a]!=void 0)return this._comparisonArray[this._comparisonIndexHash[a]]};ia.Indicator.prototype.getComparisonValues=function(){return this._comparisonArray};ia.Indicator.prototype.getFormattedComparisonValue=function(a){if(this._comparisonIndexHash[a]!=void 0)return this._fComparisonArray[this._comparisonIndexHash[a]]};ia.Indicator.prototype.getFormattedComparisonValues=function(){return this._fComparisonArray};
ia.Indicator.prototype.getAssociate=function(a){return this._associateHash[a]};ia.Indicator.prototype.getAssociates=function(){return this._associateArray};ia.Indicator.prototype.getDataType=function(a){if(a=="value")return this.type;else if(this.getAssociate(a)!=void 0)return this.getAssociate(a).type;else if(a=="name")return ia.Thematic.CATEGORIC};ia.Indicator.prototype.getDataPrecision=function(a){if(a=="value")return this.precision;else if(this.getAssociate(a)!=void 0)return this.getAssociate(a).precision};
ia.Indicator.prototype.getData=function(a){var b={},c,d;a!=null?c=a.length:(d=this.geography.getFeatures(),c=d.length);for(var e=this.getAssociates(),f=e.length,g=this.getLowerLimits(),h=this.getUpperLimits(),j=0;j<c;j++){var i;i=a!=null?this.geography.getFeature(a[j]):d[j];var m={};m.id=i.id;m.name=i.name;m.value=this.getValue(i.id);m.value_formatted=this.getFormattedValue(i.id);var k=i.getProperties(),n;for(n in k)m[n]=k[n],m[n+"_formatted"]=k[n];if(g)m.lowerLimit=g.getValue(i.id),m.lowerLimit_formatted=
g.getFormattedValue(i.id);if(h)m.upperLimit=h.getValue(i.id),m.upperLimit_formatted=h.getFormattedValue(i.id);if(i.href)m.href=i.href;for(k=0;k<f;k++)m[e[k].name]=e[k].getValue(i.id),m[e[k].name+"_formatted"]=e[k].getFormattedValue(i.id);b[i.id]=m}return b};
ia.Indicator.prototype.getComparisonData=function(){for(var a={},b=this.geography.getComparisonFeatures(),c=b.length,d=this.getAssociates(),e=d.length,f=0;f<c;f++){var g=b[f],h={};h.id=g.id;h.name=g.name;h.value=this.getComparisonValue(g.id);h.value_formatted=this.getFormattedComparisonValue(g.id);if(g.href)h.href=g.href;var j=g.getProperties(),i;for(i in j)h[i]=j[i],h[i+"_formatted"]=j[i];for(j=0;j<e;j++)h[d[j].name]=d[j].getComparisonValue(g.id),h[d[j].name+"_formatted"]=d[j].getFormattedComparisonValue(g.id);
a[g.id]=h}return a};ia.Limits=function(a,b,c){this._indexHash={};this._valueArray=c;this._fValueArray=[];if(this._valueArray){b=a.getFeatures();c=b.length;this.minValue=Infinity;this.maxValue=-Infinity;for(var d,e,f,g=0;g<c;g++)f=b[g].id,d=this._valueArray[g],e=a.reportData.formatter.format(d,this.precision),this._indexHash[f]=g,this.minValue=d<this.minValue?d:this.minValue,this.maxValue=d>this.maxValue?d:this.maxValue,this._fValueArray.push(e)}};ia.Limits.prototype.getValue=function(a){return this._valueArray[this._indexHash[a]]};
ia.Limits.prototype.getValues=function(){return this._valueArray};ia.Limits.prototype.getFormattedValue=function(a){return this._fValueArray[this._indexHash[a]]};ia.Limits.prototype.getFormattedValues=function(){return this._fValueArray};ia.Feature=function(a){ia.Feature.baseConstructor.call(this,a);this._filterHash={};this._filterHash={};a=this.data.filters;if(a!=void 0)for(var b=a.length,c=0;c<b;c++){var d=a[c];this._filterHash[d["for"]]=d.name}};ia.extend(ia.BaseData,ia.Feature);
ia.Feature.prototype.getFilterValue=function(a){return this._filterHash[a]};ia.Filter=function(a){ia.Filter.baseConstructor.call(this,a)};ia.extend(ia.BaseData,ia.Filter);ia.MapData=function(){this._layerCount=-1;this._visibleLayers=[];this._callbackFnc=void 0;this._layerHash={};this.tilePath="./";this.useGoogleMaps=!1;this.path=""};ia.MapData.prototype.loadSource=function(a,b){var c=this;this.url=a;this.path=ia.File.getFileDirectory(a);ia.File.load(a,"json",function(a){c.parseData(a,b)})};
ia.MapData.prototype.getLayer=function(a){return this._layerHash[a]};
ia.MapData.prototype.parseData=function(a,b){this._callbackFnc=b;this._visibleLayers=[];this.layers=[];this.baseLayers=[];this.noneBaseLayers=[];var c=[],d=[],e=[],f=[],g=[];this._layerHash={};if(a.template!=void 0)this.template=a.template;if(a.version!=void 0)this.version=a.version;if(a.boundingBox!=void 0){var h=a.boundingBox.split(" ");this.mapBBox=new ia.BoundingBox(parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]))}h=a.layers;if(h!=void 0){for(var j=h.length,i=0;i<j;i++){var m=
h[i];if(m.type=="google-layer"&&navigator.onLine)this.useGoogleMaps=!0,this.googleMapType=m.mapType,this.googleApiKey=m.apiKey}for(i=0;i<j;i++){m=h[i];if(m.geometry=="image"&&this.useGoogleMaps==!1){var k;m.type=="tile-layer"?(k=new ia.TileLayer(this.path+m.url),k.path=this.tilePath,this._parseLayerProperties(m,k)):m.type=="ags-layer"&&navigator.onLine?(k=new ia.AGSLayer,this._parseLayerProperties(m,k)):m.type=="wms-layer"&&navigator.onLine&&(k=new ia.WMSLayer,this._parseLayerProperties(m,k));m.isReference?
d[d.length]=k:c[c.length]=k}if(m.geometry!="image"){var n=m.idField!=void 0;if(m.type=="base-layer"){if(k=n?new ia.AGSFeatureLayer(m.url):new ia.FeatureLayer(this.path+m.url),this.baseLayers[this.baseLayers.length]=k,this.baseLayers.length==1)this.baseLayer=k}else m.type=="contextual-layer"?k=n?new ia.AGSFeatureLayer(m.url):new ia.FeatureLayer(this.path+m.url):m.type=="rss-layer"&&(k=new ia.GeoRSSLayer(m.url));this._parseLayerProperties(m,k);m.type=="base-layer"&&this.baseLayers.length>1&&(k=this._visibleLayers.pop(),
k.setVisible(!1));m.type!="base-layer"&&(k.geometry=="point"?e[e.length]=k:k.geometry=="line"?f[f.length]=k:k.geometry=="polygon"&&(g[g.length]=k))}}this.noneBaseLayers=c.concat(g).concat(f).concat(e).concat(d);for(i=0;i<this.baseLayers.length;i++)k=this.baseLayers[i],k.geometry=="point"?e.unshift(k):k.geometry=="line"?f.unshift(k):k.geometry=="polygon"&&g.unshift(k);this.layers=c.concat(g).concat(f).concat(e).concat(d)}this.useGoogleMaps&&ia.googleMapsLoaded==!1?(c=document.createElement("script"),
c.type="text/javascript",c.src=this.googleApiKey!=""?"http://maps.googleapis.com/maps/api/js?key="+this.googleApiKey+"&sensor=false&callback=ia.initGoogleMaps":"http://maps.google.com/maps/api/js?sensor=false&callback=ia.initGoogleMaps",document.body.appendChild(c)):this.loadVisibleLayers()};
ia.MapData.prototype._parseLayerProperties=function(a,b){b.id=a.id;b.name=a.name;b.showInLayerList=a.showInLayerList;if(a.visible!=void 0&&(b.setVisible(a.visible),a.visible==!0||a.type=="base-layer"))this._visibleLayers[this._visibleLayers.length]=b;if(a.minLabelExtent!=void 0)b.minLabelExtent=a.minLabelExtent;if(a.maxLabelExtent!=void 0)b.maxLabelExtent=a.maxLabelExtent;if(a.showLabels!=void 0)b.showLabels=a.showLabels;if(a.showDataTips!=void 0)b.showDataTips=a.showDataTips;if(a.iconPath!=void 0&&
a.iconPath!=""&&(b.iconPath=a.iconPath,b.iconPath.indexOf("http")==-1&&b.iconPath.indexOf("javascript")==-1))b.iconPath=ia.IAS_PATH+b.iconPath;if(a.idField!=void 0)b.idField=a.idField;if(a.nameField!=void 0)b.nameField=a.nameField;if(a.srs!=void 0)b.srs=a.srs;if(a.featureIds!=void 0)b.featureIds=a.featureIds;if(a.objectIds!=void 0)b.objectIds=a.objectIds;if(a.boundingBox!=void 0){var c=a.boundingBox.split(" ");b.bBox=new ia.BoundingBox(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]))}b.geometry=
a.geometry;if(a.geometry!="image"){c=b.style;if(a.symbolSize!=void 0)b.symbolSize=a.symbolSize;if(a.fillColor!=void 0)c.fillStyle=ia.Color.toRGBA(a.fillColor,a.fillOpacity);if(a.borderThickness!=void 0)c.lineWidth=a.borderThickness;if(a.borderColor!=void 0){var d=1;c.lineWidth==0&&(d=0);c.strokeStyle=ia.Color.toRGBA(a.borderColor,d)}b.style=c}if(a.url!=void 0)b.url=a.url;if(a.layers!=void 0)b.layers=a.layers;if(a.srs!=void 0)b.srs=a.srs;if(a.version!=void 0)b.version=a.version;if(a.params!=void 0)b.params=
a.params;if(a.requiresAxisSwitch!=void 0)b.requiresAxisSwitch=a.requiresAxisSwitch;if(a.minExtent!=void 0)b.minExtent=a.minExtent;if(a.maxExtent!=void 0)b.maxExtent=a.maxExtent};ia.MapData.prototype.loadVisibleLayers=function(){this._layerCount++;var a=this;if(this._visibleLayers.length>this._layerCount){var b=this._visibleLayers[this._layerCount];b.addEventListener(ia.Event.LAYER_READY,function(){a.loadVisibleLayers()});b.loadSource()}else this._callbackFnc.call(null,this)};
ia.DataEvent=function(a,b,c,d,e){ia.DataEvent.baseConstructor.call(this,a,b);this.data=b;this.geography=c;this.theme=d;this.indicator=e};ia.extend(ia.Event,ia.DataEvent);ia.DataEvent.GEOG_CHANGED="geogChanged";ia.DataEvent.INDICATOR_CHANGED="indicatorChanged";ia.FilterEvent=function(a,b,c,d,e){ia.FilterEvent.baseConstructor.call(this,a,b);this.data=b;this.filterId=c;this.filterName=d;this.filterValue=e};ia.extend(ia.Event,ia.FilterEvent);ia.FilterEvent.FILTER_CHANGED="filterChanged";
ia.AGOLData=function(){ia.AGOLData.baseConstructor.call(this);this.iaData={};this._fsIndicators=[];this._csvIndicators=[]};ia.extend(ia.ReportData,ia.AGOLData);ia.AGOLData.prototype.loadSource=function(a,b){var c=this;this.url=a;this.path=ia.File.getFileDirectory(this.url);ia.File.load(this.url,"json",function(a){c.parseAGOLData(a,function(){c.parseData(c.iaData,b)})})};
ia.AGOLData.prototype.parseAGOLData=function(a,b){var c=this;c.agolData=a;this.iaData={};this.iaData.version=a.version;this.iaData.geographies=[];var d=a.geographies;if(d!=void 0&&d.length>0){var e=0,f=function(){e++;e==d.length?b.call(null,c):c.buildGeography(d[e],f)};this.buildGeography(d[0],f)}else b.call(null,c)};
ia.AGOLData.prototype.buildGeography=function(a,b){var c=this,d={};d.id=a.id;d.name=a.name;d.type=a.type;d.url=a.url;d.idField=a.idField;d.nameField=a.nameField;d.objectIds=a.objectIds;d.themes=[];d.features=[];d.comparisonFeatures=[];this.iaData.geographies[this.iaData.geographies.length]=d;d.fieldNames=d.idField;d.fieldNames=d.fieldNames+","+d.nameField;this._fsIndicators=[];this._csvIndicators=[];this.buildThemes(d,d,a.model.themes);this.getObjectIds(d,function(a,f){function g(a){j=j.concat(a);
m++;if(m==i){for(var a=j.length,e=0;e<a;e++){var f=j[e],o={};o.id=String(f.attributes[d.idField]);o.name=String(f.attributes[d.nameField]);o.id.indexOf("#")==0?d.comparisonFeatures[d.comparisonFeatures.length]=o:d.features[d.features.length]=o;for(var p=0;p<c._fsIndicators.length;p++){var r=c._fsIndicators[p];o.id.indexOf("#")==0?r.comparisonValues[r.comparisonValues.length]=f.attributes[r.fieldName]:r.values[r.values.length]=f.attributes[r.fieldName]}}if(c._csvIndicators.length>0){var s=0,w=function(){s++;
s==c._csvIndicators.length?b.call(null,c):c.readCsvFile(d.idField,j,c._csvIndicators[s],w)};c.readCsvFile(d.idField,j,c._csvIndicators[0],w)}else b.call(null,c)}else c.getAttributeData(d.url,h[m],d.fieldNames,g)}for(var f=Math.min(a.length,f),h=[];a.length>0;)h[h.length]=a.splice(0,f);var j=[],i=h.length,m=0;c.getAttributeData(d.url,h[m],d.fieldNames,g)})};
ia.AGOLData.prototype.readCsvFile=function(a,b,c,d){function e(a){a.charAt(0)=='"'&&a.charAt(a.length-1)=='"'?a=a.substring(1,a.length-1):a.charAt(0)=="'"&&a.charAt(a.length-1)=="'"&&(a=a.substring(1,a.length-2));return a}var f=this;ia.File.loadCSV(c.url,"text",function(g){var h=g.split(/\n/);h.pop(h.length-1);for(var j=h[0].split(","),i=0,m=0,g=0;g<j.length;g++){var k=$j.trim(j[g]),k=e(k);$j.trim(c.idField)==k&&(i=g);$j.trim(c.fieldName)==k&&(m=g)}for(var j={},k={},n=h.slice(1,h.length),g=0;g<n.length;g++){var h=
$j.trim(n[g].split(",")[i]),h=e(h),l=$j.trim(n[g].split(",")[m]),l=e(l);c.type=="numeric"&&ia.isNumber(l)&&(l=parseFloat(l));h.indexOf("#")==0?k[h]=l:j[h]=l}i=b.length;for(g=0;g<i;g++)h=String(b[g].attributes[a]),h.indexOf("#")==0?(m=k[h],c.comparisonValues[c.comparisonValues.length]=m?k[h]:f.formatter.noDataValue):(m=j[h],c.values[c.values.length]=m?j[h]:f.formatter.noDataValue);d.call(null,f)})};
ia.AGOLData.prototype.buildThemes=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d],f={};f.id=e.id;f.name=e.name;f.indicators=[];b.themes[b.themes.length]=f;if(e.themes&&e.themes.length>0)f.themes=[],this.buildThemes(a,f,e.themes);for(var e=e.indicators,g=0;g<e.length;g++){var h=e[g],j=this.buildIndicator(a,h);f.indicators[f.indicators.length]=j;if(h.associates!=void 0&&h.associates.length>0){j.associates=[];for(var i=0;i<h.associates.length;i++){var m=this.buildIndicator(a,h.associates[i]);
j.associates[j.associates.length]=m}}}}};
ia.AGOLData.prototype.buildIndicator=function(a,b){var c={};c.id=b.id;c.name=b.name;c.type=b.type.toLowerCase();c.date=b.date;c.precision=b.precision;c.url=b.src.url;c.fieldName=b.src.fieldName;c.properties=b.properties;c.values=[];c.comparisonValues=[];c.url==a.url?(a.fieldNames=a.fieldNames+","+c.fieldName,this._fsIndicators[this._fsIndicators.length]=c):(c.fieldName=b.src.fieldName.split(",")[0],c.idField=b.src.fieldName.split(",")[1],this._csvIndicators[this._csvIndicators.length]=c);return c};
ia.AGOLData.prototype._useToken=!0;
ia.AGOLData.prototype.getObjectIds=function(a,b){var c=this;ia.File.load(a.url+"?f=json","json",function(d){d.error&&ia.log(d.error);if(d.error&&d.error.code==498)return c._useToken=!1,c.getObjectIds(a,b);else if(d.error&&d.error.code==499)d="https://www.arcgis.com/sharing/oauth2/authorize?client_id=83wV2txRMBrDpKjq&response_type=token&redirect_uri="+encodeURI(window.location.href),window.location.href=d;else{var e=Infinity;d.maxRecordCount!=void 0&&(e=ia.parseInt(d.maxRecordCount));d=a.url+"/query?where=1+%3D+1&f=json&returnIdsOnly=true";
a.objectIds!=void 0&&(d=a.url+"/query?objectIds="+a.objectIds+"&f=json&returnIdsOnly=true");ia.File.load(d,"json",function(a){b.call(null,a.objectIds,e)},c._useToken)}},c._useToken)};ia.AGOLData.prototype.getAttributeData=function(a,b,c,d){a+="/query";ia.File.postJSON(a,"where=1+%3D+1&f=json&returnGeometry=false&returnIdsOnly=false&returnCountOnly=false&objectIds="+b+"&outFields="+c,function(a){d.call(null,a.features)},this._useToken)};
ia.WebMapData=function(){ia.WebMapData.baseConstructor.call(this);this.iaData={};this.iaMapData={};this._srs=102100;this._boundingBox="";this._fsLayers=[]};ia.extend(ia.ReportData,ia.WebMapData);ia.WebMapData.prototype.loadSource=function(a,b){var c=this;this.url=a;this.path=ia.File.getFileDirectory(this.url);c.readWebMap(this.url,function(){ia.log(c.iaData);ia.log(c.iaMapData);c.parseData(c.iaData,b)})};
ia.WebMapData.prototype.readWebMap=function(a,b){var c=this;this.iaData={};this.iaData.version="1.2";this.iaData.geographies=[];this.iaMapData={};this.iaMapData.layers=[];this._fsLayers=[];ia.log("Web Map Data: "+a);ia.File.load(a,"json",function(a){var e=a.operationalLayers;if(e!=void 0&&e.length>0){var f=e.length-1,g=function(){f--;f<0?b.call(null,c):c.build(e[f],g)};c.build(e[f],g)}else b.call(null,c)})};
ia.WebMapData.prototype.buildImageLayer=function(a){var b={};this.iaMapData.layers[this.iaMapData.layers.length]=b;b.type="ags-layer";b.id=a.id;b.name=a.id;b.geometry="image";b.url=a.url+"//export?";b.visible=a.visibility;b.showInLayerList=!1;b.srs=this._srs;if(a.isReference)b.isReference=!0,b.params="&format=png&transparent=true"};
ia.WebMapData.prototype.build=function(a,b){var c=this;if(a.url&&a.type!="CSV"&&a.type!="WMS"&&a.type!="KML"&&a.url.indexOf("FeatureServer")!=-1){for(var d,e,f=0;f<this._fsLayers.length;f++)if(e=this._fsLayers[f],a.url==e.url){d=this.iaData.geographies[f];break}d!=void 0?(this.buildIndicator(d.themes[0],a,e.description,e.data),b.call(null)):(e=a.url+"?f=json",ia.log("FeatureServer Layer Description: "+e),ia.File.load(e,"json",function(e){d={};d.id=e.id;d.name=e.name;if(e.geometryType=="esriGeometryPolygon")d.type=
"polygon";else if(e.geometryType=="esriGeometryPoint"||e.geometryType=="esriGeometryMultipoint")d.type="point";else if(e.geometryType=="esriGeometryPolyline")d.type="line";d.themes=[];c.iaData.geographies[c.iaData.geographies.length]=d;var f={id:"t0"};f.name=e.name;f.indicators=[];d.themes[d.themes.length]=f;c.buildBaseLayer(a.url,e);var j=a.url+"/query?where=1+%3D+1&f=json&returnGeometry=false&outFields=*";ia.log("FeatureServer Layer Attributes: "+j);ia.File.load(j,"json",function(i){c.buildFeatures(d,
e,i);c._fsLayers[c._fsLayers.length]={id:i.id,url:a.url,description:e,data:i};c.buildIndicator(f,a,e,i);b.call(null)})}))}};ia.WebMapData.prototype.buildFeatures=function(a,b,c){a.features=[];for(var d=c.features.length,e=0;e<d;e++){var f=c.features[e],g={};g.id=String(f.attributes[b.objectIdField]);g.name=b.displayField==void 0||b.displayField==""?g.id:String(f.attributes[b.displayField]);a.features[a.features.length]=g}};
ia.WebMapData.prototype.buildIndicator=function(a,b,c,d){var e={};e.id=b.id;e.name=b.title;e.date=void 0;e.values=[];var f;if(b.layerDefinition)f=b.layerDefinition.drawingInfo.renderer;else if(c.drawingInfo)f=c.drawingInfo.renderer;if(f!=void 0){var g,h;if(f.type=="classBreaks")g=f.field;else if(f.type=="uniqueValue")g=f.field1;for(b=0;b<d.fields.length;b++)if(h=d.fields[b],g==h.name)break;e.type=h.type=="esriFieldTypeDouble"||h.type=="esriFieldTypeInteger"?"numeric":"categoric";h=d.features.length;
for(b=0;b<h;b++)e.values[b]=d.features[b].attributes[g];c=h=g=d="";if(f.type=="classBreaks"){d=f.minValue;for(b=0;b<f.classBreakInfos.length;b++){var j=f.classBreakInfos[b],d=d+";"+j.classMaxValue;j.label&&(g=b==0?j.label:g+";"+j.label);if(j.symbol&&j.symbol.color){var i=j.symbol.color,i="rgb("+i[0]+","+i[1]+","+i[2]+")";h=b==0?i:h+";"+i}if(j.symbol&&j.symbol.outline)i=j.symbol.outline.color,i="rgb("+i[0]+","+i[1]+","+i[2]+")",c=b==0?i:c+";"+i}}else if(f.type=="uniqueValue")for(b=0;b<f.uniqueValueInfos.length;b++){j=
f.uniqueValueInfos[b];d=b==0?j.value:d+";"+j.value;j.label&&(g=b==0?j.label:g+";"+j.label);if(j.symbol&&j.symbol.color)i=j.symbol.color,i="rgb("+i[0]+","+i[1]+","+i[2]+")",h=b==0?i:h+";"+i;if(j.symbol&&j.symbol.outline)i=j.symbol.outline.color,i="rgb("+i[0]+","+i[1]+","+i[2]+")",c=b==0?i:c+";"+i}e.properties=[];d!=""&&(e.properties[e.properties.length]={name:"customBreaks",value:d});g!=""&&(e.properties[e.properties.length]={name:"customLabels",value:g});h!=""&&(e.properties[e.properties.length]=
{name:"customColours",value:h});c!=""&&(e.properties[e.properties.length]={name:"customBorderColours",value:c})}a.indicators[a.indicators.length]=e};
ia.WebMapData.prototype.buildBaseLayer=function(a,b){var c={};this.iaMapData.layers[this.iaMapData.layers.length]=c;if(this.iaMapData.layers.length==1){var d=b.extent;this._boundingBox=d.xmin+" "+d.ymin+" "+d.xmax+" "+d.ymax;this._srs=d.spatialReference.wkid;this.iaMapData.boundingBox=this._boundingBox}if(b.geometryType=="esriGeometryPolygon")c.geometry="polygon";else if(b.geometryType=="esriGeometryPoint"||b.geometryType=="esriGeometryMultipoint")c.geometry="point";else if(b.geometryType=="esriGeometryPolyline")c.geometry=
"line";var d=b.objectIdField,e=b.displayField;if(e==void 0||e=="")e=d;c.url=a;c.idField=d;c.nameField=e;c.srs=this._srs;c.boundingBox=this._boundingBox;c.type="base-layer";c.id=b.id;c.name=b.name;c.visible=!0;c.symbolSize=15;c.fillColor="#EFEFEF";c.fillOpacity=b.opacity||0.8;c.borderColor="#cccccc";c.borderThickness=1;c.showLabels=!1;c.iconPath="";c.showDataTips=!0;c.showInLayerList=!0};
ia.Widget=function(a){this.id=a;this._height=this._width=this._y=this._x=0;this._zIndex=void 0;this._xAnchor="left";this._yAnchor="top";this._visible=!1};ia.Widget.prototype.rescale=!0;ia.Widget.prototype.id="";ia.Widget.prototype.x=function(a){if(a!=void 0)this.setPosition(a,this._y,this._xAnchor,this._yAnchor);else return this._x};ia.Widget.prototype.y=function(a){if(a!=void 0)this.setPosition(this._x,a,this._xAnchor,this._yAnchor);else return this._y};
ia.Widget.prototype.width=function(a){if(a!=void 0)this.setSize(a,this._height);else return this._width};ia.Widget.prototype.height=function(a){if(a!=void 0)this.setSize(this._width,a);else return this._height};ia.Widget.prototype.zIndex=function(a){if(a!=void 0)this._zIndex=a,this.container.css({"z-index":this._zIndex});else return this._zIndex};ia.Widget.prototype.xAnchor=function(a){if(a!=void 0)this.setPosition(this._x,this._y,a,this._yAnchor);else return this._xAnchor};
ia.Widget.prototype.yAnchor=function(a){if(a!=void 0)this.setPosition(this._x,this._y,this._xAnchor,a);else return this._yAnchor};ia.Widget.prototype.setDimensions=function(a,b,c,d,e,f){this.setSize(c,d);this.setPosition(a,b,e,f)};ia.Widget.prototype.restore=function(){this.setDimensions(this._x,this._y,this._width,this._height,this._xAnchor,this._yAnchor);this.zIndex(this._zIndex)};ia.Widget.prototype.maximize=function(){this.container.css({left:0,top:0,width:"100%",height:"100%","z-index":500})};
ia.Widget.prototype.setSize=function(a,b){var c="%";this.rescale==!1&&(c="px");this._width=a;this._height=b;this._width!=void 0&&this.container.css({width:this._width+c});this._height!=void 0&&this.container.css({height:this._height+c})};
ia.Widget.prototype.setPosition=function(a,b,c,d){this._x=a;this._y=b;this._xAnchor=c||this._xAnchor;this._yAnchor=d||this._xAnchor;this._xAnchor=="end"||this._xAnchor=="right"?(a=this._width,this.rescale||(a=this._width/800*100,a=Math.round(a*10)/10),a=100-(this._x+a),this.container.css({right:a+"%"})):this._xAnchor=="middle"||this._xAnchor=="center"?(a=this._width,this.rescale||(a=this._width/800*100,a=Math.round(a*10)/10),a=this._x+a/2,this.container.css({left:a+"%"}),a=this._width/2*-1,this.rescale==
!1?this.container.css({"margin-left":a+"px"}):this.container.css({"margin-left":a+"%"})):this.container.css({left:this._x+"%"});this._yAnchor=="bottom"?this.container.css({bottom:this._y+"%"}):this.container.css({top:this._y+"%"})};ia.Widget.prototype.toggle=function(){this.visible(!this._visible)};ia.Widget.prototype.show=function(){this.visible(!0)};ia.Widget.prototype.hide=function(){this.visible(!1)};
ia.Widget.prototype.visible=function(a){if(a!=void 0){var b=this;b._visible=a;b.container.stop();b._visible?(b._zIndex&&b.container.css("z-index",b._zIndex),b.container.css("visibility","visible").animate({opacity:1})):b.container.animate({opacity:0},function(){b._zIndex&&b.container.css("z-index",0);b.container.css("visibility","hidden")})}else return b._visible};
ia.Widget.prototype.tooltip=function(a){a!=""&&!ia.IS_TOUCH_DEVICE&&(xOffset=10,yOffset=20,this.container.hover(function(b){$j("body").append("<div id='ia-tooltip' class='ia-tooltip'>"+a+"</div>");$j("#ia-tooltip").css("top",b.pageY-yOffset+"px").css("left",b.pageX+xOffset+"px");$j("#ia-tooltip").fadeIn("slow").delay(1500).fadeOut("slow")},function(){$j("#ia-tooltip").remove()}),this.container.mousemove(function(a){$j("#ia-tooltip").css("top",a.pageY-yOffset+"px").css("left",a.pageX+xOffset+"px")}))};
ia.Widget.prototype.onclick=function(a,b){if(a){var c=this;c.container.css("cursor","pointer");typeof a=="function"?c.container.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();ia.IS_TOUCH_DEVICE&&b.preventDefault();a.call(null,b)}):function(){c.container.bind(ia.CLICK_TYPE,function(c){c.stopPropagation();ia.IS_TOUCH_DEVICE&&c.preventDefault();ia.callFunction(a,b,c)})}()}};ia.Widget.prototype.addCssClass=function(a){a&&a!=""&&this.container.addClass(a)};
ia.Panel=function(a,b){ia.Panel.baseConstructor.call(this,a);this._title=b;this._popup=!1;this._settingsBtn=void 0;this._hasSettings=!1;this._closeBtn=void 0;this._closeable=!1;this._exportBtn=void 0;this._exportable=!1;this._resizeBtn=void 0;this._isMaximized=this._resizeable=!1;this._borderRadius=0;this._build()};ia.extend(ia.Widget,ia.Panel);
ia.Panel.prototype._build=function(){var a=this;this._borderRadius=parseInt($j(".ia-panel").css("border-top-left-radius"))-1;if(this._borderRadius<0)this._borderRadius=0;this.container=$j("<div>").addClass("ia-widget ia-panel").attr("id",this.id);this.container.css("visibility","hidden");this.container.resize(function(){a._size()});this.content=$j("<div>").addClass("ia-panel-content").attr("id",this.id+"-content");this.contentText=$j("<div>").addClass("ia-panel-content-text ia-nodata-text").attr("id",
this.id+"-content-text");this.header=$j("<div>").addClass("ia-panel-header").attr("id",this.id+"-header");this.header.css("border-top-left-radius",this._borderRadius+"px");this.header.css("border-top-right-radius",this._borderRadius+"px");this.header.css({display:"none"});this.container.append(this.header);this.container.append(this.content);this.container.append(this.contentText);this.footer=$j("<div>").addClass("ia-panel-footer").attr("id",this.id+"-footer");this.container.append(this.footer);var b=
$j("<div>").addClass("ia-panel-btns").attr("id",this.id+"-btns");this.container.append(b);if(ia.IS_TOUCH_DEVICE){var c;this.container.bind("touchstart",function(){b.stop();b.css({visibility:"visible"}).animate({opacity:1});clearTimeout(c);c=setTimeout(function(){clearTimeout(c);b.stop().animate({opacity:0},function(){b.css({visibility:"hidden"})})},5E3)})}else this.container.mouseenter(function(){b.stop().css({visibility:"visible"}).animate({opacity:0.5})}),this.container.mouseleave(function(){b.stop().animate({opacity:0},
function(){b.css({visibility:"hidden"})})}),b.mouseenter(function(){b.stop().animate({opacity:1})}),b.mouseleave(function(){b.stop().animate({opacity:0.5})});this._resizeBtn=$j("<div>").addClass("ia-panel-btn ia-panel-resize-btn-maximize").attr("id",this.id+"-resize").css("display","none");b.append(this._resizeBtn);this._resizeBtn.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a.resizeFunction&&a.resizeFunction.call(null,a)});this._exportBtn=$j("<div>").addClass("ia-panel-btn ia-panel-export-btn").attr("id",
this.id+"-export").css("display","none");this._exportBtn.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a.exportFunction&&a.exportFunction.call(null,a)});b.append(this._exportBtn);this._closeBtn=$j("<div>").addClass("ia-panel-btn ia-panel-close-btn").attr("id",this.id+"-close").css("display","none");this._closeBtn.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a.closeFunction&&a.closeFunction.call(null,a)});b.append(this._closeBtn);this._settingsBtn=$j("<div>").addClass("ia-panel-btn ia-panel-settings-btn").attr("id",
this.id+"-settings").css("display","none");this._settingsBtn.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a.settingsFunction&&a.settingsFunction.call(null,b)});b.append(this._settingsBtn);this.title(this._title);this._size()};
ia.Panel.prototype.popup=function(a){var b=this;if(a==!0)this._popup=!0,this.container.addClass("ia-popup-panel"),$j("body").bind(ia.CLICK_TYPE,function(){b.hide()}),this.container.bind(ia.CLICK_TYPE,function(a){a.stopPropagation()});else if(a==!1)this._popup=!1;else return this._popup};ia.Panel.prototype.hasSettings=function(a){if(a==!0)this._hasSettings=!0,this._settingsBtn.css("display","");else if(a==!1)this._hasSettings=!1,this._settingsBtn.css("display","none");else return this._hasSettings};
ia.Panel.prototype.closeable=function(a){if(a==!0)this._closeable=!0,this._closeBtn.css("display","");else if(a==!1)this._closeable=!1,this._closeBtn.css("display","none");else return this._closeable};ia.Panel.prototype.closeFunction=function(a){a.hide()};ia.Panel.prototype.exportable=function(a){if(a==!0)this._exportable=!0,this._exportBtn.css("display","");else if(a==!1)this._exportable=!1,this._exportBtn.css("display","none");else return this._exportable};
ia.Panel.prototype.resizeable=function(a){if(a==!0)this._resizeable=!0,this._resizeBtn.css("display","");else if(a==!1)this._resizeable=!1,this._resizeBtn.css("display","none");else return this._resizeable};
ia.Panel.prototype.resizeFunction=function(a){a._isMaximized?(a._resizeBtn.addClass("ia-panel-resize-btn-maximize").removeClass("ia-panel-resize-btn-minimize"),a.restore()):(a._resizeBtn.addClass("ia-panel-resize-btn-minimize").removeClass("ia-panel-resize-btn-maximize"),a.maximize());a._isMaximized=!a._isMaximized};ia.Panel.prototype.append=function(a){this.content.append(a)};ia.Panel.prototype.appendToFooter=function(a){this.footer.append(a)};
ia.Panel.prototype.title=function(a){a!=void 0&&a!="undefined"&&a!=""?(this.header.css("display",""),this.header.html(a)):(this.header.css("display","none"),this.header.html(""));this._size()};ia.Panel.prototype.text=function(a){this.contentText.html(a);a==""?this.contentText.css("display","none"):this.contentText.css("display","inline")};
ia.Panel.prototype._size=function(){var a=this.container.height(),b=0;this.header.css("display")!="none"&&(b=this.header.outerHeight());footerHeight=this.footer.outerHeight();this.content.height(a-b-footerHeight)};ia.Button=function(a,b){ia.Button.baseConstructor.call(this,a);this.container=$j("<button type='button'>").addClass("ia-widget ia-button button").attr("id",a);b!=void 0&&this.text(b)};ia.extend(ia.Widget,ia.Button);ia.Button.prototype.text=function(a){this.container.html(a)};
ia.MenuButton=function(a,b){ia.MenuButton.baseConstructor.call(this,a,b);this.container.addClass("menuButton")};ia.extend(ia.Button,ia.MenuButton);ia.Text=function(a,b){ia.Text.baseConstructor.call(this,a);this.container=$j("<div>").addClass("ia-widget ia-text").attr("id",a);b!=void 0&&this.text(b)};ia.extend(ia.Widget,ia.Text);ia.Text.prototype.text=function(a){this.container.html(a)};
ia.Image=function(a,b){ia.Image.baseConstructor.call(this,a);this.container=$j("<img>").addClass("ia-widget ia-image").attr("id",a).attr("src",b)};ia.extend(ia.Widget,ia.Image);ia.Image.prototype.src=function(a){this.container.attr("src",a)};
ia.Dragger=function(){var a=0,b=0,c=0,d=0,e=0,f=0,g=!1,h=!1;this.container=$j("<div>").addClass("ia-dragger");$dragBusy=$j("<div>").addClass("ia-dragger-busy");$dragBusy.css("display","none");$j("body").append($dragBusy);var j=this;this.container.bind("mousemove",function(a){!g&&!h&&j._showCursor(a)});this.container.bind("mouseout",function(){!g&&!h&&(j.container.css({visibility:"hidden"}),ia.showDefaultCursor())});this.container.bind("mousedown",function(g){$dragBusy.css("display","inline");var m=
j.container.position();a=m.left;b=m.top;c=j.container.width();d=j.container.height();e=g.pageX;f=g.pageY;h=!0});$j("body").bind("mousemove",function(i){if(g||h){var m=j.container.css("border-left-width"),m=ia.parseInt(m.substring(0,m.indexOf("px"))),k=j.container.parent().width(),n=j.container.parent().height(),l=0.01*k,o=0.01*n,p=i.pageX-e,i=i.pageY-f;g?(p=a+p,i=b+i,p=Math.ceil(p/l)*l,i=Math.ceil(i/o)*o,j.container.css({left:p,top:i}),(void 0).setPosition((p+m)/k*100,(i+m)/n*100)):(p=a,i=b,m=c,k=
d,m=Math.max(m,20),k=Math.max(k,20),j.container.css({left:p,top:i,width:m,height:k}))}});$j("body").bind("mouseup",function(){if(g||h){$dragBusy.css("display","none");if(h){var a=j.container.css("border-left-width"),a=ia.parseInt(a.substring(0,a.indexOf("px"))),b=(void 0).container.css("border-left-width"),b=ia.parseInt(b.substring(0,b.indexOf("px"))),c=j.container.parent().width(),d=j.container.parent().height(),e=j.container.position().left+a,f=j.container.position().top+a,a=j.container.width()-
b*2,b=j.container.height()-b*2,e=e/c*100,f=f/d*100;(void 0).rescale?(void 0).setDimensions(e,f,a/c*100,b/d*100):(void 0).setDimensions(e,f,a,b)}h=g=!1}})};
ia.Dragger.prototype._showCursor=function(a){var b=a.pageX-this.container.offset().left,a=a.pageY-this.container.offset().top,c=this.container.outerWidth(!0),d=this.container.outerHeight(!0);cursor=b>15&&b<c-15&&a<15?"n-resize":b>c-15&&a<15?"ne-resize":b>c-15&&a>15&&a<d-15?"e-resize":b>c-15&&a>d-15?"se-resize":b>15&&b<c-15&&a>d-15?"s-resize":b<15&&a>d-15?"sw-resize":b<15&&a>15&&a<d-15?"w-resize":b<15&&a<15?"nw-resize":"move";ia.showCursor(cursor)};
ia.Dragger.prototype.attach=function(a){a.container.bind("mouseover",function(b){if(!dragging&&!resizing){this._showCursor(b);activeWidget=a;b=activeWidget.zIndex();b==void 0&&(b=activeWidget.container.css("z-index"));var c=this.container.css("border-left-width"),c=ia.parseInt(c.substring(0,c.indexOf("px"))),d=activeWidget.container.css("margin-left"),d=ia.parseInt(d.substring(0,d.indexOf("px"))),e=activeWidget.container.position(),d=e.left-c+d,c=e.top-c,e=activeWidget.container.outerWidth(),f=activeWidget.container.outerHeight();
this.container.css({left:d,top:c,width:e,height:f,"z-index":b,visibility:"visible"})}})};ia.Dragger.prototype.detach=function(){};ia.ScrollBox=function(a){this._touchScroll=void 0;this.isScrolling=!1;this.container=a;var b=this;this.container.resize(function(){b._resize()})};ia.ScrollBox.prototype._resize=function(){this._touchScroll!=null&&this._touchScroll.refresh()};ia.ScrollBox.prototype.scrollToElement=function(a){this._touchScroll!=null&&this._touchScroll.scrollToElement(a,300)};
ia.ScrollBox.prototype.refresh=function(){if(ia.IS_TOUCH_DEVICE){var a=this;if(a._touchScroll!=null)a._touchScroll.destroy(),a._touchScroll=null;a._touchScroll=new iScroll(a.container.attr("id"),{hideScrollbar:!0,scrollbarClass:"touchScrollbar",onScrollMove:function(){a.isScrolling=!0},onScrollEnd:function(){a.isScrolling=!1},onTouchEnd:function(){a.isScrolling=!1}})}};
ia.DataExplorer=function(a,b){this.id=a;this._data=void 0;this._treeId="";this.closeBranchesOnSelection=!0;this.container=$j("<div id='"+a+"' class='ia-explorer'>");this.$sb=$j("<div id='"+a+"-scrollbox' class='ia-explorer-scrollbox'>");this._scrollBox=new ia.ScrollBox(this.$sb);this.container.append(this.$sb);this.$sb.bind(ia.CLICK_TYPE,function(a){a.stopPropagation()});this.$tree=$j("<div class='ia-explorer-tree'>");this.$sb.append(this.$tree);if(b)this.callbackFunction=b;var c=this;this.container.resize(function(){c._size()})};
ia.DataExplorer.prototype.closeBranchesOnSelection=!1;ia.DataExplorer.prototype._size=function(){this.$sb.height(this.container.height());this.$sb.width(this.container.width())};ia.DataExplorer.prototype.data=function(a){if(a!=void 0)this._data=a;else return this._data};ia.DataExplorer.prototype.refresh=function(){this._treeId!=""&&this.build(this._treeId)};
ia.DataExplorer.prototype.build=function(a){this._treeId=a;if(this._treeId==void 0)this._treeId="topLevel";this.$tree.empty();for(var a=this._data[this._treeId],b=a.children.length,c=0;c<b;c++)this._buildItem(a.children[c],this.$tree);this._scrollBox.refresh()};
ia.DataExplorer.prototype._buildItem=function(a,b){var c=String(a).replace(/'/g,"#quote#").replace(/"/g,"#double-quote#"),d=this._data[a],e=$j("<div id='"+c+"' class='ia-explorer-item ia-list-item'>");b.append(e);c=$j("<div class='ia-explorer-label'>").html(d.label);e.append(c);var f=this;if(d.type=="branch"){e.addClass("ia-explorer-branch-icon");e.addClass("ia-explorer-branch");c=$j("<div class='ia-explorer-group'>");c.hide();b.append(c);e.data("childGroup",c);(function(){ia.IS_TOUCH_DEVICE?e.bind(ia.CLICK_TYPE,
function(a){f._scrollBox.isScrolling||(a.stopPropagation(),a.preventDefault(),f._toggleBranch(e))}):e.bind(ia.CLICK_TYPE,function(a){a.stopPropagation();f._toggleBranch(e)})})();for(var g=d.children.length,h=0;h<g;h++)f._buildItem(d.children[h],c)}else{e.addClass("ia-explorer-leaf");if(d.href!=void 0){var j=$j("<div class='ia-explorer-notes-icon'>");e.prepend(j);(function(){var a=d.href;ia.IS_TOUCH_DEVICE?j.bind(ia.CLICK_TYPE,function(b){f._scrollBox.isScrolling||(b.stopPropagation(),b.preventDefault(),
ia.callFunction(a,"_blank"))}):j.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();ia.callFunction(a,"_blank")})})()}(function(){ia.IS_TOUCH_DEVICE?e.bind(ia.CLICK_TYPE,function(a){f._scrollBox.isScrolling||(a.stopPropagation(),a.preventDefault(),f._selectLeaf(e))}):e.bind(ia.CLICK_TYPE,function(a){a.stopPropagation();f._selectLeaf(e)})})()}};ia.DataExplorer.prototype.clearSelection=function(){this.$tree.find(".ia-explorer-item").removeClass("ia-explorer-selected-item");this.isFilterExplorer&&this.$tree.find(".ia-explorer-leaf").removeClass("ia-filter-explorer-selected-item")};
ia.DataExplorer.prototype.showItem=function(a){var b=this.$tree.find("div[id='"+String(a).replace(/'/g,"#quote#").replace(/"/g,"#double-quote#")+"']");b&&(b.hasClass("ia-explorer-branch")?this._openBranch(b):b.hasClass("ia-explorer-leaf")&&(this.$tree.find(".ia-explorer-leaf").removeClass("ia-explorer-selected-item"),b.addClass("ia-explorer-selected-item")),this._data[a].parent&&this.showItem(this._data[a].parent))};
ia.DataExplorer.prototype._selectLeaf=function(a){var b=a.attr("id");this.$tree.find(".ia-explorer-item").removeClass("ia-explorer-selected-item");a.addClass("ia-explorer-selected-item");this.isFilterExplorer&&(a.hasClass("ia-filter-explorer-selected-item")?(b="clearFilter",a.removeClass("ia-filter-explorer-selected-item")):(this.$tree.find(".ia-explorer-leaf").removeClass("ia-filter-explorer-selected-item"),a.addClass("ia-filter-explorer-selected-item")));a=String(b).replace(/#quote#/g,"'").replace(/#double-quote#/g,
'"');this.callbackFunction&&this.callbackFunction.call(null,a)};ia.DataExplorer.prototype._toggleBranch=function(a){a.hasClass("ia-explorer-branch")&&(this.$tree.find(".ia-explorer-item").removeClass("ia-explorer-selected-item"),a.data("childGroup").is(":visible")?this._closeBranch(a):(a.addClass("ia-explorer-selected-item"),this._openBranch(a)))};
ia.DataExplorer.prototype._closeBranch=function(a){if(a.hasClass("ia-explorer-branch")){a.addClass("ia-explorer-branch-icon");a.removeClass("ia-explorer-branch-expanded-icon");var b=this;a.data("childGroup").slideUp("fast",function(){b._size()})}};
ia.DataExplorer.prototype._openBranch=function(a){if(a.hasClass("ia-explorer-branch")){this.closeBranchesOnSelection&&a.siblings(".ia-explorer-branch-expanded-icon").each(function(){$j(this).addClass("ia-explorer-branch-icon");$j(this).removeClass("ia-explorer-branch-expanded-icon");$j(this).data("childGroup").slideToggle("fast",function(){})});a.removeClass("ia-explorer-branch-icon");a.addClass("ia-explorer-branch-expanded-icon");var b=this;a.data("childGroup").slideDown("fast",function(){b._size()})}};
ia.Table=function(a){ia.Table.baseConstructor.call(this);this.id=a;this._sDirection=this._cId=this._data=void 0;this._selectedRows={};this._scrollTimeout=void 0;this._highlightRows={};this.allowUserSorting=this.showLegendColor=!0;this.container=$j("<div id='"+a+"' class='ia-table'>");this._containerId=a+"-";this._borderRadius=parseInt($j(".ia-panel").css("border-top-left-radius"))-1;if(this._borderRadius<0)this._borderRadius=0;this.$tableCorner=$j("<span class='ia-table-header-corner'>");this.$tableCorner.css("border-top-right-radius",
this._borderRadius+"px");this.container.append(this.$tableCorner);this.$tableHeaders=$j("<table>");this.container.append(this.$tableHeaders);this.$tableContainer=$j("<div id='"+a+"-container' class='ia-table-scrollbox'>");this._scrollBox=new ia.ScrollBox(this.$tableContainer);this.container.append(this.$tableContainer);this.$table=$j("<table>");this.$tableContainer.append(this.$table);this._addMouseEvents();var b,c=this;this.container.resize(function(){clearTimeout(b);b=setTimeout(function(){clearTimeout(b);
c._size()},500)})};ia.extend(ia.EventDispatcher,ia.Table);ia.Table.prototype._size=function(){var a=this.container.width(),b=this.$tableContainer.get(0).offsetWidth-this.$tableContainer.get(0).clientWidth;a-=b;this.$table.width(a);this.$tableHeaders.width(a);var a=this.container.height(),c=this.$tableHeaders.outerHeight();this.$tableContainer.height(a-c);this.$tableCorner.css("background-color",$j(".ia-table-header").css("background-color"));this.$tableCorner.width(b);this.$tableCorner.height(c)};
ia.Table.prototype.getData=function(){return this._data};ia.Table.prototype.setData=function(a){this._data=a};
ia.Table.prototype.render=function(){var a=this;this.$table.empty();this.$tableHeaders.empty();var b=$j("<thead>"),c=$j("<tr>");b.append(c);this.$tableHeaders.append(b);for(var d=!1,e,f=this.columns.length,g=0;g<f;g++){e=this.columns[g];var h=e.width*110,j=$j("<th id='"+e.id+"' class='ia-table-header' style='width:"+h+"%'>").html(e.label);j.data("type",e.type);e.label!=""&&(d=!0);g==0&&j.css("border-top-left-radius",this._borderRadius+"px");c.append(j);this.allowUserSorting&&function(){var b=e.id;
j.click(function(){var c="ascending";$j(this).is(".sort-asc")&&(c="descending");a.sort(b,c)})}()}d==!1&&b.css("display","none");var b=[],g=-1,d=0,i,m;b[++g]="<tbody>";for(rowId in this._data){c=this._data[rowId];d%2==0?b[++g]="<tr id='"+this._containerId+rowId+"' class='ia-table-row ia-table-row-even'>":b[++g]="<tr id='"+this._containerId+rowId+"' class='ia-table-row ia-table-row-odd'>";d++;var k=void 0,n=0;if(c.color&&this.showLegendColor)k=ia.Color.toRGBA(c.color,1),n=c.symbolSize;for(var l=0;l<
f;l++)e=this.columns[l],e.id.indexOf("~")!=-1?(h=e.id.split("~")[0],m=e.id.split("~")[1],i=this["data"+m][rowId][h],m=this["data"+m][rowId][h+"_formatted"]):(i=c[e.id],m=c[e.formattedId]),h=e.width*110,e.type=="categoric"?b[++g]="<td class='ia-table-cell ia-table-cell-categoric' data-value='"+m+"'  style='width:"+h+"%'>":b[++g]="<td class='ia-table-cell ia-table-cell-numeric' data-value='"+i+"'  style='width:"+h+"%'>",k&&e.id=="name"&&n>0&&(b[++g]="<span class='ia-table-legend-swatch' style='background-color:"+
k+";'></span>"),c.href&&e.id=="name"&&(b[++g]="<span id='"+c.href+"' class='ia-table-notes-icon'></span>"),b[++g]=m,b[++g]="</td>";b[++g]="</tr>"}b[++g]="</tbody>";this.$table.append(b.join(""));this._scrollBox.refresh();this._size();this._cId!=void 0&&this.sort(this._cId,this._sDirection);this.renderSelection()};
ia.Table.prototype.exportData=function(a){for(var b=this.columns.length,c=[],d=-1,e,f,g,h=0;h<b;h++){var j=this.columns[h];h>0&&(c[++d]=",");c[++d]='"'+j.label+'"'}c[++d]="\n";if(Object.keys(this._selectedRows).length>0)for(rowId in this._selectedRows){e=this._data[rowId];for(h=0;h<b;h++)j=this.columns[h],j.id.indexOf("~")!=-1?(g=j.id.split("~")[0],j=j.id.split("~")[1],f=this["data"+j][rowId][g],g=this["data"+j][rowId][g+"_formatted"]):(f=e[j.id],g=e[j.formattedId]),h>0&&(c[++d]=","),ia.isNumber(f)?
c[++d]=g:c[++d]='"'+g+'"';c[++d]="\n"}else for(rowId in this._data){e=this._data[rowId];for(h=0;h<b;h++)j=this.columns[h],j.id.indexOf("~")!=-1?(g=j.id.split("~")[0],j=j.id.split("~")[1],f=this["data"+j][rowId][g],g=this["data"+j][rowId][g+"_formatted"]):(f=e[j.id],g=e[j.formattedId]),h>0&&(c[++d]=","),ia.isNumber(f)?c[++d]=g:c[++d]='"'+g+'"';c[++d]="\n"}b=c.join("");a!=void 0?(a='<div style="font-family:Verdana;font-size:12px;color:#888888;">'+a+"</div>",a+='<p><textarea rows="25" cols="60">'+b+
"</textarea></p>"):a='<textarea rows="25" cols="60">'+b+"</textarea>";window.open().document.write(a)};ia.Table.prototype.renderSelection=function(){for(var a in this._selectedRows){var b=$j("[id='"+this._containerId+a+"']");b.addClass("ia-table-row-select");var c=ia.Color.adjustSV(this.selectionColor,30,100);b.css("background-color",c)}};
ia.Table.prototype._addMouseEvents=function(){var a=this;ia.IS_TOUCH_DEVICE?a.$table.delegate("tr","touchend",function(){if(!a._scrollBox.isScrolling){var b=$j(this).attr("id").substring(a._containerId.length);$j(this).hasClass("ia-table-row-select")?($j(this).removeClass("ia-table-row-select"),delete a._selectedRows[b],a._dispatchItemEvent(b,ia.ItemEvent.ITEM_CLICK,ia.ItemLayer.UNSELECTED),b=""):($j(this).addClass("ia-table-row-select"),a._selectedRows[b]=b,a._dispatchItemEvent(b,ia.ItemEvent.ITEM_CLICK,
ia.ItemLayer.SELECTED),b=ia.Color.adjustSV(a.selectionColor,30,100));$j(this).css("background-color",b)}}):(this.$table.delegate("tr","mouseover",function(){var b=$j(this).attr("id").substring(a._containerId.length);a._highlightRows[b]=$j(this);if($j(this).hasClass("ia-table-row-select")){$j(this).addClass("ia-table-row-highlight-select");var c=ia.Color.adjustSV(a.selectionColor,40,100)}else $j(this).addClass("ia-table-row-highlight"),c=ia.Color.adjustSV(a.highlightColor,20,100);$j(this).css("background-color",
c);a._dispatchItemEvent(b,ia.ItemEvent.ITEM_MOUSE_OVER,ia.ItemLayer.ROLLOVER)}),this.$table.delegate("tr","mouseout",function(){var b=$j(this).attr("id").substring(a._containerId.length);delete a._highlightRows[b];$j(this).removeClass("ia-table-row-highlight");$j(this).hasClass("ia-table-row-highlight-select")?($j(this).removeClass("ia-table-row-highlight-select").addClass("ia-table-row-select"),a._dispatchItemEvent(b,ia.ItemEvent.ITEM_MOUSE_OUT,ia.ItemLayer.SELECTED),b=ia.Color.adjustSV(a.selectionColor,
30,100)):(a._dispatchItemEvent(b,ia.ItemEvent.ITEM_MOUSE_OUT,ia.ItemLayer.UNSELECTED),b="");$j(this).css("background-color",b)}),this.$table.delegate("tr",ia.CLICK_TYPE,function(){var b=$j(this).attr("id").substring(a._containerId.length);$j(this).hasClass("ia-table-row-highlight-select")?($j(this).removeClass("ia-table-row-highlight-select").removeClass("ia-table-row-select").addClass("ia-table-row-highlight"),delete a._selectedRows[b],a._dispatchItemEvent(b,ia.ItemEvent.ITEM_CLICK,ia.ItemLayer.UNSELECTED),
b=ia.Color.adjustSV(a.highlightColor,20,100)):($j(this).removeClass("ia-table-row-highlight").addClass("ia-table-row-highlight-select"),a._selectedRows[b]=b,a._dispatchItemEvent(b,ia.ItemEvent.ITEM_CLICK,ia.ItemLayer.SELECTED),b=ia.Color.adjustSV(a.selectionColor,40,100));$j(this).css("background-color",b)}));this.$table.delegate("span.ia-table-notes-icon",ia.CLICK_TYPE,function(a){a.stopPropagation();a=$j(this).attr("id");window.open(a,"_blank")});this.$table.delegate("span.ia-table-notes-icon",
"mouseover touchstart",function(a){a.stopPropagation()})};
ia.Table.prototype.sort=function(a,b){var c=this._getColumnIndex(a);if(c!=-1){this._cId=a;this._sDirection=b;b!=void 0&&(b=b.toLowerCase());var d=1;b=="descending"&&(d=-1);var e=this.$tableHeaders.find("th:eq("+c+")");this.$tableHeaders.find("th").removeClass("sort-asc").removeClass("sort-desc");var f;d==1?(e.addClass("sort-asc"),f=Infinity):(e.addClass("sort-desc"),f=-Infinity);var g;g=e.data("type")=="categoric"?function(a){return a.toUpperCase()}:function(a){a=parseFloat(a);return isNaN(a)?f:a};
for(var e=[],h=this.$table.find("tbody > tr").get(),j,i=h.length,m=0;m<i;m++)j=$j(h[m].childNodes[c]).attr("data-value"),h[m].sortKey=g(j);c=Object.prototype.toString;Object.prototype.toString=function(){return this.key};h.sort(function(a,b){return a.sortKey<b.sortKey?-d:a.sortKey>b.sortKey?d:0});Object.prototype.toString=c;for(m=0;m<i;m++)e.push(h[m]),h[m].sortKey=null;this.$table.children("tbody").append(e);this.$table.find("tbody > tr.ia-table-row:odd").removeClass("ia-table-row-even").addClass("ia-table-row-odd");
this.$table.find("tbody > tr.ia-table-row:even").removeClass("ia-table-row-odd").addClass("ia-table-row-even")}};ia.Table.prototype.selectText=function(){var a=this.container.get(0),b=document.body;b.createTextRange?(b=b.createTextRange(),b.moveToElementText(a),b.select()):document.createRange&&window.getSelection&&(sel=window.getSelection(),sel.removeAllRanges(),b=document.createRange(),b.selectNodeContents(a),sel.addRange(b))};
ia.Table.prototype._dispatchItemEvent=function(a,b,c){var d={};d.id=a;d.state=c;d.parent=this;this.dispatchEvent(new ia.ItemEvent(b,d))};ia.Table.prototype._getColumnIndex=function(a){for(var b=-1,c=0;c<this.columns.length;c++)if(this.columns[c].id==a){b=c;break}return b};
ia.Table.prototype.select=function(a){var b=$j("tr[id='"+this._containerId+a+"']");b.addClass("ia-table-row-select");this._selectedRows[a]=a;a=ia.Color.adjustSV(this.selectionColor,30,100);b.css("background-color",a);clearTimeout(this._scrollTimeout);var c=this;this._scrollTimeout=setTimeout(function(){clearTimeout(c._scrollTimeout);c._scrollIntoView(b)},500)};
ia.Table.prototype._scrollIntoView=function(a){var b=a.get(0);if(b!=void 0)if(ia.IS_TOUCH_DEVICE)this._scrollBox.scrollToElement(b);else{var c=this.$tableContainer.scrollTop(),d=c+this.$tableContainer.height(),b=b.offsetTop;(b+a.height()>d||b<c)&&this.$tableContainer.scrollTop(b)}};ia.Table.prototype.unselect=function(a){var b=$j("tr[id='"+this._containerId+a+"']");b.removeClass("ia-table-row-select");delete this._selectedRows[a];b.css("background-color","")};ia.Table.prototype.clearSelection=function(){for(var a in this._selectedRows)this.unselect(a)};
ia.Table.prototype.highlight=function(a){var b=$j("tr[id='"+this._containerId+a+"']");if(b.hasClass("ia-table-row-select")){b.addClass("ia-table-row-highlight-select");var c=ia.Color.adjustSV(this.selectionColor,40,100)}else b.addClass("ia-table-row-highlight"),c=ia.Color.adjustSV(this.highlightColor,20,100);b.css("background-color",c);this._highlightRows[a]=b};
ia.Table.prototype.clearHighlight=function(){for(var a in this._highlightRows){var b=this._highlightRows[a];b.removeClass("ia-table-row-highlight").removeClass("ia-table-row-highlight-select");delete this._highlightRows[a];var c=b.hasClass("ia-table-row-select")?ia.Color.adjustSV(this.selectionColor,30,100):"";b.css("background-color",c)}};ia.ComparisonTable=function(a){ia.ComparisonTable.baseConstructor.call(this,a)};ia.extend(ia.Table,ia.ComparisonTable);
ia.ComparisonTable.prototype.clearSelection=function(){};ia.LayerList=function(a){ia.LayerList.baseConstructor.call(this);this.id=a;this.container=$j("<div id='"+a+"' class='ia-layer-list'>");this.$tableContainer=$j("<div id='"+a+"-container' class='ia-layer-list-scrollbox'>");this._scrollBox=new ia.ScrollBox(this.$tableContainer);this.container.append(this.$tableContainer);this.$tableList=$j("<table class='ia-layer-list-table'>");this.$tableContainer.append(this.$tableList);var b=this;this.container.resize(function(){b._size()})};
ia.extend(ia.EventDispatcher,ia.LayerList);ia.LayerList.prototype._size=function(){this.$tableContainer.height(this.container.height());this.$tableContainer.width(this.container.width())};
ia.LayerList.prototype.render=function(){this.$tableList.empty();if(this.mapData.baseLayer){this._buildLayerItem(this.mapData.baseLayer,!0);var a=$j("<tr>");this.$tableList.append(a);var b=$j("<td colspan='2' class='ia-layer-list-legend-td'>");a.append(b);var c=this;this.gradientLegend&&(b.append(this.gradientLegend.container),this.gradientLegend.container.resize(function(){c._size()}));if(this.discreteLegend)b.append(this.discreteLegend.container),this.discreteLegend.scrollBox=this._scrollBox,this.discreteLegend.container.resize(function(){c._size()})}for(a=
this.mapData.noneBaseLayers.length-1;a>=0;a--)this._buildLayerItem(this.mapData.noneBaseLayers[a]);this._scrollBox.refresh()};
ia.LayerList.prototype._buildLayerItem=function(a,b){if(a.showInLayerList){var c=this;a.addEventListener(ia.Event.LAYER_VISIBLE_CHANGED,this._layerEventHandler.bind(this));var d=$j("<tr id='"+this.id+"_"+a.id+"' class='ia-list-item'>");this.$tableList.append(d);if(!b&&a.geometry!="image"){var e=$j("<td class='ia-legend-item' style='text-align:center'>");d.append(e);if(a.iconPath!=""){var f=$j("<img>").attr("src",a.iconPath);e.append(f)}else{var g=a.style.lineWidth,f=a.symbolSize+g*2,g=a.symbolSize+
g*2,h=$j("<div class='ia-legend-symbol' style='width:"+f+";height:"+g+";'>");e.append(h);var j=document.createElement("canvas");j.width=f;j.height=g;h.append($j(j));this._drawSymbol(j,a)}}e=$j("<td style='width:100%' id='"+a.id+"' class='ia-layer-list-item ia-layer-list-item-unchecked'>");(b||a.geometry=="image")&&e.attr("colspan",2);e.html(a.name);d.append(e);a.getVisible()==!0&&e.addClass("ia-layer-list-item-checked");(function(){var b=e;d.bind(ia.CLICK_TYPE,function(d){c._scrollBox.isScrolling||
(d.preventDefault(),b.hasClass("ia-layer-list-item-checked")?(b.removeClass("ia-layer-list-item-checked"),a.setVisible(!1)):(b.addClass("ia-layer-list-item-checked"),a.setVisible(!0),a.isLoaded||a.loadSource()))})})()}};ia.LayerList.prototype.showLayer=function(a){this.$tableList.find("tr[id='"+this.id+"_"+a+"']").show()};ia.LayerList.prototype.hideLayer=function(a){this.$tableList.find("tr[id='"+this.id+"_"+a+"']").hide()};ia.LayerList.prototype.clickFunction=function(){};
ia.LayerList.prototype._drawSymbol=function(a,b){var c=a.getContext("2d"),d=b.style,e;for(e in d)c[e]=d[e];if(b.geometry=="line")c.beginPath(),ia.Shape.draw(ia.Shape.LINE,c,a.width/2,a.height/2,b.symbolSize);else{c.beginPath();d=ia.Shape.SQUARE;if(b.geometry=="point")d=ia.Shape.CIRCLE;ia.Shape.draw(d,c,a.width/2,a.height/2,b.symbolSize);c.fill()}c.stroke()};
ia.LayerList.prototype._layerEventHandler=function(a){if(a.type==ia.Event.LAYER_VISIBLE_CHANGED)a=a.object,a.getVisible()?this.$tableList.find("#"+a.id).addClass("ia-layer-list-item-checked"):this.$tableList.find("#"+a.id).removeClass("ia-layer-list-item-checked")};
ia.DiscreteLegend=function(a){ia.DiscreteLegend.baseConstructor.call(this);this.id=a;this.container=$j("<div id='"+a+"' class='ia-legend'>");this.$table=$j("<table class='ia-legend-table'>");this.container.append(this.$table);this.style={fillStyle:"#EFEFEF",strokeStyle:"#cccccc",lineWidth:"0.5",lineJoin:"miter"};this.interactive=this.isLegendComponent=!0;this.layout="vertical";this._touchStart=0};ia.extend(ia.EventDispatcher,ia.DiscreteLegend);ia.DiscreteLegend.prototype.render=function(){this.renderLegend(this.thematic.getClasses())};
ia.DiscreteLegend.prototype.renderNumeric=function(){this.renderLegend(this.thematic.numericClassifier.getClasses())};ia.DiscreteLegend.prototype.renderCategoric=function(){this.renderLegend(this.thematic.categoricClassifier.getClasses())};
ia.DiscreteLegend.prototype.renderLegend=function(a){this.$table.empty();var b;this.layout=="horizontal"&&(this.container.hasClass("ia-legend-horizontal")||this.container.addClass("ia-legend-horizontal"),this.$table.css("height","100%"),this.$table.css("width","auto"),this.container.css("width","auto"),b=$j("<tr>"),this.$table.append(b));for(var c=0;c<a.length;c++){var d=a[c];this.layout=="vertical"&&(b=$j("<tr>"),this.$table.append(b));d.size==0&&b.css("display","none");var e=$j("<td class='ia-legend-item'>");
b.append(e);var f=this.style.lineWidth,g=d.size+f*2;d.symbol==ia.Shape.LINE&&(g=30);var f=d.size+f*2,h=$j("<div class='ia-legend-symbol' style='width:"+g+";height:"+f+";'>");e.append(h);e=document.createElement("canvas");e.width=g;e.height=f;h.append($j(e));var g=e.getContext("2d"),j;for(j in this.style)g[j]=this.style[j];g.lineJoin="miter";g.fillStyle=d.color;d.symbol==ia.Shape.LINE?(g.strokeStyle=d.color,g.lineWidth=d.size,g.beginPath(),ia.Shape.draw(d.symbol,g,e.width/2,e.height/2,e.width)):(g.beginPath(),
ia.Shape.draw(d.symbol,g,e.width/2,e.height/2,d.size+0.5),g.fill());g.stroke();d=$j("<td class='ia-legend-item ia-legend-label'>").html(d.getLabel());this.layout=="horizontal"&&(d.css("white-space","nowrap"),d.css("width","auto"));b.append(d);this.interactive&&this._addMouseEvents(b)}};
ia.DiscreteLegend.prototype._addMouseEvents=function(a){var b=this;ia.IS_TOUCH_DEVICE||a.hover(function(){var a=b.$table.find("tbody > tr").index($j(this));if($j(this).hasClass("ia-legend-select")){$j(this).addClass("ia-legend-highlight-select");var d=ia.Color.adjustSV(b.selectionColor,40,100);b._dispatchItemEvent(a,ia.ItemEvent.ITEM_MOUSE_OVER,ia.ItemLayer.ROLLOVER_SELECTED)}else $j(this).addClass("ia-legend-highlight"),d=ia.Color.adjustSV(b.highlightColor,20,100),b._dispatchItemEvent(a,ia.ItemEvent.ITEM_MOUSE_OVER,
ia.ItemLayer.ROLLOVER);$j(this).css("background-color",d)},function(){var a=b.$table.find("tbody > tr").index($j(this));$j(this).removeClass("ia-legend-highlight");if($j(this).hasClass("ia-legend-highlight-select")){$j(this).removeClass("ia-legend-highlight-select");$j(this).addClass("ia-legend-select");var d=ia.Color.adjustSV(b.selectionColor,30,100);b._dispatchItemEvent(a,ia.ItemEvent.ITEM_MOUSE_OUT,ia.ItemLayer.SELECTED)}else d="",b._dispatchItemEvent(a,ia.ItemEvent.ITEM_MOUSE_OUT,ia.ItemLayer.UNSELECTED);
$j(this).css("background-color",d)});ia.IS_TOUCH_DEVICE&&a.bind("touchstart",function(){b._touchStart=(new Date).getTime()});a.bind(ia.CLICK_TYPE,function(){var a=b.$table.find("tbody > tr").index($j(this));ia.IS_TOUCH_DEVICE?(new Date).getTime()-b._touchStart<500&&b.scrollBox&&!b.scrollBox.isScrolling&&($j(this).hasClass("ia-legend-select")?($j(this).removeClass("ia-legend-select"),b._dispatchItemEvent(a,ia.ItemEvent.ITEM_CLICK,ia.ItemLayer.UNSELECTED),a=""):($j(this).addClass("ia-legend-select"),
b._dispatchItemEvent(a,ia.ItemEvent.ITEM_CLICK,ia.ItemLayer.SELECTED),a=ia.Color.adjustSV(b.selectionColor,40,100)),$j(this).css("background-color",a)):($j(this).hasClass("ia-legend-highlight-select")?($j(this).removeClass("ia-legend-highlight-select").removeClass("ia-legend-select").addClass("ia-legend-highlight"),b._dispatchItemEvent(a,ia.ItemEvent.ITEM_CLICK,ia.ItemLayer.UNSELECTED),a=ia.Color.adjustSV(b.highlightColor,20,100)):($j(this).removeClass("ia-legend-highlight").addClass("ia-legend-highlight-select"),
b._dispatchItemEvent(a,ia.ItemEvent.ITEM_CLICK,ia.ItemLayer.SELECTED),a=ia.Color.adjustSV(b.selectionColor,40,100)),$j(this).css("background-color",a))})};ia.DiscreteLegend.prototype._dispatchItemEvent=function(a,b,c){var d={};d.id=a;d.parent=this;d.state=c;d.legendClass=this.thematic.getClasses()[a];this.dispatchEvent(new ia.ItemEvent(b,d))};
ia.DiscreteLegend.prototype.select=function(a){a=this.$table.find("tr:eq("+a+")");a!=void 0&&(a.removeClass("ia-legend-highlight").addClass("ia-legend-select"),a.css("background-color",ia.Color.adjustSV(this.selectionColor,40,100)))};ia.DiscreteLegend.prototype.unselect=function(a){a=this.$table.find("tr:eq("+a+")");a!=void 0&&(a.removeClass("ia-legend-highlight-select").removeClass("ia-legend-select").addClass("ia-legend-highlight"),a.css("background-color",""))};
ia.DiscreteLegend.prototype.clearSelection=function(){this.$table.find("tbody > tr").removeClass("ia-legend-select").css("background-color","")};ia.DiscreteLegend.prototype.highlight=function(a){a=this.$table.find("tr:eq("+a+")");if(a.hasClass("ia-legend-select")){a.addClass("ia-legend-highlight-select");var b=ia.Color.adjustSV(this.selectionColor,40,100)}else a.addClass("ia-legend-highlight"),b=ia.Color.adjustSV(this.highlightColor,20,100);a.css("background-color",b)};
ia.DiscreteLegend.prototype.clearHighlight=function(){var a=this.$table.find("tbody > tr");a.removeClass("ia-legend-highlight").removeClass("ia-legend-highlight-select");var b=this;a.each(function(){var a=$j(this).hasClass("ia-legend-select")?ia.Color.adjustSV(b.selectionColor,30,100):"";$j(this).css("background-color",a)})};ia.DiscreteLegend.prototype.hide=function(){this.container.css("display","none")};ia.DiscreteLegend.prototype.show=function(){this.container.css("display","inline")};
ia.GradientLegend=function(a){ia.GradientLegend.baseConstructor.call(this);this.id=a;this._context=this._canvas=this._maxLabel=this._minLabel=this._maxValue=this._minValue=void 0;this.container=$j("<div id='"+a+"' class='ia-legend'>");this.$table=$j("<table>");this.container.append(this.$table);this.style={fillStyle:"#EFEFEF",strokeStyle:"#cccccc",lineWidth:"1",lineJoin:"miter"}};ia.extend(ia.EventDispatcher,ia.GradientLegend);
ia.GradientLegend.prototype.render=function(){if(this.thematic.symbol==ia.Shape.SQUARE||this.thematic.symbol==ia.Shape.LINE)this._build(20,120),this._renderBlock();else{var a=Math.max(this.thematic.numericClassifier.sizePalette.minSize,this.thematic.numericClassifier.sizePalette.maxSize);this._build(a+10,a+10);this._renderPoint()}};
ia.GradientLegend.prototype._build=function(a,b){this.$table.empty();var c=this.thematic.numericClassifier.getBreaks();this._minValue=c[0];this._maxValue=c[c.length-1];var d;this.thematic.numericClassifier.sizePalette.maxSize>=this.thematic.numericClassifier.sizePalette.minSize?(c=this.thematic.numericClassifier.formatter.format(this._minValue),d=this.thematic.numericClassifier.formatter.format(this._maxValue)):(c=this.thematic.numericClassifier.formatter.format(this._maxValue),d=this.thematic.numericClassifier.formatter.format(this._minValue));
var e=$j("<tr>");this._maxLabel=$j("<td class='ia-legend-item ia-legend-label ia-gradient-legend-label'>");this._maxLabel.html(d);e.append(this._maxLabel);this.$table.append(e);e=$j("<tr>");d=$j("<td class='ia-legend-item'>");e.append(d);this.$table.append(e);e=$j("<div class='ia-legend-symbol' style='width:"+a+";height:"+b+";'>");d.append(e);this._canvas=document.createElement("canvas");this._canvas.width=a;this._canvas.height=b;e.append($j(this._canvas));this._context=this._canvas.getContext("2d");
e=$j("<tr>");this._minLabel=$j("<td class='ia-legend-item ia-legend-label ia-gradient-legend-label'>");this._minLabel.html(c);e.append(this._minLabel);this.$table.append(e)};
ia.GradientLegend.prototype._renderBlock=function(){if(this._context){this._context.clearRect(0,0,this._canvas.width,this._canvas.height);this._context.strokeStyle=this.style.strokeStyle;this._context.lineWidth=this.style.lineWidth;var a=this.thematic.numericClassifier.colorPalette.getColorList();this._context.beginPath();ia.Shape.drawGradient(this._canvas,a,"bottomToTop");this._context.fill();this._context.stroke()}};
ia.GradientLegend.prototype._renderPoint=function(){if(this._context){this._context.clearRect(0,0,this._canvas.width,this._canvas.height);var a=Math.min(this.thematic.numericClassifier.sizePalette.minSize,this.thematic.numericClassifier.sizePalette.maxSize),b=Math.max(this.thematic.numericClassifier.sizePalette.minSize,this.thematic.numericClassifier.sizePalette.maxSize),c=this._canvas.width/2,d=this._canvas.height/2;this._context.strokeStyle=this.style.strokeStyle;this._context.lineWidth=this.style.lineWidth;
this._context.beginPath();ia.Shape.draw(this.thematic.symbol,this._context,c,d,a);this._context.stroke();this._context.beginPath();ia.Shape.draw(this.thematic.symbol,this._context,c,d,b);this._context.stroke()}};ia.GradientLegend.prototype.highlight=function(a){if(this._context&&this.thematic&&(a=this.thematic.getData()[a]))a=a.legendClass.value,this.thematic.symbol==ia.Shape.SQUARE||this.thematic.symbol==ia.Shape.LINE?this._highlightBlock(a):this._highlightPoint(a)};
ia.GradientLegend.prototype._highlightBlock=function(a){this._renderBlock();if(ia.isNumber(a))this._context.strokeStyle=this.highlightColor,this._context.lineWidth=3,a=this._canvas.height-(a-this._minValue)/(this._maxValue-this._minValue)*this._canvas.height,this._context.beginPath(),this._context.moveTo(1,a),this._context.lineTo(this._canvas.width-1,a),this._context.stroke()};
ia.GradientLegend.prototype._highlightPoint=function(a){this._renderPoint();if(ia.isNumber(a)&&(a=this.thematic.getClass(a),a!=void 0)){var b=this._canvas.width/2,c=this._canvas.height/2;this._context.fillStyle=a.color;this._context.beginPath();ia.Shape.draw(this.thematic.symbol,this._context,b,c,a.size);this._context.fill()}};ia.GradientLegend.prototype.clearHighlight=function(){this.thematic.symbol==ia.Shape.SQUARE||this.thematic.symbol==ia.Shape.LINE?this._renderBlock():this._renderPoint()};
ia.GradientLegend.prototype.select=function(){};ia.GradientLegend.prototype.unselect=function(){};ia.GradientLegend.prototype.clearSelection=function(){};ia.GradientLegend.prototype.hide=function(){this.container.css("display","none")};ia.GradientLegend.prototype.show=function(){this.container.css("display","inline")};
ia.Metadata=function(a){this.container=$j("<div id='"+a+"' class='ia-metadata-scrollbox'>");this._scrollBox=new ia.ScrollBox(this.container);this._textBox=$j("<div class='ia-metadata'>");this.container.append(this._textBox)};ia.Metadata.prototype.setHtml=function(a){if(a!=void 0)if(a.indexOf(".htm")!=-1&&a.indexOf("href=")==-1){var b=this;this._textBox.load(a,function(){b._scrollBox.refresh()})}else this._textBox.html(a),this._scrollBox.refresh()};
ia.HTMLContainer=function(a){this.container=$j("<div id='"+a+"'>")};ia.HTMLContainer.prototype.setHtml=function(a){a!=void 0&&(a.indexOf(".htm")!=-1&&a.indexOf("href=")==-1?this.container.load(a,function(){}):this.container.html(a))};
ia.LegendEditor=function(a,b,c){var d=this;this.showSizePanel=this.showPalettePanel=this.showLegendTools=this.showLegendTypePanel=!0;this._updateTimeout=void 0;this._isVisible=this._lockEditor=!1;this._thematic=a;this._thematic.addEventListener(ia.Event.THEME_CHANGED,function(){d._render()});this._reportConfig=b;this._settings=c;this.container=$j('<div class="ia-editor"></div>');$j("body").bind(ia.CLICK_TYPE,function(){d.hide()});this.container.bind(ia.CLICK_TYPE,function(a){a.stopPropagation()})};
ia.LegendEditor.prototype._render=function(){var a=this;this.container.empty();var b=$j("<div>");this.container.append(b);var c=this._thematic.numericClassifier,d=this._thematic.categoricClassifier,e=this._reportConfig.getMapPalette();if(this._thematic.getDataType()==ia.Thematic.CATEGORIC){if(this.showPalettePanel){var f=$j("<table class='ia-editor-panel ia-editor-palette-panel'>");b.append(f);var g=$j("<tr>");f.append(g);var h=$j("<td>");g.append(h);var j=$j("<table class='ia-editor-color-panel'>");
h.append(j);f=$j("<tr>");j.append(f);for(var j=e.getColorSchemes(),i=0;i<j.length;i++){var m=j[i],h=$j("<td class='ia-list-item'>");f.append(h);(function(){var b=m;h.bind(ia.CLICK_TYPE,function(){d.colorPalette=b;a._settings.schemeId=b.id;a._updateTheme()})})();for(var k=m.getColorList(),n=0;n<k.length;n++){var l=k[n],o=$j("<div class='ia-editor-color-panel-discrete-swatch'>");m.id==d.colorPalette.id&&o.addClass("ia-editor-swatch-selected");o.css({"background-color":l});h.append(o)}}}if(this._thematic.symbol!=
ia.Shape.SQUARE&&this.showSizePanel){this.showPalettePanel&&(f=$j("<div class='ia-editor-separator'>"),b.append(f));var p=5,r=5;this._thematic.symbol==ia.Shape.LINE&&(r=p=1);var s=d.symbolSize,k=$j("<table class='ia-editor-panel ia-editor-size-panel'>");b.append(k);f=$j("<tr>");k.append(f);h=$j("<td class='ia-list-item' style='width:50px'>").html("-");f.append(h);h.bind(ia.CLICK_TYPE,function(){var b=s-p;b<r&&(b=r);d.symbolSize=b;a._updateTheme()});h=$j("<td style='padding:5px'>");f.append(h);k=document.createElement("canvas");
k.width=s+2;if(this._thematic.symbol==ia.Shape.LINE)k.width=100;k.height=s+2;h.append($j(k));n=k.getContext("2d");this._thematic.symbol==ia.Shape.LINE?(n.strokeStyle="#cccccc",n.lineWidth=s,n.beginPath(),ia.Shape.draw(this._thematic.symbol,n,k.width/2,k.height/2,k.width)):(n.strokeStyle="#cccccc",n.fillStyle="#f9f9f9",n.lineWidth=1,n.beginPath(),ia.Shape.draw(this._thematic.symbol,n,k.width/2,k.height/2,s),n.fill());n.stroke();h=$j("<td class='ia-list-item' style='width:50px'>").html("+");f.append(h);
h.bind(ia.CLICK_TYPE,function(){d.symbolSize=s+p;a._updateTheme()})}}else{k=c.classificationName;if(k!="customClassifier"&&(j=$j("<table class='ia-editor-panel ia-editor-classifier-panel'>"),b.append(j),f=$j("<tr>"),j.append(f),this.showLegendTypePanel)){g=[ia.Thematic.QUANTILE,ia.Thematic.EQUAL_INTERVAL,ia.Thematic.NATURAL,ia.Thematic.CONTINUOUS,ia.Thematic.STANDARD_DEVIATION];j=[this._reportConfig.getProperty("quantile"),this._reportConfig.getProperty("equalInterval"),this._reportConfig.getProperty("natural"),
this._reportConfig.getProperty("continuous"),this._reportConfig.getProperty("standardDeviation")];n=j[g.indexOf(k)];for(i=0;i<g.length;i++){var w=g[i],q=j[i],h=$j("<td class='ia-list-item'>").html(q);q==n&&h.addClass("ia-editor-classifier-selected");f.append(h);(function(){var b=w;h.bind(ia.CLICK_TYPE,function(){a._typeMenuOpen=!1;c.classificationName=b;a._settings.legendType=b;a._updateTheme()})})()}}if(k!=ia.Thematic.CONTINUOUS){if(k!="customClassifier"&&this.showPalettePanel){this.showLegendTypePanel&&
(f=$j("<div class='ia-editor-separator'>"),b.append(f));f=$j("<table class='ia-editor-panel ia-editor-palette-panel'>");b.append(f);g=$j("<tr>");f.append(g);h=$j("<td>");g.append(h);j=$j("<table class='ia-editor-color-panel'>");h.append(j);f=$j("<tr>");j.append(f);j=e.getColorPalettes();for(i=0;i<j.length;i++){m=j[i];h=$j("<td class='ia-list-item'>");m.id==c.colorPalette.id&&h.addClass("ia-editor-selected");f.append(h);(function(){var b=m;h.bind(ia.CLICK_TYPE,function(){c.colorPalette=b;a._settings.paletteId=
b.id;a._updateTheme()})})();n=c.noClasses;k==ia.Thematic.STANDARD_DEVIATION&&(n=6);q=m.getInterpolatedColors(n);for(n=0;n<q.length;n++)l=q[n],o=$j("<div class='ia-editor-color-panel-discrete-swatch'>"),m.id==c.colorPalette.id&&o.addClass("ia-editor-swatch-selected"),o.css({"background-color":l}),h.append(o)}this.showLegendTools&&(h=$j("<td>"),g.append(h),j=$j("<table class='ia-editor-tool-panel'>"),h.append(j),f=$j("<tr>"),j.append(f),h=$j("<td class='ia-list-item'>").html("&uArr;&dArr;"),f.append(h),
h.bind(ia.CLICK_TYPE,function(){c.colorPalette.getColorList().reverse();a._updateTheme()}),k!=ia.Thematic.STANDARD_DEVIATION&&(f=$j("<tr>"),j.append(f),h=$j("<td class='ia-list-item'>").html("-"),f.append(h),h.bind(ia.CLICK_TYPE,function(){c.noClasses>e.minNoClasses&&(c.noClasses--,a._updateTheme())}),f=$j("<tr>"),j.append(f),h=$j("<td class='ia-list-item'>").html("+"),f.append(h),h.bind(ia.CLICK_TYPE,function(){c.noClasses<e.maxNoClasses&&(a._thematic.numericClassifier.noClasses++,a._updateTheme())})))}}else if(this.showPalettePanel){this.showLegendTypePanel&&
(f=$j("<div class='ia-editor-separator'>"),b.append(f));f=$j("<table class='ia-editor-panel ia-editor-palette-panel'>");b.append(f);g=$j("<tr>");f.append(g);h=$j("<td>");g.append(h);j=$j("<table class='ia-editor-color-panel'>");h.append(j);f=$j("<tr>");j.append(f);j=e.getColorPalettes();for(i=0;i<j.length;i++)m=j[i],h=$j("<td class='ia-list-item'>"),f.append(h),function(){var b=m;h.bind(ia.CLICK_TYPE,function(){c.colorPalette=b;a._settings.paletteId=b.id;a._updateTheme()})}(),q=m.getColorList(),k=
document.createElement("canvas"),$j(k).addClass("ia-editor-color-panel-continuous-swatch"),m.id==c.colorPalette.id&&$j(k).addClass("ia-editor-swatch-selected"),h.append($j(k)),n=k.getContext("2d"),n.beginPath(),ia.Shape.drawGradient(k,q,"bottomToTop"),n.fill();this.showLegendTools&&(h=$j("<td>"),g.append(h),j=$j("<table class='ia-editor-tool-panel'>"),h.append(j),f=$j("<tr>"),j.append(f),h=$j("<td class='ia-list-item'>").html("&uArr;&dArr;"),f.append(h),h.bind(ia.CLICK_TYPE,function(){c.colorPalette.getColorList().reverse();
a._updateTheme()}))}if(this._thematic.symbol!=ia.Shape.SQUARE&&this.showSizePanel){if(this.showPalettePanel||this.showLegendTypePanel)f=$j("<div class='ia-editor-separator'>"),b.append(f);r=p=5;this._thematic.symbol==ia.Shape.LINE&&(r=p=1);var t=c.sizePalette,k=c.colorPalette.getColorList(),i=k[0],g=k[k.length-1],k=$j("<table class='ia-editor-panel ia-editor-size-panel'>");b.append(k);b=$j("<tr>");k.append(b);h=$j("<td style='vertical-align:top;width:50px;padding:0px'>");b.append(h);j=$j("<table style='width:100%'>");
h.append(j);f=$j("<tr>");j.append(f);h=$j("<td class='ia-list-item'>").html("-");f.append(h);h.bind(ia.CLICK_TYPE,function(){var b=t.minSize-p;b<r&&(b=r);t.minSize=b;a._updateTheme()});f=$j("<tr>");j.append(f);h=$j("<td class='ia-list-item'>").html("+");f.append(h);h.bind(ia.CLICK_TYPE,function(){t.minSize+=p;a._updateTheme()});h=$j("<td style='padding:5px'>");b.append(h);f=Math.max(t.minSize,t.maxSize)+2;k=document.createElement("canvas");k.width=f;if(this._thematic.symbol==ia.Shape.LINE)k.width=
100;k.height=f;h.append($j(k));n=k.getContext("2d");this._thematic.symbol==ia.Shape.LINE?(n.strokeStyle=i,n.lineWidth=t.minSize,n.beginPath(),ia.Shape.draw(this._thematic.symbol,n,k.width/2,k.height/2,k.width)):(n.strokeStyle="#cccccc",n.fillStyle=i,n.lineWidth=1,n.beginPath(),ia.Shape.draw(this._thematic.symbol,n,k.width/2,k.height/2,t.minSize),n.fill());n.stroke();h=$j("<td style='padding:5px'>");b.append(h);k=document.createElement("canvas");k.width=f;if(this._thematic.symbol==ia.Shape.LINE)k.width=
100;k.height=f;h.append($j(k));n=k.getContext("2d");this._thematic.symbol==ia.Shape.LINE?(n.strokeStyle=g,n.lineWidth=t.maxSize,n.beginPath(),ia.Shape.draw(this._thematic.symbol,n,k.width/2,k.height/2,k.width)):(n.strokeStyle="#cccccc",n.fillStyle=g,n.lineWidth=1,n.beginPath(),ia.Shape.draw(this._thematic.symbol,n,k.width/2,k.height/2,t.maxSize),n.fill());n.stroke();h=$j("<td style='vertical-align:top;width:50px;padding:0px'>");b.append(h);j=$j("<table style='width:100%'>");h.append(j);f=$j("<tr>");
j.append(f);h=$j("<td class='ia-list-item'>").html("-");f.append(h);h.bind(ia.CLICK_TYPE,function(){var b=t.maxSize-p;b<r&&(b=r);t.maxSize=b;a._updateTheme()});f=$j("<tr>");j.append(f);h=$j("<td class='ia-list-item'>").html("+");f.append(h);h.bind(ia.CLICK_TYPE,function(){t.maxSize+=p;a._updateTheme()})}}this._lockEditor=!1};
ia.LegendEditor.prototype._updateTheme=function(){if(!this._lockEditor){var a=this;clearTimeout(this._updateTimeout);this._updateTimeout=setTimeout(function(){a._lockEditor=!0;a._thematic.commitChanges()},100)}};ia.LegendEditor.prototype.toggle=function(){this._isVisible?this.hide():this.show()};ia.LegendEditor.prototype.hide=function(){this._isVisible&&this.container.animate({opacity:0},function(){this.container.css({visibility:"hidden"});this._isVisible=!1})};
ia.LegendEditor.prototype.show=function(){this._isVisible||this.container.css({visibility:"visible"}).animate({opacity:1},function(){this._isVisible=!0})};
ia.MapTools=function(a,b,c,d){this._filterBtn=this._clearBtn=void 0;this._map=a;this._useGoogleMaps=c;this._includeSearchTool=d;this._iGroup=b;this._searching=!1;this._marker=new Image;this._marker.src="./map_tool_search.png";this._iGroup.addEventListener(ia.InteractionEvent.SELECTION_CHANGED,this._interactionEventHandler.bind(this));this.container=$j('<div class="ia-map-toolbar"></div>')};ia.MapTools.prototype.filterFunction=function(){};
ia.MapTools.prototype.searchFunction=function(a,b){var c=this._map.controller.defaultBBox,c='{"xmin":'+c.getXMin()+',"ymin":'+c.getXMin()+',"xmax":'+c.getXMax()+',"ymax":'+c.getYMax()+',"spatialReference":{"wkid":102100}}';ia.File.load("http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/find?text="+a+"&outSR=102100&bbox="+c+"&maxLocations=4&f=json","json",function(a){var c=[];if(a.locations!=void 0)for(var a=a.locations,f=0;f<a.length;f++){var g=a[f],h={};h.name=g.name;h.location=
g.feature.geometry;h.bounds=g.extent;c[c.length]=h}b.call(null,c)})};
ia.MapTools.prototype._interactionEventHandler=function(){this._iGroup.getSelection().length>0?(this._clearBtn&&this._clearBtn.removeClass("ia-cross-btn-disabled ia-toolbar-text-btn-disabled").addClass("ia-list-item ia-cross-btn"),this._filterBtn&&this._filterBtn.removeClass("ia-cross-btn ia-toolbar-text-btn-disabled").addClass("ia-list-item ia-cross-btn-disabled")):(this._clearBtn&&this._clearBtn.removeClass("ia-list-item ia-cross-btn").addClass("ia-cross-btn-disabled ia-toolbar-text-btn-disabled"),this._filterBtn&&
(this._iGroup.filteredFeatures.length>0?this._filterBtn.removeClass("ia-cross-btn-disabled ia-toolbar-text-btn-disabled").addClass("ia-list-item ia-cross-btn"):this._filterBtn.removeClass("ia-list-item ia-cross-btn").addClass("ia-cross-btn-disabled ia-toolbar-text-btn-disabled")))};
ia.MapTools.prototype.render=function(){this.container.empty();var a=this;if(ia.IS_TOUCH_DEVICE){var b;this.container.bind("touchstart",function(){a.container.stop();a.container.css({visibility:"visible"}).animate({opacity:1});clearTimeout(b);b=setTimeout(function(){clearTimeout(b);a.container.stop();a._searching||a.container.animate({opacity:0},function(){a.container.css({visibility:"hidden"})})},5E3)});this._map.container.bind("touchstart",function(){a._searching=!1;a.container.stop();a.container.css({visibility:"visible"}).animate({opacity:1});
clearTimeout(b);b=setTimeout(function(){clearTimeout(b);a.container.stop();a._searching||a.container.animate({opacity:0},function(){a.container.css({visibility:"hidden"})})},5E3)})}else{var c=!1;this._map.container.mouseenter(function(){c||(a.container.stop(),a.container.css({visibility:"visible"}).animate({opacity:1}))});this._map.container.mouseleave(function(){a.container.stop();a.container.animate({opacity:0},function(){a.container.css({visibility:"hidden"})});c=!1});this.container.mouseenter(function(){c=
!0;a.container.stop();a.container.animate({opacity:1})});this.container.mouseleave(function(){c=!1;a.container.stop();a.container.animate({opacity:1})})}var d=$j('<div class="ia-toolbar-btn ia-list-item ia-zoomfull-btn"></div>');this.container.append(d);d.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a._map.controller.zoomFull()});d=$j('<div class="ia-toolbar-btn ia-list-item ia-zoomout-btn"></div>');this.container.append(d);d.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();
b.preventDefault();a._useGoogleMaps?a._map.gMap.setZoom(a._map.gMap.getZoom()-1):a._map.controller.zoomOut()});d=$j('<div class="ia-toolbar-btn ia-list-item ia-zoomin-btn"></div>');this.container.append(d);d.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a._useGoogleMaps?a._map.gMap.setZoom(a._map.gMap.getZoom()+1):a._map.controller.zoomIn()});var e;this._includeSearchTool&&(e=$j('<div class="ia-toolbar-btn ia-list-item ia-search-btn"></div>'),a.container.append(e));if(this.clearButtonText)a._clearBtn=
$j("<div class='ia-toolbar-text-btn ia-list-item ia-toolbar-text-btn-disabled ia-cross-btn-disabled'>").html(a.clearButtonText),a.container.append(a._clearBtn),a._clearBtn.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a._iGroup.clearSelection()});if(this.filterButtonText)this._filterBtn=$j("<div class='ia-toolbar-text-btn ia-list-item ia-toolbar-text-btn-disabled ia-cross-btn-disabled'>").html(this.filterButtonText),this.container.append(this._filterBtn),this._filterBtn.bind(ia.CLICK_TYPE,
function(b){b.stopPropagation();b.preventDefault();a._iGroup.filteredFeatures=a._iGroup.getSelection().length>0?a._iGroup.getSelection().concat():[];a.filterFunction()});if(this._includeSearchTool)if(this._useGoogleMaps){var f=$j("<div id='ia-search-holder-"+this._map.id+"' class='ui-widget'>"),g=$j("<input id='ia-search-"+this._map.id+"' class='ia-search-input'>");f.append(g);this.container.append(f);f.hide();var h=!0,j=new google.maps.Geocoder,i;e.bind(ia.CLICK_TYPE,function(b){a._searching=!0;
b.stopPropagation();b.preventDefault();f.toggle();h&&(h=!1,g.autocomplete({source:function(b,c){j.geocode({address:b.term,bounds:a._map.defaultBounds},function(b,d){if(d==google.maps.GeocoderStatus.OK){var e=[],f;for(f in b){var g=b[f];g.geometry.bounds&&a._map.defaultBounds.intersects(g.geometry.bounds)&&(e[e.length]=b[f])}c($j.map(e,function(a){return{label:a.formatted_address,value:a.formatted_address,location:a.geometry.location,bounds:a.geometry.bounds}}))}})},minLength:2,select:function(b,c){a._map.gMap.fitBounds(c.item.bounds);
i&&i.setMap(null);i=new google.maps.Marker({map:a._map.gMap,position:c.item.location});f.toggle()},open:function(){},close:function(){},appendTo:"#ia-search-holder-"+a._map.id+""}));g.focus();g.val([]);g.autocomplete("close")})}else f=$j("<div id='ia-search-holder-"+this._map.id+"' class='ui-widget'>"),g=$j("<input id='ia-search-"+this._map.id+"' class='ia-search-input'>"),f.append(g),this.container.append(f),f.hide(),h=!0,e.bind(ia.CLICK_TYPE,function(b){a._searching=!0;a._map.markerLayer.clearMarkers();
b.stopPropagation();b.preventDefault();f.toggle();h&&(h=!1,g.autocomplete({source:function(b,c){a.searchFunction(b.term,function(a){c($j.map(a,function(a){return{label:a.name,value:a.name,location:a.location,bounds:a.bounds}}))})},minLength:2,select:function(b,c){var d=c.item.bounds,e=c.item.location;d!=void 0?a._map.controller.zoomToBBox(new ia.BoundingBox(d.xmin,d.ymin,d.xmax,d.ymax)):e!=void 0&&a._map.controller.centerOnCoords(e.x,e.y);e!=void 0&&(a._map.markerLayer.clearMarkers(),a._map.markerLayer.addMarker(a._marker,
e.x,e.y),a._map.markerLayer.render());f.toggle();a.container.animate({opacity:0},function(){a.container.css({visibility:"hidden"})})},open:function(){},close:function(){},appendTo:"#ia-search-holder-"+a._map.id+""}));g.focus();g.val([]);g.autocomplete("close")})};
ia.TableTools=function(a,b){this._table=a;this._filterBtn=this._clearBtn=void 0;this._borderRadius=0;this._iGroup=b;this._iGroup.addEventListener(ia.InteractionEvent.SELECTION_CHANGED,this._interactionEventHandler.bind(this));this._borderRadius=parseInt($j(".ia-panel").css("border-top-left-radius"))-1;if(this._borderRadius<0)this._borderRadius=0;this.container=$j('<div class="ia-table-toolbar"></div>');this.container.css("border-bottom-left-radius",this._borderRadius+"px");this.container.css("border-bottom-right-radius",
this._borderRadius+"px")};ia.TableTools.prototype.filterFunction=function(){};
ia.TableTools.prototype._interactionEventHandler=function(){this._iGroup.getSelection().length>0?(this._clearBtn&&this._clearBtn.removeClass("ia-cross-btn-disabled ia-toolbar-text-btn-disabled").addClass("ia-list-item ia-cross-btn"),this._filterBtn&&this._filterBtn.removeClass("ia-cross-btn ia-toolbar-text-btn-disabled").addClass("ia-list-item ia-cross-btn-disabled"),this._table.getData()):(this._clearBtn&&this._clearBtn.removeClass("ia-list-item ia-cross-btn").addClass("ia-cross-btn-disabled ia-toolbar-text-btn-disabled"),this._filterBtn&&
(this._iGroup.filteredFeatures.length>0?this._filterBtn.removeClass("ia-cross-btn-disabled ia-toolbar-text-btn-disabled").addClass("ia-list-item ia-cross-btn"):this._filterBtn.removeClass("ia-list-item ia-cross-btn").addClass("ia-cross-btn-disabled ia-toolbar-text-btn-disabled")))};
ia.TableTools.prototype.render=function(){this.container.empty();var a=this;if(this.clearButtonText)this._clearBtn=$j("<div class='ia-toolbar-text-btn ia-list-item ia-toolbar-text-btn-disabled ia-cross-btn-disabled'>").html(this.clearButtonText),this.container.append(this._clearBtn),this._clearBtn.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a._iGroup.clearSelection()}),this._clearBtn.css("border-radius",this._borderRadius+"px");if(this.filterButtonText)this._filterBtn=$j("<div class='ia-toolbar-text-btn ia-list-item ia-toolbar-text-btn-disabled ia-cross-btn-disabled'>").html(this.filterButtonText),
this.container.append(this._filterBtn),this._filterBtn.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();b.preventDefault();a._iGroup.filteredFeatures=a._iGroup.getSelection().length>0?a._iGroup.getSelection().concat():[];a.filterFunction()}),this._filterBtn.css("border-radius",this._borderRadius+"px")};
ia.AdvancedPieComponent=function(a,b){ia.AdvancedPieComponent.baseConstructor.call(this);this.id=a;this.tip="";this._layout=b;this._chartTitle1="";this._layer1=this._chart1=void 0;this._chartTitle2="";this._legend=this._layer2=this._chart2=void 0;this._selectionIds=[];this._scrollContainer=this._scrollBox=void 0;this._multiLayout=!0;this._data=void 0;this._isVisible=!0};ia.extend(ia.EventDispatcher,ia.AdvancedPieComponent);
ia.AdvancedPieComponent.prototype.build=function(){var a=new ia.InteractionGroup;this.container=$j("<div id='"+this.id+"' class='ia-advanced-chart'>");var b=this;this.container.resize(function(){b._size()});this._scrollContainer=$j("<div id='"+this.id+"-scroll-container' class='ia-advanced-chart-scrollbox'>");this._scrollBox=new ia.ScrollBox(this._scrollContainer);this.container.append(this._scrollContainer);this.thematic=new ia.Thematic;this.thematic.setDataType(ia.Thematic.CATEGORIC);this.thematic.setDataField("value");
var c,d,e;this._layout=="vertical"?(c=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:0%;top:0%;width:90%;height:30%'>"),d=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:0%;top:35%;width:90%;height:30%'>"),e=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:0%;top:70%;width:90%'>")):this._layout=="horizontal"?(c=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:0%;top:0%;width:30%;height:80%'>"),
d=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:30%;top:0%;width:30%;height:80%'>"),e=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:60%;top:0%;height:80%;width:35%'>")):this._layout=="box"?(c=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:0%;top:0%;width:50%;height:40%'>"),d=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:0%;top:50%;width:50%;height:40%'>"),
e=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:50%;top:0%;width:45%'>")):(this._multiLayout=!1,c=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:0%;top:0%;width:50%;height:90%'>"),e=$j("<div class='ia-ui-item ia-ui-item-align-center' style='position:absolute;left:50%;top:0%;width:45%;'>"));this._scrollContainer.append(c);this._multiLayout&&this._scrollContainer.append(d);this._scrollContainer.append(e);this._chartTitle1=$j("<div>");
c.append(this._chartTitle1);this._chart1=new ia.PieChart(this.id+"-pie-chart-1");this._chart1.container.css("position","relative");c.append(this._chart1.container);this._layer1=new ia.AdvancedPieLayer;this._layer1.thematic=this.thematic;this._layer1.highlightColor=this.highlightColor;this._layer1.selectionColor=this.selectionColor;this._layer1.tip=this.tip;this._layer1.setVisible(!0);this._layer1.interactive=!0;a.addComponent(this._layer1);this._chart1.addLayer(this._layer1);if(this._multiLayout)this._chartTitle2=
$j("<div>"),d.append(this._chartTitle2),this._chart2=new ia.PieChart(this.id+"-pie-chart-2"),this._chart2.container.css("position","relative"),d.append(this._chart2.container),this._layer2=new ia.AdvancedPieLayer,this._layer2.thematic=this.thematic,this._layer2.highlightColor=this.highlightColor,this._layer2.selectionColor=this.selectionColor,this._layer2.tip=this.tip,this._layer2.setVisible(!0),this._layer2.interactive=!0,a.addComponent(this._layer2),this._chart2.addLayer(this._layer2);this._legend=
new ia.DiscreteLegend(this.id+"-this._legend-discrete");this._legend.thematic=this.thematic;this._legend.highlightColor=this.highlightColor;this._legend.selectionColor=this.selectionColor;a.addComponent(this._legend);e.append(this._legend.container);this._legend.container.resize(function(){b._size()})};ia.AdvancedPieComponent.prototype._size=function(){this._scrollContainer.height(this.container.height());this._scrollContainer.width(this.container.width());this._scrollBox.refresh()};
ia.AdvancedPieComponent.prototype.setData=function(a){this._data=a;this._layer1.setData(a);this._multiLayout&&this._layer2.setData(a)};
ia.AdvancedPieComponent.prototype.highlight=function(a){if(this._multiLayout)if(this._selectionIds.length==1)this._layer2.itemId=a,this._layer2.update(),this._layer2.render(),this._chartTitle2.html(this._layer2.itemName);else{if(this._selectionIds.length==0)this._layer1.itemId=a,this._layer1.update(),this._layer1.render(),this._chartTitle1.html(this._layer1.itemName)}else if(this._selectionIds.length==0)this._layer1.itemId=a,this._layer1.update(),this._layer1.render(),this._chartTitle1.html(this._layer1.itemName)};
ia.AdvancedPieComponent.prototype.clearHighlight=function(){if(this._multiLayout)if(this._selectionIds.length==1)this._chartTitle2.html(this.title2),this._layer2.itemId=null,this._layer2.update(),this._layer2.render();else{if(this._selectionIds.length==0)this._chartTitle1.html(this.title1),this._layer1.itemId=null,this._layer1.update(),this._layer1.render()}else if(this._selectionIds.length==0)this._chartTitle1.html(this.title1),this._layer1.itemId=null,this._layer1.update(),this._layer1.render()};
ia.AdvancedPieComponent.prototype.select=function(a){this._selectionIds.indexOf(a)==-1&&this._selectionIds.push(a);this._multiLayout?this._selectionIds.length>1?(this._layer2.itemId=a,this._layer2.update(),this._layer2.render(),this._chartTitle2.html(this._layer2.itemName)):(this._layer1.itemId=a,this._layer1.update(),this._layer1.render(),this._chartTitle1.html(this._layer1.itemName)):(this._layer1.itemId=a,this._layer1.update(),this._layer1.render(),this._chartTitle1.html(this._layer1.itemName))};
ia.AdvancedPieComponent.prototype.unselect=function(a){a=this._selectionIds.indexOf(a);a!=-1&&this._selectionIds.splice(a,1);if(this._multiLayout)if(this._selectionIds.length==0)this._chartTitle1.html(this.title1),this._layer1.itemId=null,this._layer1.update(),this._layer1.render();else{if(this._selectionIds.length==1)this._chartTitle2.html(this.title2),this._layer2.itemId=null,this._layer2.update(),this._layer2.render()}else if(this._selectionIds.length==0)this._chartTitle1.html(this.title1),this._layer1.itemId=
null,this._layer1.update(),this._layer1.render()};ia.AdvancedPieComponent.prototype.clearSelection=function(){this._selectionIds=[];this._layer1.itemId=null;this._layer1.update();this._layer1.render();this._chartTitle1.html(this.title1);if(this._multiLayout)this._layer2.itemId=null,this._layer2.update(),this._layer2.render(),this._chartTitle2.html(this.title2)};
ia.AdvancedPieComponent.prototype.render=function(){this._legend.render();this._layer1.update();this._layer1.render();this._chartTitle1.html(this.title1);this._multiLayout&&(this._layer2.update(),this._layer2.render(),this._chartTitle2.html(this.title2));this._size()};ia.AdvancedPieComponent.prototype.toggle=function(){this._isVisible?this.hide():this.show()};
ia.AdvancedPieComponent.prototype.hide=function(){if(this._isVisible)this._isVisible=!1,this.container.stop(),this.container.animate({opacity:0},function(){})};ia.AdvancedPieComponent.prototype.show=function(){if(!this._isVisible)this._isVisible=!0,this.container.stop(),this.container.animate({opacity:1},function(){})};
ia.FeatureLegend=function(a){ia.FeatureLegend.baseConstructor.call(this,a);this._selectionIds=[];this.container.addClass("ia-feature-legend");this._scrollBox=new ia.ScrollBox(this.container);this._renderTimeout=null;this.interactive=this.isLegendComponent=!1;this.colorPalette=new ia.ColorPalette};ia.extend(ia.DiscreteLegend,ia.FeatureLegend);
ia.FeatureLegend.prototype.render=function(){this._renderTimeout=null;for(var a=[],b=this._selectionIds.length,c=this.colorPalette.getColors(b),d=0;d<b;d++){var e=this.geography.getFeature(this._selectionIds[d]),e=new ia.CategoricClass(e.name);e.color=c[d];a[d]=e}this.renderLegend(a);this._scrollBox.refresh()};ia.FeatureLegend.prototype.highlight=function(){};ia.FeatureLegend.prototype.clearHighlight=function(){};
ia.FeatureLegend.prototype.select=function(a){this._selectionIds.indexOf(a)==-1&&this._selectionIds.push(a);this._triggerRender()};ia.FeatureLegend.prototype.unselect=function(a){a=this._selectionIds.indexOf(a);a!=-1&&this._selectionIds.splice(a,1);this._triggerRender()};ia.FeatureLegend.prototype.clearSelection=function(){this._selectionIds=[];this._triggerRender()};
ia.FeatureLegend.prototype._triggerRender=function(){if(!this._renderTimeout)this._renderTimeout=setTimeout(function(){this.render()}.bind(this),5)};ia.MenuBar=function(a,b){this.container=$j("<div id='"+a+"' class='ia-menubar'>");this.config=b;this._render()};
ia.MenuBar.prototype._render=function(){this.container.empty();var a=$j("<table class='ia-menubar-table'>");this.container.append(a);var b=$j("<tr>");a.append(b);for(a=0;a<7;a++){var c=a+1,d=this.config.getProperty("menuItem"+c);if(d){$td=$j("<td class='ia-list-item ia-menubar-btn'>").html(d);b.append($td);var e=this.config.getProperty("menuFunc"+c);e!=void 0&&function(){var a=e;a.indexOf("http")==-1&&a.indexOf("javascript")==-1&&(a=ia.IAS_PATH+a);$td.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();
ia.IS_TOUCH_DEVICE&&b.preventDefault();ia.callFunction(a,"_blank",b)})}()}}};
ia.CalloutBox=function(a,b){this.id=a;this.notchPosition=b||"left-right";this.container=$j('<div id="'+a+'" class="callout"></div>');this._py=this._px=0;this._popup=this._isVisible=!1;this._notchBorder=$j('<div class="callout-notch"></div>');this._notchBorder.addClass("callout-notch-"+this.notchPosition);this.container.append(this._notchBorder);this._notchFill=$j('<div class="callout-notch"></div>');this._notchFill.addClass("callout-notch-"+this.notchPosition);this.container.append(this._notchFill);
this.notchPosition=="none"&&(this._notchBorder.css({display:"none"}),this._notchFill.css({display:"none"}));var c=$j("<div>").addClass("ia-panel-btns").attr("id",a+"-btns");this.container.append(c);if(ia.IS_TOUCH_DEVICE){var d;this.container.bind("touchstart",function(){c.stop();c.css({visibility:"visible"}).animate({opacity:1});clearTimeout(d);d=setTimeout(function(){clearTimeout(d);c.stop();c.animate({opacity:0},function(){c.css({visibility:"hidden"})})},5E3)})}else{var e=!1;this.container.mouseenter(function(){e||
(c.stop(),c.css({visibility:"visible"}).animate({opacity:0.4}))});this.container.mouseleave(function(){c.stop();c.animate({opacity:0},function(){c.css({visibility:"hidden"})})});c.mouseenter(function(){e=!0;c.animate({opacity:1})});c.mouseleave(function(){e=!1;c.stop();c.animate({opacity:0.4})})}var f=this,g=$j("<div>").addClass("ia-panel-btn ia-panel-close-btn").attr("id",a+"-close");g.bind(ia.CLICK_TYPE,function(){f.hide()});c.append(g);var h;this.container.resize(function(){clearTimeout(h);h=setTimeout(function(){clearTimeout(h);
f._isVisible&&f.position()},300)})};
ia.CalloutBox.prototype.position=function(a,b){if(this.container.parent()!=void 0){if(a)a-=this.container.parent().offset().left,this._px=a;if(b)b-=this.container.parent().offset().top,this._py=b;this._notchBorder.removeClass("callout-notch-left callout-notch-right callout-notch-border-left callout-notch-border-right");this._notchFill.removeClass("callout-notch-left callout-notch-right");this._notchBorder.css({left:"",right:"",top:"",bottom:""});this._notchFill.css({left:"",right:"",top:"",bottom:""});
var c=a||this._px,d=b||this._py,e=this.container.parent().width(),f=this.container.parent().height(),g=this.container.outerWidth(),h=this.container.outerHeight(),j=e/2,i=f/2,m,k;this.notchPosition=="left-right"?(m=30,k=Math.min(30,h/2),d-=k):(m=Math.min(30,g/2),k=30,c-=m);this.notchPosition=="left-right"?c<j?(c+=m,this._notchBorder.addClass("callout-notch-left callout-notch-border-left"),this._notchFill.addClass("callout-notch-left"),this._notchBorder.css({left:"-11px"}),this._notchFill.css({left:"-10px"})):
(c=c-g-m,this._notchBorder.addClass("callout-notch-right callout-notch-border-right"),this._notchFill.addClass("callout-notch-right"),this._notchBorder.css({right:"-11px"}),this._notchFill.css({right:"-10px"})):d<i?(d+=k,this._notchBorder.addClass("callout-notch-top callout-notch-border-top"),this._notchFill.addClass("callout-notch-top"),this._notchBorder.css({top:"-11px"}),this._notchFill.css({top:"-10px"})):(d=d-h-k,this._notchBorder.addClass("callout-notch-bottom callout-notch-border-bottom"),
this._notchFill.addClass("callout-notch-bottom"),this._notchBorder.css({bottom:"-11px"}),this._notchFill.css({bottom:"-10px"}));m=c+g-(e-10);m>0&&(c-=m);c<10&&(c=10);k=d+h-(f-10);k>0&&(d-=k);d<10&&(d=10);this.notchPosition=="left-right"?(e=this._py-d-5,this._notchBorder.css({top:e+"px"}),this._notchFill.css({top:e+"px"})):(e=this._px-c-5,this._notchBorder.css({left:e+"px"}),this._notchFill.css({left:e+"px"}));this.container.css({left:c+"px",top:d+"px"})}};
ia.CalloutBox.prototype.popup=function(a){if(a==!0){this._popup=!0;var b=this;$j("body").bind(ia.CLICK_TYPE,function(){b.hide()});this.container.bind(ia.CLICK_TYPE,function(a){a.stopPropagation()})}else if(a==!1)this._popup=!1;else return this._popup};ia.CalloutBox.prototype.append=function(a){this.container.append(a)};ia.CalloutBox.prototype.toggle=function(){this._isVisible?this.hide():this.show()};ia.CalloutBox.prototype.hide=function(){this._isVisible=!1;this.container.hide()};
ia.CalloutBox.prototype.show=function(){this._isVisible=!0;this.container.fadeIn()};ia.PrintBar=function(a){this._report=a;this._ratio=this._report.container.height()/this._report.container.width();this.container=$j('<div class="ia-print-bar"></div>')};
ia.PrintBar.prototype.render=function(){this.container.empty();var a=$j('<div class="ia-ui-item ia-ui-item-align-center ia-list-item ia-ui-item-table-cell ia-print-btn"></div>').html("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");this.container.append(a);a.bind(ia.CLICK_TYPE,function(a){a.stopPropagation();a.preventDefault();window.print()});var b=this,a=$j('<div class="ia-ui-item ia-ui-item-align-center ia-list-item ia-ui-item-table-cell ia-minus-btn"></div>').html("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
this.container.append(a);a.bind(ia.CLICK_TYPE,function(a){a.stopPropagation();a.preventDefault();a=b._report.container.width()-10;b._report.container.css({width:a+"px",height:a*b._ratio+"px"})});a=$j('<div class="ia-ui-item ia-ui-item-align-center ia-list-item ia-ui-item-table-cell ia-plus-btn"></div>').html("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");this.container.append(a);a.bind(ia.CLICK_TYPE,function(a){a.stopPropagation();a.preventDefault();a=b._report.container.width()+10;b._report.container.css({width:a+
"px",height:a*b._ratio+"px"})})};
ia.Profile=function(a,b,c){ia.Profile.baseConstructor.call(this);this.displayMode="Selected date";this.displayDatesInProfile=!1;this.symbols=[];this.targets=[];this.breaks=[];this.id=a;this._useMouseClick=b;this._data=void 0;this._isCollapsed=!1;this._tip=void 0;this._renderTimeout=null;this._featureIds=[];this._collapseIds=[];this.container=$j("<div id='"+a+"' class='ia-table'>");this._containerId=a;this.$tableCorner=$j("<span class='ia-table-header-corner'>");this.container.append(this.$tableCorner);this.$tableHeaders=
$j("<table>");this.container.append(this.$tableHeaders);this.$tableContainer=$j("<div id='"+a+"-container' class='ia-table-scrollbox'>");this._scrollBox=new ia.ScrollBox(this.$tableContainer);this.container.append(this.$tableContainer);this.$table=$j("<table>");this.$tableContainer.append(this.$table);this._addMouseEvents();if(c)this.callbackFunction=c;var d,e=this;this.container.resize(function(){clearTimeout(d);d=setTimeout(function(){clearTimeout(d);e._size()},250)})};
ia.extend(ia.EventDispatcher,ia.Profile);ia.Profile.prototype._size=function(){var a=this.container.width(),b=this.$tableContainer.get(0).offsetWidth-this.$tableContainer.get(0).clientWidth;a-=b;this.$table.width(a);this.$tableHeaders.width(a);var a=this.container.height(),c=this.$tableHeaders.outerHeight();this.$tableContainer.height(a-c);this.$tableCorner.css("background-color",$j(".ia-table-header").css("background-color"));this.$tableCorner.width(b);this.$tableCorner.height(c);this._renderCanvasColumns()};
ia.Profile.prototype.expandThemes=function(a){if(this._data){var b=this,c=a.length;this._isCollapsed=!1;this._collapseIds=[];$j.each(this._data.themes,function(d,e){for(var f=!0,g=0;g<c;g++)if(e.id==a[g]){f=!1;b.$table.find("td[id='"+e.id+"']").removeClass("ia-profile-theme-expand").addClass("ia-profile-theme-collapse");b.$table.find("tbody[id='"+e.id+"-children']").show();break}if(f==!0)b._collapseIds[b._collapseIds.length]=e.id,b.$table.find("td[id='"+e.id+"']").removeClass("ia-profile-theme-collapse").addClass("ia-profile-theme-expand"),
b.$table.find("tbody[id='"+e.id+"-children']").hide()})}};
ia.Profile.prototype.toggleTree=function(){if(this._data){var a=this;this._isCollapsed=!this._isCollapsed;this._collapseIds=[];var b=this._data.themes;this._isCollapsed?$j.each(b,function(b,d){a._collapseIds[a._collapseIds.length]=d.id;a.$table.find("td[id='"+d.id+"']").removeClass("ia-profile-theme-collapse").addClass("ia-profile-theme-expand");a.$table.find("tbody[id='"+d.id+"-children']").hide()}):$j.each(b,function(b,d){a.$table.find("td[id='"+d.id+"']").removeClass("ia-profile-theme-expand").addClass("ia-profile-theme-collapse");
a.$table.find("tbody[id='"+d.id+"-children']").show()})}};
ia.Profile.prototype.render=function(){this._renderTimeout=null;if(this.displayMode==void 0)this.displayMode="Selected date";this._data=this.displayMode=="Selected date"?this.geography.getProfileData(this._featureIds,this.indicator.date,!0):this.displayMode=="Most recent date"?this.geography.getProfileData(this._featureIds,void 0,!0):this.geography.getProfileData(this._featureIds);this.$table.empty();this.$tableHeaders.empty();var a=$j("<thead>"),b=$j("<tr>");a.append(b);this.$tableHeaders.append(a);
for(var c=this.columns.length,a=0;a<c;a++){var d=this.columns[a],e=d.width*100;if(d.id=="performance"){var f=e*0.15,g=$j("<th id='"+d.id+"' class='ia-table-header' style='width:"+f+"%'>");b.append(g);f=e*0.7;g=$j("<th id='"+d.id+"' class='ia-table-header' style='width:"+f+"%;border-left-width:0px'>");g.html(d.label);b.append(g);f=e*0.15;g=$j("<th id='"+d.id+"' class='ia-table-header' style='width:"+f+"%;border-left-width:0px'>")}else g=$j("<th id='"+d.id+"' class='ia-table-header' style='width:"+
e+"%'>"),g.html(d.label);b.append(g);if(d.id=="profile"){var h=this.bar.minValue+(this.bar.maxValue-this.bar.minValue)/2,e=$j("<div style='display:table;width:100%'>"),f=$j("<div style='display:table-cell;width:30%;text-align:left'>").html(this.bar.minValue),h=$j("<div style='display:table-cell;width:40%'>").html(h),j=$j("<div style='display:table-cell;width:30%;text-align:right'>").html(this.bar.maxValue);e.append(f);e.append(h);e.append(j);g.append(e);d.canvasHeight=this.bar.height;e=this.targets.length;
for(g=0;g<e;g++)f=this.targets[g],d.canvasHeight=Math.max(d.canvasHeight,f.size)}else if(d.id=="election"){d.canvasHeight=this.bar.height;e=this.targets.length;for(g=0;g<e;g++)f=this.targets[g],d.canvasHeight=Math.max(d.canvasHeight,f.size)}else if(d.id=="performance"){d.canvasHeight=this.bar.height;e=this.targets.length;for(g=0;g<e;g++)f=this.targets[g],d.canvasHeight=Math.max(d.canvasHeight,f.size);d.canvasHeight+=8}else if(d.id.indexOf("symbol(")!=-1){e=d.id.substring(d.id.indexOf("(")+1,d.id.indexOf(")")).split(",");
d.symbolAlign="right";for(g=0;g<e.length;g++)f=e[g].split(":"),d[f[0]]=f[1]}}b=$j("<tr class='ia-table-row'>");this.$table.append(b);for(var i=c,g=0;g<c;g++)d=this.columns[g],e=d.width*100,d.id=="performance"?(i=c+2,f=e*0.15,a=$j("<td class='ia-table-cell' style='width:"+f+"%;padding-top:0px;padding-bottom:0px;margin-top:0px;margin-bottom:0px'>"),b.append(a),f=e*0.7,a=$j("<td class='ia-table-cell' style='width:"+f+"%;padding-top:0px;padding-bottom:0px;margin-top:0px;margin-bottom:0px'>"),b.append(a),
f=e*0.15,a=$j("<td class='ia-table-cell' style='width:"+f+"%;padding-top:0px;padding-bottom:0px;margin-top:0px;margin-bottom:0px'>")):a=$j("<td class='ia-table-cell' style='width:"+e+"%;padding-top:0px;padding-bottom:0px;margin-top:0px;margin-bottom:0px'>"),b.append(a);var m=this;$j.each(this._data.themes,function(a,b){var d=$j("<tbody>");m.$table.append(d);var e=$j("<tr class='ia-table-row'>");d.append(e);var f=$j("<td id='"+b.id+"' class='ia-table-cell ia-profile-theme-name-cell ia-profile-theme-collapse ia-profile-row' colspan='"+
i+"'>");f.html(b.name);e.append(f);d=$j("<tbody id='"+b.id+"-children'>");m.$table.append(d);$j.each(b.indicators,function(a,b){var e=b.features;if(e.length==0){var f=a%2==0?$j("<tr class='ia-table-row ia-profile-row ia-table-row-even indicator-row'>"):$j("<tr class='ia-table-row ia-profile-row ia-table-row-odd indicator-row'>");b.date!=void 0?f.data("linkId",b.id+"~"+b.date):f.data("linkId",b.id);d.append(f);for(var g=0;g<c;g++){var h=m.columns[g],i=h.width*100;if(h.id=="performance")h=i*0.15,h=
$j("<td class='ia-table-cell' style='width:"+h+"%'>"),f.append(h),h=i*0.7,h=$j("<td class='ia-table-cell' style='width:"+h+"%;border-left-width:0px'>"),f.append(h),h=i*0.15,h=$j("<td class='ia-table-cell' style='width:"+h+"%;border-left-width:0px'>"),f.append(h);else if(h.id=="indicatorName"){var j,h=$j("<td class='ia-profile-indicator-name-cell' style='width:"+i+"%'>");m.displayDatesInProfile?(b.href&&(j=$j("<span class='ia-table-notes-icon'>"),h.append(j)),b.date?h.append(b.name+" ("+b.date+")"):
h.append(b.name)):(b.href&&(j=$j("<span class='ia-table-notes-icon'>"),h.append(j)),h.append(b.name));f.append(h);b.href&&function(){var a=b.href;j.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();window.open(a,"_blank")});j.bind("mouseover touchstart",function(a){a.stopPropagation()})}()}else h=$j("<td class='ia-table-cell' style='width:"+i+"%'>"),f.append(h)}}$j.each(e,function(f,g){var h=a%2==0?$j("<tr class='ia-table-row ia-profile-row ia-table-row-even indicator-row'>"):$j("<tr class='ia-table-row ia-profile-row ia-table-row-odd indicator-row'>");
b.date!=void 0?h.data("linkId",b.id+"~"+b.date):h.data("linkId",b.id);d.append(h);for(var i=0;i<c;i++){var j=m.columns[i],k=g[j.formattedId],n=j.width*100;if(f==0&&j.id=="indicatorName"){var p,o=$j("<td class='ia-profile-indicator-name-cell' rowspan='"+e.length+"' style='width:"+n+"%'>");m.displayDatesInProfile?(b.href&&(p=$j("<span class='ia-table-notes-icon'>"),o.append(p)),b.date?o.append(b.name+" ("+b.date+")"):o.append(b.name)):(b.href&&(p=$j("<span class='ia-table-notes-icon'>"),o.append(p)),
o.append(b.name));h.append(o);b.href&&function(){var a=b.href;p.bind(ia.CLICK_TYPE,function(b){b.stopPropagation();window.open(a,"_blank")});p.bind("mouseover touchstart",function(a){a.stopPropagation()})}()}else if(j.id=="name")o=$j("<td class='ia-table-cell ia-table-cell-categoric' style='width:"+n+"%'>"),o.html(k),h.append(o);else if(j.id=="profile"||j.id=="election"){var o=$j("<td class='ia-table-cell ia-profile-cell' style='width:"+n+"%'>"),q=document.createElement("canvas");q.width=0;q.height=
0;o.append($j(q));q=g[m.bar.data];k=g[m.bar.symbolValue];o.data("id",g.id);o.data("barValue",q);o.data("canvasHeight",j.canvasHeight);o.data("symbolValue",k);j=m.targets.length;for(q=0;q<j;q++){var v=m.targets[q],v=g[v.data];o.data("targetValue"+q,v)}h.append(o)}else if(j.id=="performance"){q=n*0.15;k=$j("<td class='ia-table-cell' style='text-align:right' style='width:"+q+"%'>");h.append(k);q=n*0.7;o=$j("<td class='ia-table-cell ia-performance-cell' style='width:"+q+"%;border-left-width:0px'>");h.append(o);
q=document.createElement("canvas");q.width=0;q.height=0;o.append($j(q));q=n*0.15;n=$j("<td class='ia-table-cell' style='text-align:left;border-left-width:0px' style='width:"+q+"%'>");h.append(n);q=g[m.bar.data];v=g[m.bar.breaksFlip];o.data("id",g.id);o.data("barValue",q);o.data("breaksFlip",v);o.data("canvasHeight",j.canvasHeight);j=m.targets.length;for(q=0;q<j;q++)v=m.targets[q],v=g[v.data],o.data("targetValue"+q,v);if(m.bar.breaksData&&(j=g[m.bar.breaksData],j!=void 0)){for(var v=j.split(","),ca=
Infinity,t=-Infinity,j=v.length,q=0;q<j;q++){var L=v[q],ca=Math.min(ca,L),t=Math.max(t,L);o.data("breakValue"+q,L)}o.data("minValue",ca);o.data("maxValue",t);k.html(ca);n.html(t)}}else j.id.indexOf("symbol(")!=-1?(k=g[j.symbolValue],j.textValue!=void 0?(q=g[j.textValue+"_formatted"],o=$j("<td class='ia-table-cell ia-symbol-cell' style='width:"+n+"%'>"),o.data("symbolValue",k),k=$j("<div style='display:table'>"),o.append(k),n=$j("<div style='display:table-cell;vertical-align:middle;width:100%'>"),
q!=void 0&&n.html(q+"&nbsp;"),q=b.type,j.textValue!="value"&&(q=g[j.textValue+"_type"]),q=="categoric"?n.addClass("ia-table-cell-categoric"):n.addClass("ia-table-cell-numeric"),v=$j("<div style='display:table-cell;vertical-align:middle'>"),q=document.createElement("canvas"),q.width=0,q.height=0,v.append($j(q)),j.symbolAlign=="right"?(k.append(n),k.append(v)):j.symbolAlign=="left"&&(k.append(v),k.append(n))):(o=$j("<td class='ia-table-cell ia-symbol-cell' style='width:"+n+"%'>"),o.data("symbolValue",
k),v=$j("<div style='vertical-align:middle;text-align:"+j.symbolAlign+";width:100%'>"),q=document.createElement("canvas"),q.width=0,q.height=0,v.append($j(q)),o.append(v)),h.append(o)):j.id=="value"?(o=b.type=="categoric"?$j("<td class='ia-table-cell ia-table-cell-categoric' style='width:"+n+"%'>"):$j("<td class='ia-table-cell ia-table-cell-numeric' style='width:"+n+"%'>"),k!=void 0&&o.html(k),h.append(o)):j.id!="indicatorName"&&j.id!="name"&&(q=g[j.id+"_type"],o=q=="categoric"?$j("<td class='ia-table-cell ia-table-cell-categoric' style='width:"+
n+"%'>"):$j("<td class='ia-table-cell ia-table-cell-numeric' style='width:"+n+"%'>"),k!=void 0&&o.html(k),h.append(o))}})})});for(a=0;a<this._collapseIds.length;a++)b=this._collapseIds[a],this.$table.find("td[id='"+b+"']").removeClass("ia-profile-theme-collapse").addClass("ia-profile-theme-expand"),this.$table.find("tbody[id='"+b+"-children']").hide();this._scrollBox.refresh();this._size()};
ia.Profile.prototype._renderCanvasColumns=function(){var a=this;this.$table.find("tbody > tr > td.ia-profile-cell").each(function(){var b=[],c=$j(this).data("id"),d=$j(this).data("barValue"),e=a.bar.maxValue-a.bar.minValue,f=$j(this).data("symbolValue"),g=$j(this).find("canvas:first").get(0),h=$j(this).width(),j=$j(this).data("canvasHeight");g.width=h;g.height=j;var i=g.getContext("2d");i.clearRect(0,0,g.width,g.height);if(d!=void 0){var m=Math.abs(d)/e*h,k=a.bar.minValue/e*h*-1,n=k;d<0&&(n=k-m);
k=(j-a.bar.height)/2;if(a.colorPalette)j=a._featureIds.length,j=a.colorPalette.getColors(j),c=a._featureIds.indexOf(c),i.fillStyle=j[c];else if(f!=void 0){j=a.symbols.length;for(c=0;c<j;c++){var l=a.symbols[c];if(l.value==f){i.fillStyle=l.color;break}}}else i.fillStyle=a.bar.color;i.beginPath();i.rect(n,k,m,a.bar.height);i.fill();f={};f.label=d;f.rect=new ia.Rectangle(n,k,m,a.bar.height);b[b.length]=f}j=a.targets.length;for(c=0;c<j;c++)if(d=a.targets[c],m=$j(this).data("targetValue"+c),m!=void 0)n=
(m-a.bar.minValue)/e*h,i.fillStyle=d.color,i.beginPath(),ia.Shape.draw(d.shape,i,n,g.height/2,d.size),i.fill(),f={},f.label=d.label+" : "+m,f.rect=new ia.Rectangle(n-d.size/2,(g.height-d.size)/2,d.size,d.size),b[b.length]=f;a._setToolTip($j(g),b)});this.$table.find("tbody > tr > td.ia-performance-cell").each(function(){var b=[],c=$j(this).data("id"),d=$j(this).data("breaksFlip"),e=$j(this).data("barValue"),f=$j(this).data("minValue"),g=$j(this).data("maxValue")-f,h=$j(this).find("canvas:first").get(0),
j=$j(this).width(),i=$j(this).data("canvasHeight");h.width=j;h.height=i;var m=h.getContext("2d");m.clearRect(0,0,h.width,h.height);for(var k=a.breaks.length,n=0;n<k;n++){var l=d==!0?a.breaks[k-n-1]:a.breaks[n],o=$j(this).data("breakValue"+n),p=n+1,r=$j(this).data("breakValue"+p),s=(o-f)/g*j,w=(r-o)/g*j;m.fillStyle=l.color;m.beginPath();m.rect(s,0,w,h.height);m.fill();p={};p.label=l.label+" : "+o+" - "+r;p.rect=new ia.Rectangle(s,0,w,h.height);b[b.length]=p}if(e!=void 0)n=(Math.abs(e)-f)/g*j,i=(i-
a.bar.height)/2,a.colorPalette?(k=a._featureIds.length,k=a.colorPalette.getColors(k),p=a._featureIds.indexOf(c),m.fillStyle=k[p]):m.fillStyle=a.bar.color,m.beginPath(),m.rect(0,i,n,a.bar.height),m.fill(),p={},p.label=e,p.rect=new ia.Rectangle(0,i,n,a.bar.height),b[b.length]=p;k=a.targets.length;for(n=0;n<k;n++)if(e=a.targets[n],c=$j(this).data("targetValue"+n),c!=void 0)i=(c-f)/g*j,m.fillStyle=e.color,m.beginPath(),ia.Shape.draw(e.shape,m,i,h.height/2,e.size),m.fill(),p={},p.label=e.label+" : "+c,
p.rect=new ia.Rectangle(i-e.size/2,(h.height-e.size)/2,e.size,e.size),b[b.length]=p;a._setToolTip($j(h),b)});this.$table.find("tbody > tr > td.ia-symbol-cell").each(function(){var b=[],c=$j(this).data("symbolValue");if(c!=void 0){for(var d,e,f,g,h=a.symbols.length,j=0;j<h;j++){var i=a.symbols[j];if(i.value==c){g=i.label;d=i.shape;e=i.size;f=i.color;break}}if(d!=void 0){var m=$j(this).find("canvas:first").get(0);m.width=e;m.height=e;c=m.getContext("2d");c.clearRect(0,0,m.width,m.height);c.fillStyle=
f;f=e/2;h=e/2;c.beginPath();ia.Shape.draw(d,c,f,h,e);c.fill();d={};d.label=g;d.rect=new ia.Rectangle(0,0,m.width,m.height);b[b.length]=d}}a._setToolTip($j(m),b)})};
ia.Profile.prototype._setToolTip=function(a,b){var c=this;a.hover(function(){c._tip=$j("<div id='ia-tooltip' class='ia-tooltip'>");$j("body").append(c._tip)},function(){c._tip.remove()});var d=!1;a.mousemove(function(e){for(var f=e.pageX-a.offset().left,g=e.pageY-a.offset().top,h=!1,j=b.length-1;j>=0;j--){var i=b[j];if(i.rect.intersects(f,g)){h=d=!0;c._tip.html(i.label);c._tip.fadeIn("fast");break}}!h&&d==!0&&(d=!1,c._tip.fadeOut("fast"));c._tip.css("top",e.pageY-20+"px").css("left",e.pageX+10+"px")})};
ia.Profile.prototype._addMouseEvents=function(){var a=this;ia.IS_TOUCH_DEVICE?(this.$table.delegate("td.ia-profile-theme-name-cell","touchend",function(){a._scrollBox.isScrolling||a._onThemeClick($j(this))}),this._useMouseClick&&this.$table.delegate("tr.indicator-row","touchend",function(){a._scrollBox.isScrolling||a._onIndicatorClick($j(this))})):(this.$table.delegate("td.ia-profile-theme-name-cell",ia.CLICK_TYPE,function(){a._onThemeClick($j(this))}),this._useMouseClick&&this.$table.delegate("tr.indicator-row",
ia.CLICK_TYPE,function(){a._onIndicatorClick($j(this))}))};
ia.Profile.prototype._onThemeClick=function(a){var b=a.attr("id");if(a.hasClass("ia-profile-theme-expand")){var c=this._collapseIds.indexOf(b);c!=-1&&this._collapseIds.splice(c,1);a.removeClass("ia-profile-theme-expand").addClass("ia-profile-theme-collapse");this.$table.find("tbody[id='"+b+"-children']").show()}else this._collapseIds[this._collapseIds.length]=b,a.removeClass("ia-profile-theme-collapse").addClass("ia-profile-theme-expand"),this.$table.find("tbody[id='"+b+"-children']").hide();this._size()};
ia.Profile.prototype._onIndicatorClick=function(a){this._tip&&this._tip.remove();this.callbackFunction&&this.callbackFunction.call(null,a.data("linkId"))};ia.Profile.prototype.select=function(a){this._featureIds.indexOf(a)==-1&&this._featureIds.push(a);this._triggerRender()};ia.Profile.prototype.unselect=function(a){a=this._featureIds.indexOf(a);a!=-1&&this._featureIds.splice(a,1);this._triggerRender()};ia.Profile.prototype.clearSelection=function(){this._featureIds=[];this._triggerRender()};
ia.Profile.prototype._triggerRender=function(){if(!this._renderTimeout)this._renderTimeout=setTimeout(function(){this.render()}.bind(this),5)};ia.Profile.prototype.highlight=function(){};ia.Profile.prototype.clearHighlight=function(){};ia.ProfileLegend=function(a){ia.ProfileLegend.baseConstructor.call(this,a);this.container.addClass("ia-profile-legend");this._scrollBox=new ia.ScrollBox(this.container);this.interactive=this.isLegendComponent=!1;this.legendClasses=[]};ia.extend(ia.DiscreteLegend,ia.ProfileLegend);
ia.ProfileLegend.prototype.render=function(){this.renderLegend(this.legendClasses);this._scrollBox.refresh()};
ia.FeatureCard=function(a,b){ia.FeatureCard.baseConstructor.call(this);this.id=a;this.displaySelectedDateOnly=!1;this.ignoreThemeIds=[];this.ignoreIndicatorIds=[];this.displayFeatureHeader=this.displayThemeHeader=!1;this.displayMode="All themes";this.dataOrder="Order data by feature";this._renderTimeout=null;this._featureIds=[];this.container=$j("<div id='"+a+"' class='ia-feature-card-scrollbox'>");this._scrollBox=new ia.ScrollBox(this.container);this.$content=$j("<div>");this.container.append(this.$content);
this._textSubstitution=new ia.TextSubstitution;this._snippet="";var c=this;b!=""&&b!=void 0&&ia.File.load(b,"html",function(a){c._snippet=a})};ia.extend(ia.EventDispatcher,ia.FeatureCard);
ia.FeatureCard.prototype.render=function(){this._renderTimeout=null;if(this._snippet!=""){this.$content.empty();this._textSubstitution.clearVariables();var a=!0;this.dataOrder!="Order data by feature"&&(a=!1);var b=this._featureIds.concat().reverse();data=this.displaySelectedDateOnly?a?this.geography.getFeatureData(b,this.indicator.date):this.geography.getIndicatorData(b,this.indicator.date):a?this.geography.getFeatureData(b):this.geography.getIndicatorData(b);a?this._renderFeatureList(data):this._renderIndicatorList(data);
this._scrollBox.refresh()}};
ia.FeatureCard.prototype._renderFeatureList=function(a){var b=this;b._textSubstitution.setVariable("geog-id",a.id);b._textSubstitution.setVariable("geog-name",a.name);$j.each(a.features,function(a,d){b._textSubstitution.setVariable("feature-id",d.id);b._textSubstitution.setVariable("feature-name",d.name);b._textSubstitution.setVariable("feature-href",d.href);b._textSubstitution.setVariable("feature-index",a);$j.each(d.properties,function(a,c){b._textSubstitution.setVariable(c.name+"-value",c.value)});
var e=$j("<div class='ia-feature-card'>");b.$content.append(e);if(b.displayFeatureHeader){var f=$j("<div id='"+d.id+"' class='ia-feature-card-header'>").html(d.name);e.append(f)}$j.each(d.themes,function(a,c){var d=!0;if(b.displayMode=="Selected theme only")b.indicator.theme.id!=c.id&&(d=!1);else for(var f=0;f<b.ignoreThemeIds.length;f++)if(c.id==b.ignoreThemeIds[f]){d=!1;break}if(d){b._textSubstitution.setVariable("theme-id",c.id);b._textSubstitution.setVariable("theme-name",c.name);b._textSubstitution.setVariable("theme-index",
a);if(b.displayThemeHeader&&c.indicators.length>0)if(b.displayMode=="Selected indicator only"){var m=!1,d=c.indicators;$j.each(d,function(a,c){b.indicator.id==c.id&&(m=!0)});m==!0&&(d=$j("<div id='"+c.id+"' class='ia-feature-card-sub-header'>").html(c.name),e.append(d))}else d=$j("<div id='"+c.id+"' class='ia-feature-card-sub-header'>").html(c.name),e.append(d);var k=$j("<div class='ia-feature-card-content'>");e.append(k);var d=c.indicators,n,l="";$j.each(d,function(a,c){var d=!0;if(b.displayMode==
"Selected indicator only")b.indicator.id!=c.id&&(d=!1);else for(var e=0;e<b.ignoreIndicatorIds.length;e++)if(c.id==b.ignoreIndicatorIds[e]){d=!1;break}if(d){b._textSubstitution.setVariable("indicator-id",c.id);b._textSubstitution.setVariable("indicator-name",c.name);b._textSubstitution.setVariable("indicator-index",a);b._textSubstitution.setVariable("indicator-type",c.type);b._textSubstitution.setVariable("indicator-href",c.href);b._textSubstitution.setVariable("indicator-formatted-value",c.formattedValue);
b._textSubstitution.setVariable("indicator-date",c.date);if(c.id!=l)l=c.id,n=0;b._textSubstitution.setVariable("indicator-date-index",n);n++;c.value=="null"||c.value==null||c.value=="NaN"||c.value==""||c.value=="No Data"||c.value==void 0?b._textSubstitution.setVariable("indicator-value",""):b._textSubstitution.setVariable("indicator-value",c.value);$j.each(c.associates,function(a,c){b._textSubstitution.setVariable(c.name+"-value",c.value);b._textSubstitution.setVariable(c.name+"-formatted-value",
c.formattedValue);b._textSubstitution.setVariable(c.name+"-type",c.type)});$j.each(c.properties,function(a,c){b._textSubstitution.setVariable(c.name+"-value",c.value)});c.lowerLimit&&(b._textSubstitution.setVariable("lower-limit-value",c.lowerLimit.value),b._textSubstitution.setVariable("lower-limit-formatted-value",c.lowerLimit.formattedValue));c.upperLimit&&(b._textSubstitution.setVariable("upper-limit-value",c.upperLimit.value),b._textSubstitution.setVariable("upper-limit-formatted-value",c.upperLimit.formattedValue));
d=b._textSubstitution.formatMessage(b._snippet);k.append(d)}})}})})};
ia.FeatureCard.prototype._renderIndicatorList=function(a){var b=this;b._textSubstitution.setVariable("geog-id",a.id);b._textSubstitution.setVariable("geog-name",a.name);$j.each(a.themes,function(a,d){var e=!0;if(b.displayMode=="Selected theme only")b.indicator.theme.id!=d.id&&(e=!1);else for(var f=0;f<b.ignoreThemeIds.length;f++)if(d.id==b.ignoreThemeIds[f]){e=!1;break}if(e){e=$j("<div class='ia-feature-card'>");b.$content.append(e);b._textSubstitution.setVariable("theme-id",d.id);b._textSubstitution.setVariable("theme-name",
d.name);b._textSubstitution.setVariable("theme-index",a);if(b.displayThemeHeader&&d.indicators.length>0)if(b.displayMode=="Selected indicator only"){var g=!1,f=d.indicators;$j.each(f,function(a,c){b.indicator.id==c.id&&(g=!0)});g==!0&&(f=$j("<div id='"+d.id+"' class='ia-feature-card-header'>").html(d.name),e.append(f))}else f=$j("<div id='"+d.id+"' class='ia-feature-card-header'>").html(d.name),e.append(f);var h=$j("<div class='ia-feature-card-content'>");e.append(h);var f=d.indicators,j,i="";$j.each(f,
function(a,c){var d=!0;if(b.displayMode=="Selected indicator only")b.indicator.id!=c.id&&(d=!1);else for(var e=0;e<b.ignoreIndicatorIds.length;e++)if(c.id==b.ignoreIndicatorIds[e]){d=!1;break}if(d){b.displayFeatureHeader&&(d=$j("<div id='"+c.id+"' class='ia-feature-card-sub-header'>").html(c.name),h.append(d));b._textSubstitution.setVariable("indicator-id",c.id);b._textSubstitution.setVariable("indicator-name",c.name);b._textSubstitution.setVariable("indicator-index",a);b._textSubstitution.setVariable("indicator-type",
c.type);b._textSubstitution.setVariable("indicator-href",c.href);b._textSubstitution.setVariable("indicator-date",c.date);if(c.id!=i)i=c.id,j=0;b._textSubstitution.setVariable("indicator-date-index",j);j++;$j.each(c.properties,function(a,c){b._textSubstitution.setVariable(c.name+"-value",c.value)});$j.each(c.features,function(a,c){b._textSubstitution.setVariable("feature-id",c.id);b._textSubstitution.setVariable("feature-name",c.name);b._textSubstitution.setVariable("feature-href",c.href);b._textSubstitution.setVariable("feature-index",
a);b._textSubstitution.setVariable("indicator-formatted-value",c.formattedValue);c.value=="null"||c.value==null||c.value=="NaN"||c.value==""||c.value=="No Data"||c.value==void 0?b._textSubstitution.setVariable("indicator-value",""):b._textSubstitution.setVariable("indicator-value",c.value);$j.each(c.properties,function(a,c){b._textSubstitution.setVariable(c.name+"-value",c.value)});$j.each(c.associates,function(a,c){b._textSubstitution.setVariable(c.name+"-value",c.value);b._textSubstitution.setVariable(c.name+
"-formatted-value",c.formattedValue);b._textSubstitution.setVariable(c.name+"-type",c.type)});c.lowerLimit&&(b._textSubstitution.setVariable("lower-limit-value",c.lowerLimit.value),b._textSubstitution.setVariable("lower-limit-formatted-value",c.lowerLimit.formattedValue));c.upperLimit&&(b._textSubstitution.setVariable("upper-limit-value",c.upperLimit.value),b._textSubstitution.setVariable("upper-limit-formatted-value",c.upperLimit.formattedValue));var d=b._textSubstitution.formatMessage(b._snippet);
h.append(d)})}})}})};ia.FeatureCard.prototype._triggerRender=function(){if(!this._renderTimeout)this._renderTimeout=setTimeout(function(){this.render()}.bind(this),5)};ia.FeatureCard.prototype.select=function(a){this._featureIds.indexOf(a)==-1&&this._featureIds.push(a);this._triggerRender()};ia.FeatureCard.prototype.unselect=function(a){a=this._featureIds.indexOf(a);a!=-1&&this._featureIds.splice(a,1);this._triggerRender()};ia.FeatureCard.prototype.clearSelection=function(){this._featureIds=[];this._triggerRender()};
ia.FeatureCard.prototype.highlight=function(){};ia.FeatureCard.prototype.clearHighlight=function(){};
ia.TimeControl=function(a,b,c){this.id=a;if(c)this._callbackFunction=c;this._dataGroup=b;this.delay=1.5;this._playing=!1;this._currentIndicatorId=this._currentGeographyId=this.$playBtn=void 0;this.container=$j("<div id='"+a+"-container' class='ia-time-control-scrollbox'>");this._scrollBox=new ia.ScrollBox(this.container);this.$table=$j("<table class='ia-time-control-table'>");this.container.append(this.$table);var d=this;this._dataGroup.addEventListener(ia.DataEvent.INDICATOR_CHANGED,function(a){if(a.indicator.geography.id!=
d._currentGeographyId||d._currentIndicatorId!=a.indicator.id)d._stop(),d._currentIndicatorId=a.indicator.id,d._currentGeographyId=a.indicator.geography.id,d._render(a.indicator);else if(d._playing)var b=setTimeout(function(){clearTimeout(b);if(d._playing){var c=a.theme.getIndicatorDates(a.indicator.id),g=c.indexOf(a.indicator.date)+1;g<c.length?d._dataGroup.setData(a.geography.id,a.indicator.id,c[g]):d._stop()}},d.delay*1E3);d.$table.find("td.ia-time-control-date-btn").removeClass("ia-time-control-date-btn-active");
if(a.indicator.date!=void 0){var c=a.indicator.date.replace(/'/g,"#quote#").replace(/"/g,"#double-quote#");d.$table.find("td.ia-time-control-date-btn[id='"+c+"-btn']").addClass("ia-time-control-date-btn-active")}})};
ia.TimeControl.prototype._play=function(){if(this._playing)this._stop();else{this._callbackFunction&&this._callbackFunction.call(null,!0);this._playing=!0;this.$playBtn.removeClass("ia-time-control-btn-play");this.$playBtn.addClass("ia-time-control-btn-stop");var a=this._dataGroup.theme.getIndicatorDates(this._dataGroup.indicator.id),b=a.indexOf(this._dataGroup.indicator.date)+1;b<a.length?this._dataGroup.setData(this._dataGroup.geography.id,this._dataGroup.indicator.id,a[b]):this._dataGroup.setData(this._dataGroup.geography.id,
this._dataGroup.indicator.id,a[0])}};ia.TimeControl.prototype._stop=function(){this._callbackFunction&&this._callbackFunction.call(null,!1);this._playing=!1;this.$playBtn&&(this.$playBtn.removeClass("ia-time-control-btn-stop"),this.$playBtn.addClass("ia-time-control-btn-play"))};
ia.TimeControl.prototype._back=function(){this._stop();var a=this._dataGroup.theme.getIndicatorDates(this._dataGroup.indicator.id),b=a.indexOf(this._dataGroup.indicator.date)-1;b>-1?this._dataGroup.setData(this._dataGroup.geography.id,this._dataGroup.indicator.id,a[b]):this._dataGroup.setData(this._dataGroup.geography.id,this._dataGroup.indicator.id,a[a.length-1])};
ia.TimeControl.prototype._next=function(){this._stop();var a=this._dataGroup.theme.getIndicatorDates(this._dataGroup.indicator.id),b=a.indexOf(this._dataGroup.indicator.date)+1;b<a.length?this._dataGroup.setData(this._dataGroup.geography.id,this._dataGroup.indicator.id,a[b]):this._dataGroup.setData(this._dataGroup.geography.id,this._dataGroup.indicator.id,a[0])};
ia.TimeControl.prototype.setData=function(a){this._stop();this._currentIndicatorId=a.id;this._currentGeographyId=a.geography.id;this._render(a);this.$table.find("td.ia-time-control-date-btn").removeClass("ia-time-control-date-btn-active");a.date!=void 0&&this.$table.find("td.ia-time-control-date-btn[id='"+a.date.replace(/'/g,"#quote#").replace(/"/g,"#double-quote#")+"-btn']").addClass("ia-time-control-date-btn-active")};
ia.TimeControl.prototype._render=function(a){this.$table.empty();var b=a.theme.getIndicatorDates(a.id);if(b){var c=this;$tr=$j("<tr>");this.$table.append($tr);this.$playBtn=$j("<td class='ia-list-item ia-time-control-btn ia-time-control-btn-play'>");$tr.append(this.$playBtn);this.$playBtn.bind(ia.CLICK_TYPE,function(a){a.stopPropagation();ia.IS_TOUCH_DEVICE&&a.preventDefault();c._play()});var d=$j("<td class='ia-list-item ia-time-control-btn ia-time-control-btn-back'>");$tr.append(d);d.bind(ia.CLICK_TYPE,
function(a){a.stopPropagation();ia.IS_TOUCH_DEVICE&&a.preventDefault();c._back()});d=$j("<td class='ia-list-item ia-time-control-btn ia-time-control-btn-forward'>");$tr.append(d);d.bind(ia.CLICK_TYPE,function(a){a.stopPropagation();ia.IS_TOUCH_DEVICE&&a.preventDefault();c._next()});for(d=0;d<b.length;d++){var e=b[d],f=e.replace(/'/g,"#quote#").replace(/"/g,"#double-quote#");$dateBtn=$j("<td id='"+f+"-btn' class='ia-list-item ia-time-control-td ia-time-control-date-btn'>").html(e);$tr.append($dateBtn);
(function(){var b=a.geography.id,d=a.id,f=e;$dateBtn.bind(ia.CLICK_TYPE,function(a){a.stopPropagation();ia.IS_TOUCH_DEVICE&&a.preventDefault();c._stop();c._dataGroup.setData(b,d,f)})})()}}this._scrollBox.refresh()};ia.BoundingBox=function(a,b,c,d){this.setXMin(a||0);this.setYMin(b||0);this.setXMax(c||100);this.setYMax(d||100)};ia.BoundingBox.prototype.left=function(){return this._xMin};ia.BoundingBox.prototype.right=function(){return this._xMax};ia.BoundingBox.prototype.bottom=function(){return this._yMin};
ia.BoundingBox.prototype.top=function(){return this._yMax};ia.BoundingBox.prototype.getXMin=function(){return this._xMin};ia.BoundingBox.prototype.setXMin=function(a){this._xMin=a;this._width=Math.abs(this._xMax-this._xMin);this._xCenter=this._xMin+this._width/2};ia.BoundingBox.prototype.getXMax=function(){return this._xMax};ia.BoundingBox.prototype.setXMax=function(a){this._xMax=a;this._width=Math.abs(this._xMax-this._xMin);this._xCenter=this._xMin+this._width/2};
ia.BoundingBox.prototype.getXCenter=function(){return this._xCenter};ia.BoundingBox.prototype.setXCenter=function(a){this._xCenter=a;this._xMin=this._xCenter-this._width/2;this._xMax=this._xCenter+this._width/2};ia.BoundingBox.prototype.getWidth=function(){return this._width};ia.BoundingBox.prototype.setWidth=function(a){this._width=a;this._xMax=this._xMin+this._width;this._xCenter=this._xMin+this._width/2};ia.BoundingBox.prototype.getYMin=function(){return this._yMin};
ia.BoundingBox.prototype.setYMin=function(a){this._yMin=a;this._height=Math.abs(this._yMax-this._yMin);this._yCenter=this._yMin+this._height/2};ia.BoundingBox.prototype.getYMax=function(){return this._yMax};ia.BoundingBox.prototype.setYMax=function(a){this._yMax=a;this._height=Math.abs(this._yMax-this._yMin);this._yCenter=this._yMin+this._height/2};ia.BoundingBox.prototype.getYCenter=function(){return this._yCenter};
ia.BoundingBox.prototype.setYCenter=function(a){this._yCenter=a;this._yMin=this._yCenter-this._height/2;this._yMax=this._yCenter+this._height/2};ia.BoundingBox.prototype.getHeight=function(){return this._height};ia.BoundingBox.prototype.setHeight=function(a){this._height=a;this._yMax=this._yMin+this._height;this._yCenter=this._yMin+this._height/2};ia.BoundingBox.prototype.clone=function(){return new ia.BoundingBox(this._xMin,this._yMin,this._xMax,this._yMax)};
ia.BoundingBox.prototype.equals=function(a){return a.getXMin()!=this._xMin?!1:a.getYMin()!=this._yMin?!1:a.getXMax()!=this._xMax?!1:a.getYMax()!=this._yMax?!1:!0};ia.BoundingBox.prototype.intersects=function(a){return a.getXMin()>this._xMax?!1:a.getXMax()<this._xMin?!1:a.getYMin()>this._yMax?!1:a.getYMax()<this._yMin?!1:!0};ia.BoundingBox.prototype.contains=function(a){return a.getXMin()<this._xMin?!1:a.getXMax()>this._xMax?!1:a.getYMin()<this._yMin?!1:a.getYMax()>this._yMax?!1:!0};
ia.BoundingBox.prototype.toString=function(){return"[object ia.BoundingBox xMin='"+this._xMin+"' yMin='"+this._yMin+"' xMax='"+this._xMax+"' yMax='"+this._yMax+"']"};ia.BBoxEvent=function(a,b,c,d){ia.BBoxEvent.baseConstructor.call(this,a,b);this.bBox=c;this.oldBBox=d};ia.extend(ia.Event,ia.BBoxEvent);ia.BBoxEvent.BBOX_TRANSLATE=0;ia.BBoxEvent.BBOX_SCALE=1;
ia.CartesianSpace=function(a,b,c,d){ia.CartesianSpace.baseConstructor.call(this);this.canvasX=a||0;this.canvasY=b||0;this.canvasWidth=c||0;this.canvasHeight=d||0;this.bBox=new ia.BoundingBox;this.oldBBox=new ia.BoundingBox;this.maxZoom=this.minZoom=-1;this.maintainAspectRatio=!1};ia.extend(ia.EventDispatcher,ia.CartesianSpace);ia.CartesianSpace.prototype.getBBox=function(){return this.bBox};ia.CartesianSpace.prototype.setBBox=function(a){this.oldBBox=this.bBox.clone();this.bBox=a.clone();this.commitChanges()};
ia.CartesianSpace.prototype.getPixelPoint=function(a){return new ia.Point(this.getPixelX(a.x),this.getPixelY(a.y))};ia.CartesianSpace.prototype.getPixelRect=function(a){return new ia.Rectangle(this.getPixelX(a.getXMin()),this.getPixelY(a.getYMax()),this.getPixelWidth(a.getWidth()),this.getPixelHeight(a.getHeight()))};ia.CartesianSpace.prototype.getPixelX=function(a){return this.canvasX+this.getPixelWidth(a-this.bBox.getXMin())};
ia.CartesianSpace.prototype.getPixelY=function(a){return this.canvasY+this.canvasHeight-this.getPixelHeight(a-this.bBox.getYMin())};ia.CartesianSpace.prototype.getPixelWidth=function(a){return a==0?0:a/this.bBox.getWidth()*this.canvasWidth};ia.CartesianSpace.prototype.getPixelHeight=function(a){return a==0?0:a/this.bBox.getHeight()*this.canvasHeight};ia.CartesianSpace.prototype.getDataPoint=function(a){return new ia.Point(this.getDataX(a.x),this.getDataY(a.y))};
ia.CartesianSpace.prototype.getDataBBox=function(a){var b=this.getPixelX(a.left()),c=this.getPixelY(a.bottom()),d=b+this.getPixelWidth(a.width),a=c+this.getPixelHeight(a.height);return new ia.BoundingBox(b,c,d,a)};ia.CartesianSpace.prototype.getDataX=function(a){return this.bBox.getXMin()+this.getDataWidth(a)};ia.CartesianSpace.prototype.getDataY=function(a){return this.bBox.getYMin()+this.getDataHeight(this.canvasHeight-a)};
ia.CartesianSpace.prototype.getDataWidth=function(a){return a==0?0:a/this.canvasWidth*this.bBox.getWidth()};ia.CartesianSpace.prototype.getDataHeight=function(a){return a==0?0:a/this.canvasHeight*this.bBox.getHeight()};
ia.CartesianSpace.prototype.commitChanges=function(){this.maintainAspectRatio&&this.adjustBBox(this.bBox);var a=!0;this.minZoom!=-1&&Math.max(this.bBox.getWidth(),this.bBox.getHeight())>this.minZoom&&(a=!1);this.maxZoom!=-1&&Math.min(this.bBox.getWidth(),this.bBox.getHeight())<this.maxZoom&&(a=!1);a?(eventType=this.bBox.getWidth()==this.oldBBox.getWidth()&&this.bBox.getHeight()==this.oldBBox.getHeight()?ia.BBoxEvent.BBOX_TRANSLATE:ia.BBoxEvent.BBOX_SCALE,this.dispatchEvent(new ia.BBoxEvent(eventType,
this,this.bBox,this.oldBBox))):this.bBox=this.oldBBox.clone()};
ia.CartesianSpace.prototype.adjustBBox=function(a){var b=a.getHeight()/this.canvasHeight,c=a.getWidth()/this.canvasWidth,d,e;b>c?(c=a.getYMin(),e=a.getHeight(),d=this.canvasWidth/this.canvasHeight*e,b=a.getXMin()-(d-a.getWidth())/2):c>b?(b=a.getXMin(),d=a.getWidth(),e=this.canvasHeight/this.canvasWidth*d,c=a.getYMin()-(e-a.getHeight())/2):(b=a.getXMin(),c=a.getYMin(),d=a.getWidth(),e=a.getHeight());a.setXMin(b);a.setYMin(c);a.setWidth(d);a.setHeight(e)};
ia.CartesianSpace.prototype.adjustY=function(a){var b=a.getXMin(),c=a.getWidth(),d=this.canvasHeight/this.canvasWidth*c,e=a.getYMin()-(d-a.getHeight())/2;a.setXMin(b);a.setYMin(e);a.setWidth(c);a.setHeight(d)};ia.Rectangle=function(a,b,c,d){this.x=a||0;this.y=b||0;this.width=c||0;this.height=d||0};ia.Rectangle.prototype.left=function(){return this.x};ia.Rectangle.prototype.right=function(){return this.x+this.width};ia.Rectangle.prototype.bottom=function(){return this.y+this.height};
ia.Rectangle.prototype.top=function(){return this.y};ia.Rectangle.prototype.clone=function(){return new ia.Rectangle(this.x,this.y,this.width,this.height)};ia.Rectangle.prototype.intersects=function(a,b){return b<this.top()?!1:b>this.bottom()?!1:a>this.right()?!1:a<this.left()?!1:!0};
ia.Rectangle.prototype.intersectsLine=function(a,b){return this.lineIntersectsLine({x:this.left(),y:this.top()},{x:this.right(),y:this.top()},a,b)||this.lineIntersectsLine({x:this.right(),y:this.top()},{x:this.right(),y:this.bottom()},a,b)||this.lineIntersectsLine({x:this.right(),y:this.bottom()},{x:this.left(),y:this.bottom()},a,b)||this.lineIntersectsLine({x:this.left(),y:this.bottom()},{x:this.left(),y:this.top()},a,b)||this.intersects(a.x,a.y)&&this.intersects(b.x,b.y)};
ia.Rectangle.prototype.lineIntersectsLine=function(a,b,c,d){var e=(d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x),f=(b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x),a=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);return a!=0?(e/=a,f/=a,0<=e&&e<=1&&0<=f&&f<=1?!0:!1):!1};ia.Rectangle.prototype.toString=function(){return"[object Rectangle x='"+this.x+"' y='"+this.y+"' width='"+this.width+"' height='"+this.height+"']"};ia.Point=function(a,b){this.x=a||0;this.y=b||0};
ia.Point.prototype.subtract=function(a){return new ia.Point(this.x-a.x,this.y-a.y)};ia.Point.prototype.toString=function(){return"[object Point x='"+this.x+"' y='"+this.y+"']"};ia.ChartTip=function(a){this._container=a;this._tipContainer=$j("<svg>").addClass("ia-datatip").hide();$j("body").append(this._tipContainer)};
ia.ChartTip.prototype.position=function(a,b){var c=$j("body").width(),d=$j("body").height(),e=this._tipContainer.outerWidth(),f=this._tipContainer.outerHeight();this._container!=void 0&&(a+=this._container.offset().left,b+=this._container.offset().top);a<10?a=10:(c=a+e-(c-10),c>0&&(a-=c));b<10?b=10:(d=b+f-(d-10),d>0&&(b-=d));this._tipContainer.css("left",a+"px").css("top",b+"px")};ia.ChartTip.prototype.text=function(a){this._tipContainer.html(a)};ia.ChartTip.prototype.getWidth=function(){return this._tipContainer.outerWidth()};
ia.ChartTip.prototype.getHeight=function(){return this._tipContainer.outerHeight()};ia.ChartTip.prototype.show=function(){this._tipContainer.css("display","inline")};ia.ChartTip.prototype.hide=function(){this._tipContainer.css("display","none")};
ia.CanvasBase=function(a){ia.CanvasBase.baseConstructor.call(this,0,0,100,100);this._touchStart=0;this._pinching=this._mouseOverMap=this._mouseDragged=this._dragging=this._mouseDown=!1;this._layers=[];this.id=a;this.isVisible=!0;this.mouseY=this.mouseX=0;this.isDraggable=this.embeddedInGoogleMaps=!1;this.container=$j("<div id='"+a+"' class='ia-chart'>");this.mapContainer=$j("<div id='mapContainer'>");this.backgroundContainer=$j("<div id='backgroundContainer'>");this.layerContainer=$j("<div id='layercontainer'>");
this.foregroundContainer=$j("<div id='foregroundContainer'>");this.mapContainer.append(this.backgroundContainer);this.mapContainer.append(this.layerContainer);this.mapContainer.append(this.foregroundContainer);this.container.append(this.mapContainer);this.labelStyle=$j("<div class='ia-map-labels' style='visibility:hidden'>");this.mapContainer.append(this.labelStyle);this.canvas=this._createCanvas(this.backgroundContainer);this.context=this.canvas.getContext("2d");this.foregroundCanvas=this._createCanvas(this.foregroundContainer);
this.foregroundContext=this.foregroundCanvas.getContext("2d");this.datatip=new ia.ChartTip(this.foregroundContainer);this._addListeners();var b,c=!1,d=this;this.container.resize(function(){clearTimeout(b);b=setTimeout(function(){clearTimeout(b);var a=d.container.width(),f=d.container.height();d.foregroundContainer.width(a);d.foregroundContainer.height(f);d.canvas.width=a;d.canvas.height=f;d.foregroundCanvas.width=a;d.foregroundCanvas.height=f;d.canvasX=0;d.canvasY=0;d.canvasWidth=a;d.canvasHeight=
f;a=new ia.Event(ia.Event.MAP_RESIZE,d);d.dispatchEvent(a);d.commitChanges();c==!1&&(c=!0,a=new ia.Event(ia.Event.MAP_READY,d),d.dispatchEvent(a))},500)}.bind(this))};ia.extend(ia.CartesianSpace,ia.CanvasBase);ia.CanvasBase.prototype._createCanvas=function(a){var b=document.createElement("canvas");b.width=a.width();b.height=a.height();$j(b).css({position:"absolute",left:0,top:0});a.append($j(b));return b};
ia.CanvasBase.prototype._addListeners=function(){if(ia.IS_TOUCH_DEVICE)this.mapContainer.bind("touchstart.cb touchmove.cb touchend.cb",this._touchEventHandler.bind(this));else{this.mapContainer.bind("mousemove.cb mouseup.cb mouseenter.cb mouseleave.cb mousedown.cb click.cb",this._mouseEventHandler.bind(this));var a=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";document.addEventListener&&document.addEventListener(a,this._mouseEventHandler.bind(this),!1)}};
ia.CanvasBase.prototype._mouseEventHandler=function(a){var b=!0,c=$j("#"+this.id+"-panel");c&&c.css("visibility")=="hidden"&&(b=!1);if(this.isVisible&&b){var d;this.mouseX=a.pageX-this.container.offset().left;this.mouseY=a.pageY-this.container.offset().top;this._mouseOverMap=this.mouseX>this.canvasX&&this.mouseX<this.canvasX+this.canvasWidth&&this.mouseY>this.canvasY&&this.mouseY<this.canvasY+this.canvasHeight?!0:!1;if(a.type=="mouseenter")d=ia.MapMouseEvent.MAP_MOUSE_OVER,this._dragging&&$j(document).unbind("mousemove.cb mouseup.cb"),
this._mouseOverMap=!0;else if(a.type=="mouseleave")d=ia.MapMouseEvent.MAP_MOUSE_OUT,this._dragging&&$j(document).bind("mousemove.cb mouseup.cb",this._mouseEventHandler.bind(this)),this._mouseOverMap=!1;else if(a.type=="mousemove")if(this._mouseOverMap=!0,this._mouseDown)d=ia.MapMouseEvent.MAP_MOUSE_DRAG,this._dragging=!0;else{if(this._mouseOverMap)d=ia.MapMouseEvent.MAP_MOUSE_MOVE}else if(a.type=="mouseup"){if(this._dragging)d=ia.MapMouseEvent.MAP_MOUSE_DRAG_UP,$j(document).unbind("mousemove.cb mouseup.cb"),
this._dragging=!1,this._mouseDragged=!0;else if(this._mouseOverMap)d=ia.MapMouseEvent.MAP_MOUSE_UP;this._mouseDown=!1}else if(a.type=="mousedown")d=ia.MapMouseEvent.MAP_MOUSE_DOWN,this._mouseDragged=!1,this._mouseDown=!0;else if(a.type=="mousewheel"||a.type=="onmousewheel"||a.type=="DOMMouseScroll")this._mouseOverMap&&a.preventDefault(),d=ia.MapMouseEvent.MAP_MOUSE_WHEEL;else if(a.type=="click"){if(this._mouseDragged==!1)d=ia.MapMouseEvent.MAP_MOUSE_CLICK;this._mouseDragged=this._mouseDown=this._dragging=
!1}d!=null&&(b=this.getDataX(this.mouseX),c=this.getDataY(this.mouseY),this.dispatchEvent(new ia.MapMouseEvent(this,a,d,b,c,this.mouseX,this.mouseY,void 0,void 0,a.pageX,a.pageY)))}};
ia.CanvasBase.prototype._touchEventHandler=function(a){if(this.isVisible){var b;this.embeddedInGoogleMaps||a.preventDefault();var c,d,e,f;if(a.originalEvent.touches.length==2){var g=a.originalEvent.touches[0];f=a.originalEvent.touches[1];c=g.pageX-this.container.offset().left;d=g.pageY-this.container.offset().top;e=f.pageX-this.container.offset().left;f=f.pageY-this.container.offset().top;if(a.type=="touchstart")b=ia.MapMouseEvent.MAP_PINCH_DOWN;else if(a.type=="touchmove")b=ia.MapMouseEvent.MAP_PINCH_MOVE,
this._pinching=!0}else if(g=a.originalEvent.changedTouches[0],c=g.pageX-this.container.offset().left,d=g.pageY-this.container.offset().top,f=e=null,a.type=="touchstart")this._touchStart=(new Date).getTime(),b=ia.MapMouseEvent.MAP_MOUSE_DOWN;else if(a.type=="touchmove")this._pinching?(this.mouseX=c,this.mouseY=d,mouseDownCoords=this.mouseCoords(),mouseDownPixels=new ia.Point(this.mouseX,this.mouseY),this._pinching=!1,doPan=this._dragging=!0):(b=this.isDraggable?ia.MapMouseEvent.MAP_MOUSE_DRAG:ia.MapMouseEvent.MAP_MOUSE_MOVE,
this._dragging=!0);else if(a.type=="touchend")if(b=(new Date).getTime()-this._touchStart,this._dragging)b=this.isDraggable?ia.MapMouseEvent.MAP_MOUSE_DRAG_UP:ia.MapMouseEvent.MAP_MOUSE_UP,this._dragging=!1;else if(this._pinching){if(b=ia.MapMouseEvent.MAP_PINCH_UP,a.originalEvent.touches.length==0)this._pinching=!1}else b=b<500?ia.MapMouseEvent.MAP_MOUSE_CLICK:ia.MapMouseEvent.MAP_MOUSE_UP;if(b!=null){e!=null?(this.mouseX=Math.min(c,e),this.mouseY=Math.min(d,f)):(this.mouseX=c,this.mouseY=d);f=this.getDataX(this.mouseX);
var h=this.getDataY(this.mouseY);this.dispatchEvent(new ia.MapMouseEvent(this,a,b,f,h,c,d,e,g.pageX,g.pageX))}}};ia.CanvasBase.prototype.mouseCoords=function(){var a=this.getDataX(this.mouseX),b=this.getDataY(this.mouseY);return new ia.Point(a,b)};
ia.CanvasBase.prototype.exportData=function(a){for(var b=0;b<this._layers.length;b++){var c=this._layers[b];c.geometry!="image"&&(this.context.drawImage(c.canvas,0,0),c.selectionCanvas&&this.context.drawImage(c.selectionCanvas,0,0),c.labelCanvas&&this.context.drawImage(c.labelCanvas,0,0))}b=this.canvas.toDataURL("image/png");window.open().document.write('<div style="font-family:Verdana;font-size:12px;color:#888888;">'+a+'</div><p><img style="border-width:1px;border-style:solid;border-color:#DCDCDC;" src="'+
b+'"/></p>');this.clear();this.render()};ia.CanvasBase.prototype.render=function(){this.datatip.hide();for(var a=0;a<this._layers.length;a++)this._layers[a].render()};ia.CanvasBase.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var a=0;a<this._layers.length;a++)this._layers[a].clear()};ia.CanvasBase.prototype.clearForeground=function(){this.foregroundContext.clearRect(0,0,this.foregroundCanvas.width,this.foregroundCanvas.height)};
ia.CanvasBase.prototype.addLayer=function(a){this._layers.push(a);a.setMap(this,this.layerContainer)};ia.CanvasBase.prototype.getLayers=function(){return this._layers};ia.CanvasBase.prototype.getLayer=function(a){for(var b=0;b<this._layers.length;b++){var c=this._layers[b];if(c.id==a)return c}};ia.CanvasBase.prototype.startDrag=function(){this._dragging=!0};
ia.CanvasBase.prototype.endDrag=function(){$j(document).unbind("mousemove.cb mouseup.cb");this._dragging=!1;this._mouseDragged=!0;this._mouseDown=!1};ia.CanvasBase.prototype.toggle=function(){this.isVisible?this.hide():this.show()};ia.CanvasBase.prototype.hide=function(){if(this.isVisible){var a=this;a.isVisible=!1;a.container.stop();a.container.animate({opacity:0},function(){a.clear()})}};
ia.CanvasBase.prototype.show=function(){if(!this.isVisible)this.isVisible=!0,this.container.stop(),this.container.animate({opacity:1},function(){})};
ia.ChartBase=function(a){ia.ChartBase.baseConstructor.call(this,a);this.itemStyle=$j("<div class='ia-chart-items' style='visibility:hidden'>");this.mapContainer.append(this.itemStyle);this.orientation="vertical";this.showXAxisLabels=!0;this.xAxisTitle=void 0;this.showYAxisLabels=!0;this.yAxisTitle=void 0;this.showYAxisGrid=this.showXAxisGrid=!0;this.useTightLabels=this.centerYAxisLabels=this.centerXAxisLabels=!1;this.formatter=new ia.Formatter;this.useFixedValues=!1;var b=this;this.addEventListener(ia.BBoxEvent.BBOX_TRANSLATE,
function(){b.render()});this.addEventListener(ia.BBoxEvent.BBOX_SCALE,function(){b.render()})};ia.extend(ia.CanvasBase,ia.ChartBase);
ia.ChartBase.prototype.renderAxes=function(a,b,c,d){var e="Verdana",f="#AAAAAA",g=10,h="#E5E5E5";this.container.css("font-family")&&(e=this.container.css("font-family"));this.container.css("color")&&(f=ia.Color.toHex(this.container.css("color")));this.container.css("font-size")&&(g=this.container.css("font-size"),g.indexOf("px")>-1&&(g=g.substring(0,g.indexOf("px"))),g=ia.parseInt(g));this.container.css("borderRightColor")&&(h=ia.Color.toHex(this.container.css("borderRightColor")));this.canvasY=this.canvasX=
0;this.canvasWidth=this.canvas.width;this.canvasHeight=this.canvas.height;this.context.lineWidth=1;this.context.strokeStyle=h;this.context.font=""+g+"px "+e;this.context.fillStyle=f;e=g+12;g+=2;var h=f=20,j=15,i=15;this.showYAxisLabels&&(j=15+e/2,i=15+e/2);this.showXAxisLabels&&(j=15+e);if(this.xAxisTitle!=void 0){var m=this.canvasWidth-40,k=this._getNoLines(this.xAxisTitle,m);this.showXAxisLabels?j+=k*g:j=15+k*g}var n=this.canvasHeight-(i+j);this.yAxisLabels?d=this.yAxisLabels.concat():(d=this._getYAxisLabels(c,
d,5,n,e).concat(),d.reverse());if(this.showYAxisLabels){for(c=f=0;c<d.length;c++)var l=d[c],k=this.context.measureText(l),f=Math.max(f,k.width);f=f+12+20}this.yAxisTitle!=void 0&&(m=this.canvasHeight-(j+i),k=this._getNoLines(this.yAxisTitle,m),this.showYAxisLabels?f+=k*g:f=20+k*g);k=this.canvasWidth-f;a=this.xAxisLabels?this._adjustXLabels(this.xAxisLabels,k,6):this._getXAxisLabels(a,b,5,k,6);this.showXAxisLabels&&(l=a[a.length-1],k=this.context.measureText(l),h=(k.width+6)/2+20,l=a[0],k=this.context.measureText(l),
f=Math.max(k.width+12+20,f),k=this.canvasWidth-(h+f));if(this.showYAxisLabels){this.context.textAlign="right";this.context.textBaseline="middle";var b=d.length,m=f-6,o,p,r;this.centerYAxisLabels?(o=n/b,n=i+o/2,p=o,r=i):(o=n/(b-1),n=i,p=o,r=n);for(c=0;c<b;c++){l=d[c];this.context.fillText(l,m,n);if(this.showYAxisGrid){var l=Math.floor(f)+0.5,s=Math.floor(r)+0.5,w=Math.floor(this.canvasWidth-h)+0.5,q=s;this.context.beginPath();this.context.moveTo(l,s);this.context.lineTo(w,q);this.context.stroke()}n+=
o;r+=p}this.showYAxisGrid&&this.centerYAxisLabels&&(l=Math.floor(f)+0.5,s=Math.floor(r)+0.5,w=Math.floor(this.canvasWidth-h)+0.5,q=s,this.context.beginPath(),this.context.moveTo(l,s),this.context.lineTo(w,q),this.context.stroke())}if(this.yAxisTitle!=void 0)m=this.canvasHeight-(j+i),c=i+m/2,d=17,this.context.save(),this.context.translate(d,c),this.context.rotate(-Math.PI/2),this.context.textAlign="center",this.context.textBaseline="top",this._wrapText(this.yAxisTitle,0,0,m,g),this.context.restore();
if(this.showXAxisLabels){this.context.textAlign="center";this.context.textBaseline="top";b=a.length;n=this.canvasHeight-j+6;this.centerXAxisLabels?(d=k/b,m=f+d/2,k=d,o=f):(d=k/(b-1),m=f,k=d,o=m);for(c=0;c<b;c++)l=a[c],this.isPyramidChart==!0&&l.indexOf("-")!=-1&&(l=l.substring(1)),this.context.fillText(l,m,n),this.showXAxisGrid&&(l=Math.floor(o)+0.5,s=Math.floor(i)+0.5,w=l,q=Math.floor(this.canvasHeight-j)+0.5,this.context.beginPath(),this.context.moveTo(l,s),this.context.lineTo(w,q),this.context.stroke()),
m+=d,o+=k;this.showXAxisGrid&&this.centerXAxisLabels&&(l=Math.floor(o)+0.5,s=Math.floor(i)+0.5,w=l,q=Math.floor(this.canvasHeight-j)+0.5,this.context.beginPath(),this.context.moveTo(l,s),this.context.lineTo(w,q),this.context.stroke())}if(this.xAxisTitle!=void 0)this.context.textAlign="center",this.context.textBaseline="top",m=this.canvasWidth-(f+h),c=this.showXAxisLabels?this.canvasHeight-j+e+3:this.canvasHeight-j+9,this._wrapText(this.xAxisTitle,f+m/2,c,m,g);this.canvasX=f;this.canvasWidth-=f+h;
this.canvasY=i;this.canvasHeight-=i+j};ia.ChartBase.prototype._getNoLines=function(a,b){for(var c=a.split(" "),d="",e=1,f=0;f<c.length;f++)d=d+c[f]+" ",this.context.measureText(d).width>b&&(d=c[f]+" ",e++);return e};ia.ChartBase.prototype._wrapText=function(a,b,c,d,e){for(var a=a.split(" "),f="",g=0;g<a.length;g++){var h=f+a[g]+" ";this.context.measureText(h).width>d?(this.context.fillText(f,b,c),f=a[g]+" ",c+=e):f=h}this.context.fillText(f,b,c)};
ia.ChartBase.prototype._getXAxisLabels=function(a,b,c,d,e){for(var f,g=!0,h=c;g;){f=this.useTightLabels?this._getTightLabels(a,b,h):this._getLooseLabels(a,b,h);var j=f.labels;f=f.values;c=j.length;if(c==3)g=!1;else{for(var i=0,m=0;m<c;m++){var k=this.context.measureText(j[m]).width+e*2;i+=k}i>d?h--:g=!1}}a=this.getBBox();a.setXMin(f[0]);a.setXMax(f[f.length-1]);return j};
ia.ChartBase.prototype._adjustXLabels=function(a,b,c){for(var d=[],e={},f=0;f<a.length;f++){var g=a[f];d[f]=g;e[g]=g}for(var h=!0;h;){f=0;for(g in e)f++;if(f<=2){for(f=0;f<a.length;f++)d[f]="";d[0]=a[0];d[d.length-1]=a[a.length-1];h=!1}else{f=0;for(g in e){var j=this.context.measureText(g).width+c*2;f+=j}if(f>b){j=0;for(g in e)j%2==0&&delete e[g],j++;for(f=0;f<a.length;f++)g=a[f],e[g]||(j=d.indexOf(g),j!=-1&&(d[j]=""))}else h=!1}}return d};
ia.ChartBase.prototype._getYAxisLabels=function(a,b,c,d,e){for(var f,g=!0,h=c;g;){f=this.useTightLabels?this._getTightLabels(a,b,h):this._getLooseLabels(a,b,h);var j=f.labels;f=f.values;c=j.length;c==3?g=!1:d/c<e?h--:g=!1}a=this.getBBox();a.setYMin(f[0]);a.setYMax(f[f.length-1]);return j};ia.ChartBase.prototype.getAxisValues=function(a,b,c){var d=[];if(c<=2)d=[a,b];else for(var e=(b-a)/(c-1),f=0;f<c;f++)d[f]=f==c-1?b:a,a+=e;return d};
ia.ChartBase.prototype._getLooseLabels=function(a,b,c){for(var d=ia.getNiceNum(b-a,!1),c=ia.getNiceNum(d/(c-1),!0),a=Math.floor(a/c)*c,b=Math.ceil(b/c)*c,d=Math.max(-1*Math.floor(ia.log10(c)),0),e=[],f=[];a<b+0.5*c;a+=c)e[e.length]=ia.round(a,d),f[f.length]=this.formatter.format(ia.round(a,d));return{values:e,labels:f}};
ia.ChartBase.prototype._getTightLabels=function(a,b,c){var d=(b-a)/(c-1),e=parseFloat(a),f=[];f.push(a);for(a=1;a<c-1;a++)e+=d,f.push(e);f.push(b);b=[];d=ia.getPrecision(f);for(a=0;a<c;a++)b.push(this.formatter.format(f[a],d));return{values:f,labels:b}};ia.BarChart=function(a){ia.BarChart.baseConstructor.call(this,a);this.drawBarsFromZero=!1};ia.extend(ia.ChartBase,ia.BarChart);
ia.BarChart.prototype.render=function(){this.clear();for(var a=Infinity,b=-Infinity,c=this.getLayers(),d=0;d<c.length;d++){var e=c[d];e.update();a=Math.min(a,e.minValue);b=Math.max(b,e.maxValue)}if(this.useFixedValues)a=this.fixedMinValue,b=this.fixedMaxValue;this.drawBarsFromZero&&(b<0&&(b=0),a>0&&(a=0));a==b&&(b<0?b=0:a=0);if(a==Infinity||b==-Infinity)a=0,b=100;d=this.getBBox();this.orientation=="vertical"?(this.showXAxisLabels=!1,this.showYAxisLabels=!0,this.showXAxisGrid=!1,this.showYAxisGrid=
!0,this.renderAxes(d.getXMin(),d.getXMax(),a,b)):(this.showXAxisLabels=!0,this.showYAxisLabels=!1,this.showXAxisGrid=!0,this.showYAxisGrid=!1,this.renderAxes(a,b,d.getYMin(),d.getYMax()));for(d=0;d<c.length;d++)c[d].render()};ia.PyramidChart=function(a){ia.PyramidChart.baseConstructor.call(this,a);this.drawBarsFromZero=!1;this.isPyramidChart=!0};ia.extend(ia.ChartBase,ia.PyramidChart);
ia.PyramidChart.prototype.render=function(){this.clear();for(var a=Infinity,b=-Infinity,c=this.getLayers(),d=0;d<c.length;d++){var e=c[d];e.update(this.date);a=Math.min(a,e.minValue);b=Math.max(b,e.maxValue)}if(this.useFixedValues)a=this.fixedMinValue,b=this.fixedMaxValue;this.drawBarsFromZero&&(b<0&&(b=0),a>0&&(a=0));a==b&&(b<0?b=0:a=0);if(a==Infinity||b==-Infinity)a=0,b=100;Math.abs(a)>b?b=Math.abs(a):a=b*-1;d=this.getBBox();this.showXAxisGrid=this.showXAxisLabels=this.centerYAxisLabels=!0;this.showYAxisGrid=
!1;this.renderAxes(a,b,d.getYMin(),d.getYMax());for(d=0;d<c.length;d++)c[d].render()};ia.TimeChart=function(a){ia.TimeChart.baseConstructor.call(this,a)};ia.extend(ia.ChartBase,ia.TimeChart);
ia.TimeChart.prototype.render=function(){this.clear();for(var a=Infinity,b=-Infinity,c=this.getLayers(),d=0;d<c.length;d++){var e=c[d];e.update();a=Math.min(a,e.minValue);b=Math.max(b,e.maxValue)}if(this.useFixedValues)a=this.fixedMinValue,b=this.fixedMaxValue;a==b&&(b<0?b=0:a=0);if(a==Infinity||b==-Infinity)a=0,b=100;d=this.getBBox();this.orientation=="vertical"?(this.centerXAxisLabels=!0,this.showXAxisGrid=this.centerYAxisLabels=!1,this.showYAxisGrid=!0,this.renderAxes(d.getXMin(),d.getXMax(),a,
b)):(this.centerXAxisLabels=!1,this.showXAxisGrid=this.centerYAxisLabels=!0,this.showYAxisGrid=!1,this.renderAxes(a,b,d.getYMin(),d.getYMax()));for(d=0;d<c.length;d++)c[d].render()};ia.PieChart=function(a){ia.PieChart.baseConstructor.call(this,a)};ia.extend(ia.ChartBase,ia.PieChart);ia.PieChart.prototype.render=function(){this.clear();for(var a=this.getLayers(),b=0;b<a.length;b++){var c=a[b];c.update();c.render()}};ia.BoxChart=function(a){ia.BoxChart.baseConstructor.call(this,a)};
ia.extend(ia.ChartBase,ia.BoxChart);
ia.BoxChart.prototype.render=function(){this.clear();for(var a=Infinity,b=-Infinity,c=this.getLayers(),d=0;d<c.length;d++){var e=c[d];e.update();a=Math.min(a,e.minValue);b=Math.max(b,e.maxValue)}if(this.useFixedValues)a=this.fixedMinValue,b=this.fixedMaxValue;a==b&&(b<0?b=0:a=0);if(a==Infinity||b==-Infinity)a=0,b=100;d=this.getBBox();this.orientation=="vertical"?(this.showXAxisLabels=!1,this.showYAxisLabels=!0,this.renderAxes(d.getXMin(),d.getXMax(),a,b)):(this.showXAxisLabels=!0,this.showYAxisLabels=
!1,this.renderAxes(a,b,d.getYMin(),d.getYMax()));for(d=0;d<c.length;d++)c[d].render()};ia.TimeBarChart=function(a){ia.TimeBarChart.baseConstructor.call(this,a);this.drawBarsFromZero=!1};ia.extend(ia.ChartBase,ia.TimeBarChart);
ia.TimeBarChart.prototype.render=function(){this.clear();for(var a=Infinity,b=-Infinity,c=this.getLayers(),d=0;d<c.length;d++){var e=c[d];e.update();a=Math.min(a,e.minValue);b=Math.max(b,e.maxValue)}if(this.useFixedValues)a=this.fixedMinValue,b=this.fixedMaxValue;this.drawBarsFromZero&&(b<0&&(b=0),a>0&&(a=0));a==b&&(b<0?b=0:a=0);if(a==Infinity||b==-Infinity)a=0,b=100;d=this.getBBox();this.orientation=="vertical"?(this.centerXAxisLabels=!0,this.centerYAxisLabels=!1,this.renderAxes(d.getXMin(),d.getXMax(),
a,b)):(this.centerXAxisLabels=!1,this.centerYAxisLabels=!0,this.renderAxes(a,b,d.getYMin(),d.getYMax()));for(d=0;d<c.length;d++)c[d].render()};ia.Plot=function(a){ia.Plot.baseConstructor.call(this,a)};ia.extend(ia.ChartBase,ia.Plot);
ia.Plot.prototype.render=function(){this.clear();for(var a=Infinity,b=-Infinity,c=Infinity,d=-Infinity,e=this.getLayers(),f=0;f<e.length;f++){var g=e[f];g.update();a=Math.min(a,g.xMinValue);b=Math.max(b,g.xMaxValue);c=Math.min(c,g.yMinValue);d=Math.max(d,g.yMaxValue)}if(this.useFixedValues)a=this.fixedMinValue,b=this.fixedMaxValue,c=this.fixedMinValue,d=this.fixedMaxValue;a==b&&(b<0?b=0:a=0);c==d&&(d<0?d=0:c=0);if(a==Infinity||b==-Infinity)a=0,b=100;if(c==Infinity||d==-Infinity)c=0,d=100;this.renderAxes(a,
b,c,d);for(f=0;f<e.length;f++)e[f].render()};ia.LayerBase=function(){ia.LayerBase.baseConstructor.call(this);this.showLabels=this.interactive=this.isLoaded=this.showInLayerList=this._visible=!1;this.showDataTips=!0};ia.extend(ia.EventDispatcher,ia.LayerBase);ia.LayerBase.prototype.loadSource=function(){this.isLoaded=!0;this.dispatchEvent(new ia.Event(ia.Event.LAYER_READY,this))};ia.LayerBase.prototype.getVisible=function(){return this._visible};
ia.LayerBase.prototype.setVisible=function(a){this._visible=a;this.map&&(this._visible?(this.addCanvases(),this.render()):this.removeCanvases());this.dispatchEvent(new ia.Event(ia.Event.LAYER_VISIBLE_CHANGED,this))};
ia.LayerBase.prototype.setMap=function(a,b){this.map=a;var c=this;this._canvasContainer=$j("<div>");b.append(this._canvasContainer);if(this.interactive||this.showDataTips)a.addEventListener(ia.MapMouseEvent.MAP_MOUSE_MOVE,this._mapEventHandler.bind(this)),a.addEventListener(ia.MapMouseEvent.MAP_MOUSE_OVER,this._mapEventHandler.bind(this)),a.addEventListener(ia.MapMouseEvent.MAP_MOUSE_OUT,this._mapEventHandler.bind(this)),a.addEventListener(ia.MapMouseEvent.MAP_MOUSE_CLICK,this._mapEventHandler.bind(this)),
a.addEventListener(ia.MapMouseEvent.MAP_MOUSE_DOWN,this._mapEventHandler.bind(this)),a.addEventListener(ia.MapMouseEvent.MAP_MOUSE_UP,this._mapEventHandler.bind(this)),a.addEventListener(ia.MapMouseEvent.MAP_MOUSE_WHEEL_END,this._mapEventHandler.bind(this)),$j("body").bind("touchend",function(){c.hideTip();c.clearHighlight()});a.addEventListener(ia.Event.MAP_RESIZE,function(){var a=c.map.container.width(),b=c.map.container.height();if(c.canvas)c.canvas.width=a,c.canvas.height=b;if(c.selectionCanvas)c.selectionCanvas.width=
a,c.selectionCanvas.height=b;if(c.highlightCanvas)c.highlightCanvas.width=a,c.highlightCanvas.height=b;if(c.showLabels)c.labelCanvas.width=a,c.labelCanvas.height=b});this._visible&&this.addCanvases()};
ia.LayerBase.prototype.addCanvases=function(){var a=this.map.container.width(),b=this.map.container.height();if(this.canvas==void 0)this.canvas=this.createCanvas(this._canvasContainer),this.context=this.canvas.getContext("2d"),this.canvas.width=a,this.canvas.height=b;if(this.interactive){if(this.selectionCanvas==void 0)this.selectionCanvas=this.createCanvas(this.map.foregroundContainer),this.selectionContext=this.selectionCanvas.getContext("2d"),this.selectionCanvas.width=a,this.selectionCanvas.height=
b;if(this.highlightCanvas==void 0)this.highlightCanvas=this.createCanvas(this.map.foregroundContainer),this.highlightContext=this.highlightCanvas.getContext("2d"),this.highlightCanvas.width=a,this.highlightCanvas.height=b}if(this.showLabels&&this.labelCanvas==void 0)this.labelCanvas=this.createCanvas(this._canvasContainer),this.labelContext=this.labelCanvas.getContext("2d"),this.labelCanvas.width=a,this.labelCanvas.height=b,this._setLabelStyle()};
ia.LayerBase.prototype.removeCanvases=function(){if(this.canvas!=void 0)$j(this.canvas).remove(),this.canvas=void 0;if(this.selectionCanvas!=void 0)$j(this.selectionCanvas).remove(),this.selectionCanvas=void 0;if(this.highlightCanvas!=void 0)$j(this.highlightCanvas).remove(),this.highlightCanvas=void 0;if(this.labelCanvas!=void 0)$j(this.labelCanvas).remove(),this.labelCanvas=void 0};ia.LayerBase.prototype._mapEventHandler=function(){};
ia.LayerBase.prototype.createCanvas=function(a){var b=document.createElement("canvas");b.width=a.width();b.height=a.height();$j(b).css({position:"absolute",left:0,top:0});a.append($j(b));return b};ia.LayerBase.prototype.render=function(){};ia.LayerBase.prototype.clear=function(){this.canvas&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height)};
ia.ItemEvent=function(a,b,c,d,e,f,g,h){ia.ItemEvent.baseConstructor.call(this,a,b);this.item=b;this.x=c;this.y=d;this.dataX=e;this.dataY=f;this.pageX=g;this.pageY=h};ia.extend(ia.Event,ia.ItemEvent);ia.ItemEvent.NONE_ITEM_CLICK="noneItemClick";ia.ItemEvent.ITEM_CLICK="itemClick";ia.ItemEvent.ITEM_MOUSE_DOWN="itemMouseDown";ia.ItemEvent.ITEM_MOUSE_UP="itemMouseUp";ia.ItemEvent.ITEM_MOUSE_MOVE="itemMouseMove";ia.ItemEvent.ITEM_MOUSE_OVER="itemMouseOver";ia.ItemEvent.ITEM_MOUSE_OUT="itemMouseOut";
ia.ItemLayer=function(){ia.ItemLayer.baseConstructor.call(this);this._data={};this._rollOverItem=void 0;this._redrawSelectionTimeout=null;this.items={};this.itemArray=[];this.doHitTest=!0;this.style={fillStyle:"#ffffff",strokeStyle:"#bbbbbb",lineWidth:"1",lineJoin:"round"};this.selectionColor="#ff0000";this.highlightColor="#00ff00";this.selectionIds=[];this.dataField="value";this.dataChanged=!1;this.tip=""};ia.extend(ia.LayerBase,ia.ItemLayer);ia.ItemLayer.SELECTED="selected";
ia.ItemLayer.ROLLOVER_SELECTED="rollOverSelected";ia.ItemLayer.ROLLOVER="rollOver";ia.ItemLayer.UNSELECTED="unselected";ia.ItemLayer.prototype.getData=function(){return this._data};ia.ItemLayer.prototype.setData=function(a){this._data=a;this.dataChanged=!0};
ia.ItemLayer.prototype._setLabelStyle=function(){var a="Verdana",b=10,c="normal",d="#ffffff",e="#333333";this.map.labelStyle&&(this.map.labelStyle.css("font-family")&&(a=this.map.labelStyle.css("font-family")),this.map.labelStyle.css("color")&&(d=ia.Color.toHex(this.map.labelStyle.css("color"))),this.map.labelStyle.css("font-weight")&&(c=this.map.labelStyle.css("font-weight")),this.map.labelStyle.css("font-size")&&(b=this.map.labelStyle.css("font-size"),b.indexOf("px")>-1&&(b=b.substring(0,b.indexOf("px"))),
b=ia.parseInt(b)),this.map.labelStyle.css("borderRightColor")&&(e=ia.Color.toHex(this.map.labelStyle.css("borderRightColor"))));this.labelContext.font=c+" "+b+"px "+a;this.labelContext.lineWidth=2;this.labelContext.strokeStyle=e;this.labelContext.fillStyle=d};ia.ItemLayer.prototype.getItem=function(a){return this.items[a]};ia.ItemLayer.prototype.clearItems=function(){for(var a in this.items)delete this.items[a]};
ia.ItemLayer.prototype._mapEventHandler=function(a){a.type==ia.MapMouseEvent.MAP_MOUSE_OVER?this.doHitTest=!0:a.type==ia.MapMouseEvent.MAP_MOUSE_OUT?(this._hitTest(a),this.doHitTest=!1):this.doHitTest&&this._hitTest(a)};
ia.ItemLayer.prototype._hitTest=function(a){if((this.showDataTips||this.interactive)&&this.getVisible()){var b=a.type;if(b==ia.MapMouseEvent.MAP_MOUSE_MOVE||b==ia.MapMouseEvent.MAP_MOUSE_DOWN){for(var b=[],c=this.itemArray.length-1;c>=0;c--){var d=this.itemArray[c];d.disabled!=!0&&this.hitItem(d,a)&&(b[b.length]=d)}if(b.length>0)b[0].size&&b.sort(function(a,b){return a.size<b.size?-1:a.size>b.size?1:0}),d=b[0],this._rollOverItem&&d!=this._rollOverItem&&this._dispatchItemEvent(a,!1,this._rollOverItem),
this._rollOverItem=d,this._dispatchItemEvent(a,!0,this._rollOverItem);else if(this._rollOverItem)this._dispatchItemEvent(a,!1,this._rollOverItem),this._rollOverItem=null}else this._rollOverItem!=null?this._dispatchItemEvent(a,!0,this._rollOverItem):b==ia.MapMouseEvent.MAP_MOUSE_CLICK&&(ia.IS_TOUCH_DEVICE||this.dispatchEvent(new ia.ItemEvent(ia.ItemEvent.NONE_ITEM_CLICK,{parent:this})))}};ia.ItemLayer.prototype.hitItem=function(){return!1};
ia.ItemLayer.prototype._dispatchItemEvent=function(a,b,c){var d=c.state,e=a.type,f;if(b)if(e==ia.MapMouseEvent.MAP_MOUSE_MOVE)f=d==ia.ItemLayer.ROLLOVER||d==ia.ItemLayer.ROLLOVER_SELECTED?ia.ItemEvent.ITEM_MOUSE_MOVE:ia.ItemEvent.ITEM_MOUSE_OVER;else if(e==ia.MapMouseEvent.MAP_MOUSE_CLICK)f=ia.ItemEvent.ITEM_CLICK;else if(e==ia.MapMouseEvent.MAP_MOUSE_UP)f=ia.ItemEvent.ITEM_MOUSE_UP;else if(e==ia.MapMouseEvent.MAP_MOUSE_DOWN)f=ia.ItemEvent.ITEM_MOUSE_DOWN;else if(e==ia.MapMouseEvent.MAP_MOUSE_OUT)if(d==
ia.ItemLayer.ROLLOVER)f=ia.ItemEvent.ITEM_MOUSE_OUT;else{if(d==ia.ItemLayer.ROLLOVER_SELECTED)f=ia.ItemEvent.ITEM_MOUSE_OUT}else{if(e==ia.MapMouseEvent.MAP_MOUSE_WHEEL_END)f=ia.ItemEvent.ITEM_MOUSE_OVER}else if(e==ia.MapMouseEvent.MAP_MOUSE_MOVE&&(d==ia.ItemLayer.ROLLOVER||d==ia.ItemLayer.ROLLOVER_SELECTED))f=ia.ItemEvent.ITEM_MOUSE_OUT;if(f==ia.ItemEvent.ITEM_MOUSE_OVER)if(d==ia.ItemLayer.UNSELECTED)c.state=ia.ItemLayer.ROLLOVER;else{if(d==ia.ItemLayer.SELECTED)c.state=ia.ItemLayer.ROLLOVER_SELECTED}else if(f==
ia.ItemEvent.ITEM_CLICK)c.state=d==ia.ItemLayer.ROLLOVER_SELECTED||d==ia.ItemLayer.SELECTED?ia.ItemLayer.UNSELECTED:ia.ItemLayer.ROLLOVER_SELECTED;else if(f==ia.ItemEvent.ITEM_MOUSE_OUT)if(d==ia.ItemLayer.ROLLOVER)c.state=ia.ItemLayer.UNSELECTED;else if(d==ia.ItemLayer.ROLLOVER_SELECTED)c.state=ia.ItemLayer.SELECTED;a=new ia.ItemEvent(f,c,a.x,a.y,a.dataX,a.dataY,a.pageX,a.pageY);this._itemEventHandler(a);f!=null&&this.dispatchEvent(a)};
ia.ItemLayer.prototype._itemEventHandler=function(a){var b=a.item;this.interactive&&(a.type==ia.ItemEvent.ITEM_MOUSE_OVER?(ia.showPointerCursor(),this.clearHighlight(),this.highlightItem(b,this.highlightContext)):a.type==ia.ItemEvent.ITEM_MOUSE_DOWN&&ia.IS_TOUCH_DEVICE&&(this.clearHighlight(),this.highlightItem(b,this.highlightContext)),a.type==ia.ItemEvent.ITEM_CLICK?(b.state==ia.ItemLayer.UNSELECTED?(this._removeFromSelection(b.id),this.renderSelection()):(this._addToSelection(b.id),this.selectItem(b)),
this.clearHighlight()):a.type==ia.ItemEvent.ITEM_MOUSE_OUT?(ia.showDefaultCursor(),this.clearHighlight()):a.type==ia.ItemEvent.ITEM_MOUSE_UP?this.clearHighlight():a.type==ia.ItemEvent.NONE_ITEM_CLICK&&this.clearSelection());this.showDataTips&&(a.type==ia.ItemEvent.ITEM_MOUSE_OVER?this.showTip(b,a):a.type==ia.ItemEvent.ITEM_MOUSE_DOWN?ia.IS_TOUCH_DEVICE&&this.showTip(b,a):a.type==ia.ItemEvent.ITEM_MOUSE_MOVE?ia.IS_TOUCH_DEVICE||this.showTip(b,a):a.type==ia.ItemEvent.ITEM_MOUSE_OUT?ia.IS_TOUCH_DEVICE||
this.hideTip():a.type==ia.ItemEvent.ITEM_MOUSE_UP?this.hideTip():a.type==ia.ItemEvent.ITEM_CLICK&&this.hideTip())};ia.ItemLayer.prototype.tipFunction=function(a){return a.name};ia.ItemLayer.prototype.showTip=function(){};ia.ItemLayer.prototype.hideTip=function(){this.map.datatip.hide()};ia.ItemLayer.prototype._removeFromSelection=function(a){a=this.selectionIds.indexOf(a);a!=-1&&this.selectionIds.splice(a,1)};ia.ItemLayer.prototype._addToSelection=function(a){this.selectionIds.indexOf(a)==-1&&this.selectionIds.push(a)};
ia.ItemLayer.prototype.isSelected=function(a){return this.selectionIds.indexOf(a)!=-1?!0:!1};ia.ItemLayer.prototype.selectAll=function(){this.clearSelection();for(var a in this.items)this.select(a)};ia.ItemLayer.prototype.select=function(a){var b=this.getItem(a);if(b)b.state=ia.ItemLayer.SELECTED,this._addToSelection(a),this.selectItem(b)};ia.ItemLayer.prototype.unselect=function(a){var b=this.getItem(a);if(b)b.state=ia.ItemLayer.UNSELECTED,this._removeFromSelection(a),this._triggerRenderSelection()};
ia.ItemLayer.prototype.clearSelection=function(){this.selectionIds=[];for(var a in this.items){var b=this.items[a];if(b)b.state=ia.ItemLayer.UNSELECTED}this._clearSelectionGraphics()};ia.ItemLayer.prototype._triggerRenderSelection=function(){if(!this._redrawSelectionTimeout)this._redrawSelectionTimeout=setTimeout(function(){this.renderSelection()}.bind(this),5)};
ia.ItemLayer.prototype.renderSelection=function(){this._redrawSelectionTimeout=null;this._clearSelectionGraphics();for(var a=this.selectionIds.length,b=0;b<a;b++){var c=this.items[this.selectionIds[b]];c&&this.selectItem(c)}};ia.ItemLayer.prototype.selectItem=function(){};ia.ItemLayer.prototype.highlight=function(a){(a=this.getItem(a))&&this.highlightItem(a)};ia.ItemLayer.prototype.clearHighlight=function(){this._clearHighlightGraphics()};ia.ItemLayer.prototype.highlightItem=function(){};
ia.ItemLayer.prototype.clear=function(){this._rollOverItem=null;this._clearHighlightGraphics();this._clearSelectionGraphics();this._clearLayerGraphics();this._clearLabelGraphics()};ia.ItemLayer.prototype._clearCanvas=function(a,b){a&&b.clearRect(0,0,a.width,a.height)};ia.ItemLayer.prototype._clearHighlightGraphics=function(){this.interactive&&this._clearCanvas(this.highlightCanvas,this.highlightContext)};
ia.ItemLayer.prototype._clearSelectionGraphics=function(){this.interactive&&this._clearCanvas(this.selectionCanvas,this.selectionContext)};ia.ItemLayer.prototype._clearLabelGraphics=function(){this.showLabels&&(this._clearCanvas(this.labelCanvas,this.labelContext),this._setLabelStyle())};ia.ItemLayer.prototype._clearLayerGraphics=function(){this._clearCanvas(this.canvas,this.context)};
ia.TimeLayer=function(){ia.TimeLayer.baseConstructor.call(this);this.style={fillStyle:"#ffffff",strokeStyle:"#ff0000",lineWidth:"2",lineJoin:"round"};this.selectedDate="";this.drawLinesThroughMissingValues=!0};ia.extend(ia.ItemLayer,ia.TimeLayer);
ia.TimeLayer.prototype.update=function(){if(this.map&&this.dataChanged){var a=this.getData();this.itemArray=[];this.clearItems();this.minValue=Infinity;this.maxValue=-Infinity;if(a.dates){var b=a[a.dates[0]],c=a.dates.length,d;for(d in b){var e=b[d],f={};f.id=e.id;f.name=e.name;f.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(f.id)!=-1)f.state=ia.ItemLayer.SELECTED;f.parent=this;f.layer=this;this.items[e.id]=f;this.itemArray.push(f);f.childItems=[];for(var g=0;g<c;g++){var h=a.dates[g],
e=a[h][d],j=e[this.dataField];if(ia.isNumber(j)){var i={};i.id=d+"~"+h;i.name=h;i.shape=new ia.Rectangle;i.hitArea=new ia.Rectangle;i.value=j;i.formattedValue=e[this.dataField+"_formatted"];if(this.isComparison){if(this.selectionIds.indexOf(f.id)!=-1)this.minValue=Math.min(this.minValue,j),this.maxValue=Math.max(this.maxValue,j),f.state=ia.ItemLayer.SELECTED;if(this.displayAll)this.minValue=Math.min(this.minValue,j),this.maxValue=Math.max(this.maxValue,j)}else if(this.matchAxisToSelectedData==!1||
this.matchAxisToSelectedData==!0&&f.state==ia.ItemLayer.SELECTED)this.minValue=Math.min(this.minValue,i.value),this.maxValue=Math.max(this.maxValue,i.value);f.childItems[f.childItems.length]=i}else f.childItems[f.childItems.length]={name:h,value:void 0}}}}this.dataChanged=!1}};
ia.TimeLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.selectionContext[a]=this.style[a],this.highlightContext[a]=this.style[a];this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor);this.selectionContext.strokeStyle=ia.Color.toRGBA(this.selectionColor);a=this.itemArray.length;for(var b=0;b<a;b++)for(var c=this.itemArray[b],d=c.childItems.length,e=0;e<d;e++){var f=c.childItems[e];f.value!=void 0&&this._setItemShape(f,e,d)}this.renderSelection()};
ia.TimeLayer.prototype._setItemShape=function(a,b,c){if(this.map.orientation=="vertical"){var d=this.map.canvasX,e=this.map.canvasWidth;if(this.map.centerXAxisLabels)var f=this.map.canvasWidth/(c*2),d=this.map.canvasX+f,e=this.map.canvasWidth-f*2;d+=b/(c-1)*e;b=this.map.getPixelY(a.value)}else e=this.map.canvasY,f=this.map.canvasHeight,this.map.centerYAxisLabels&&(f=this.map.canvasHeight/(c*2),e=this.map.canvasY+f,f=this.map.canvasHeight-f*2),d=this.map.getPixelX(a.value),b=e+b/(c-1)*f;e=c=10;a.shape.x=
d;a.shape.y=b;a.shape.width=c;a.shape.height=e;ia.IS_TOUCH_DEVICE&&(e=c=30);a.hitArea.x=d-c/2;a.hitArea.y=b-e/2;a.hitArea.width=c;a.hitArea.height=e};ia.TimeLayer.prototype.selectItem=function(a){var b=this.selectionIds.length;if(this.colorPalette){var b=this.colorPalette.getColors(b),c=this.selectionIds.indexOf(a.id);this.selectionContext.strokeStyle=b[c]}this._drawItem(a,this.selectionContext)};
ia.TimeLayer.prototype.highlightItem=function(a){ia.IS_IE_TEN||(this.highlightContext.beginPath(),this.highlightContext.rect(this.map.canvasX,this.map.canvasY,this.map.canvasWidth,this.map.canvasHeight),this.highlightContext.clip());this._drawItem(a,this.highlightContext)};
ia.TimeLayer.prototype._drawItem=function(a,b){var c=!0,d=a.childItems.length;b.beginPath();for(var e=0;e<d;e++){var f=a.childItems[e];f.value!=void 0?(c?b.moveTo(f.shape.x,f.shape.y):b.lineTo(f.shape.x,f.shape.y),c=!1):this.drawLinesThroughMissingValues||(c=!0);if(this.animationMode&&f.name==this.selectedDate)break}b.stroke();for(e=0;e<d;e++)if(f=a.childItems[e],f.value!=void 0&&(b.beginPath(),ia.Shape.drawCircle(b,f.shape.x,f.shape.y,7),b.fill(),b.stroke()),this.animationMode&&f.name==this.selectedDate)break};
ia.TimeLayer.prototype.hitItem=function(a,b){if(this.isSelected(a.id))for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];if(e.value!=void 0&&e.hitArea.intersects(b.x,b.y))return!0}return!1};
ia.TimeLayer.prototype.showTip=function(a,b){for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];if(e.value!=void 0&&e.hitArea.intersects(b.x,b.y)){this.tip!=""?(c=this.tip,c=c.split("${name}").join(a.name),c=c.split("${date}").join(e.name),c=c.split("${value}").join(e.formattedValue),this.map.datatip.text(c)):this.map.datatip.text(a.name+" : "+e.name+" : "+e.formattedValue);ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,e=b.y-(this.map.datatip.getHeight()+30)):(c=e.shape.x+
e.shape.width/2-this.map.datatip.getWidth()/2,e=e.shape.y-e.shape.height/2-(this.map.datatip.getHeight()+5));this.map.datatip.position(c,e);this.map.datatip.show();break}}};ia.BarLayer=function(){ia.BarLayer.baseConstructor.call(this);this._maxBarWidth=20;this._barSize=this._minBarWidthForStroke=10;this.sortDirection="ascending"};ia.extend(ia.ItemLayer,ia.BarLayer);
ia.BarLayer.prototype.update=function(){if(this.map&&this.dataChanged){var a=this.getData();this.itemArray=[];this.clearItems();this.minValue=Infinity;this.maxValue=-Infinity;for(var b in a){var c=a[b],d=c[this.dataField];if(ia.isNumber(d)){this.minValue=Math.min(this.minValue,d);this.maxValue=Math.max(this.maxValue,d);var e={};e.id=c.id;e.name=c.name;e.color=c.color;e.value=d;e.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(e.id)!=-1)e.state=ia.ItemLayer.SELECTED;e.parent=this;e.layer=
this;e.rect=new ia.Rectangle;e.hitArea=new ia.Rectangle;this.items[b]=e;this.itemArray.push(e);if(c.upperLimit&&c.lowerLimit&&ia.isNumber(c.upperLimit)&&ia.isNumber(c.lowerLimit))e.upperLimit=c.upperLimit,e.lowerLimit=c.lowerLimit,this.maxValue=Math.max(this.maxValue,e.upperLimit),this.minValue=Math.min(this.minValue,e.lowerLimit)}}if(this.sortDirection!=void 0){var f;f=this.sortDirection=="ascending"?1:-1;this.itemArray.sort(function(a,b){return a.value<b.value?-f:a.value>b.value?f:0})}this.dataChanged=
!1}};
ia.BarLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.selectionContext[a]=this.style[a],this.highlightContext[a]=this.style[a];this.selectionContext.strokeStyle=this.selectionColor;this.selectionContext.lineWidth=parseFloat(this.style.lineWidth)+1;this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor,0.8);this.highlightContext.lineWidth=parseFloat(this.style.lineWidth)+1;a=this.itemArray.length;this._barSize=this.map.orientation=="vertical"?
this.map.canvasWidth/a:this.map.canvasHeight/a;this._barSize>=this._minBarWidthForStroke?(this.selectionContext.fillStyle="rgba(0, 0, 0, 0)",this.highlightContext.fillStyle=ia.Color.toRGBA(this.highlightColor,0.3)):(this.selectionContext.fillStyle=ia.Color.toRGBA(this.selectionColor),this.highlightContext.fillStyle=ia.Color.toRGBA(this.highlightColor));for(var b=0;b<a;b++){var c=this.itemArray[b];this._setItemShape(c,b);this._renderItem(c)}this.renderSelection()};
ia.BarLayer.prototype._setItemShape=function(a,b){if(this.map.orientation=="vertical"){var c=this.itemArray.length,d,e;this.map.getBBox().getYMin()<0?(d=a.value<0?this.map.getPixelY(0):this.map.getPixelY(a.value),e=this.map.getPixelHeight(Math.abs(a.value))):(d=this.map.getPixelY(a.value),e=this.map.getPixelHeight(Math.abs(a.value)-this.map.getBBox().getYMin()));a.value<this.map.getBBox().getYMin()&&(d=this.map.canvasY+this.map.canvasHeight,e-=this.map.getPixelHeight(Math.abs(a.value)-this.map.getBBox().getYMin()));
if(a.value>this.map.getBBox().getYMax())d=this.map.canvasY,e-=this.map.getPixelHeight(Math.abs(a.value)-this.map.getBBox().getYMax());a.rect.y=d;a.rect.height=e;a.rect.x=this.map.canvasX+b/c*this.map.canvasWidth;a.rect.width=this.map.canvasWidth/c;a.hitArea.x=a.rect.x;a.hitArea.y=this.map.canvasY;a.hitArea.width=a.rect.width;a.hitArea.height=this.map.canvasHeight;if(a.upperLimit&&a.lowerLimit)a.ul={},a.ll={},a.ul.x=a.rect.x+a.rect.width/2,a.ul.y=this.map.getPixelY(a.upperLimit),a.ll.x=a.rect.x+a.rect.width/
2,a.ll.y=this.map.getPixelY(a.lowerLimit);a.rect.width>this._maxBarWidth?(a.rect.x+=(a.rect.width-this._maxBarWidth)/2,a.rect.width=this._maxBarWidth):a.rect.width<this._minBarWidthForStroke&&a.rect.width++}else{c=this.itemArray.length;this.map.getBBox().getXMin()<0?(d=a.value<0?this.map.getPixelX(a.value):this.map.getPixelX(0),e=this.map.getPixelWidth(Math.abs(a.value))):(d=this.map.getPixelX(this.map.getBBox().getXMin()),e=this.map.getPixelWidth(Math.abs(a.value)-this.map.getBBox().getXMin()));
if(a.value<this.map.getBBox().getXMin())d=this.map.canvasX,e-=this.map.getPixelWidth(Math.abs(a.value)-Math.abs(this.map.getBBox().getXMin()));a.value>this.map.getBBox().getXMax()&&(e-=this.map.getPixelWidth(Math.abs(a.value)-Math.abs(this.map.getBBox().getXMax())));a.rect.x=d;a.rect.width=e;a.rect.y=this.map.canvasY+b/c*this.map.canvasHeight;a.rect.height=this.map.canvasHeight/c;a.hitArea.x=this.map.canvasX;a.hitArea.y=a.rect.y;a.hitArea.width=this.map.canvasWidth;a.hitArea.height=a.rect.height;
if(a.upperLimit&&a.lowerLimit)a.ul={},a.ll={},a.ul.x=this.map.getPixelX(a.upperLimit),a.ul.y=a.rect.y+a.rect.height/2,a.ll.x=this.map.getPixelX(a.lowerLimit),a.ll.y=a.rect.y+a.rect.height/2;a.rect.height>this._maxBarWidth?(a.rect.y+=(a.rect.height-this._maxBarWidth)/2,a.rect.height=this._maxBarWidth):a.rect.height<this._minBarWidthForStroke&&a.rect.height++}};ia.BarLayer.prototype._renderItem=function(a){this.context.fillStyle=a.color;this._drawItem(a,this.context)};
ia.BarLayer.prototype.selectItem=function(a){this._drawItem(a,this.selectionContext)};ia.BarLayer.prototype.highlightItem=function(a){this._drawItem(a,this.highlightContext)};
ia.BarLayer.prototype._drawItem=function(a,b){b.beginPath();b.rect(a.rect.x,a.rect.y,a.rect.width,a.rect.height);b.fill();this._barSize>=this._minBarWidthForStroke&&b.stroke();a.ul&&a.ll&&(b.beginPath(),b.moveTo(a.ul.x,a.ul.y),b.lineTo(a.ll.x,a.ll.y),this._barSize>=this._minBarWidthForStroke&&(this.map.orientation=="vertical"?(b.moveTo(a.rect.x,a.ul.y),b.lineTo(a.rect.x+a.rect.width,a.ul.y),b.moveTo(a.rect.x,a.ll.y),b.lineTo(a.rect.x+a.rect.width,a.ll.y)):(b.moveTo(a.ul.x,a.rect.y),b.lineTo(a.ul.x,
a.rect.y+a.rect.height),b.moveTo(a.ll.x,a.rect.y),b.lineTo(a.ll.x,a.rect.y+a.rect.height))),b.stroke())};ia.BarLayer.prototype.hitItem=function(a,b){return a.hitArea.intersects(b.x,b.y)};
ia.BarLayer.prototype.showTip=function(a,b){this.map.datatip.text(this.tipFunction(a));var c,d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):this.map.orientation=="vertical"?(c=a.rect.x+a.rect.width/2-this.map.datatip.getWidth()/2,d=a.value<0?a.rect.y+a.rect.height+5:a.rect.y-this.map.datatip.getHeight()-5):(c=a.value<0?a.rect.x-(this.map.datatip.getWidth()+5):a.rect.x+a.rect.width+5,d=a.rect.y+a.rect.height/2-this.map.datatip.getHeight()/2);this.map.datatip.position(c,
d);this.map.datatip.show()};ia.PyramidLayer=function(){ia.PyramidLayer.baseConstructor.call(this);this._maxBarWidth=20;this._barSize=this._minBarWidthForStroke=10;this.sortDirection="ascending";this.gender="male"};ia.extend(ia.ItemLayer,ia.PyramidLayer);
ia.PyramidLayer.prototype.update=function(a){if(this.map){var b=this.getData();this.itemArray=[];this.clearItems();this.minValue=Infinity;this.maxValue=-Infinity;for(var c=0;c<b.length;c++){var d=b[c],e=d.features[0];if(e){var f=e[this.dataField];if(ia.isNumber(f))this.gender=="female"&&(f*=-1),this.minValue=Math.min(this.minValue,f),this.maxValue=Math.max(this.maxValue,f);if(a==void 0||d.date==a){var g={};g.id=e.id;g.name=e.name;g.ageGroup=d.name;g.value=ia.isNumber(f)?f:0;g.formattedValue=e[this.dataField+
"_formatted"];g.parent=this;g.layer=this;g.state=ia.ItemLayer.UNSELECTED;g.rect=new ia.Rectangle;g.hitArea=new ia.Rectangle;this.items[g.id]=g;this.itemArray.push(g)}}}this.itemArray.reverse()}};
ia.PyramidLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.highlightContext[a]=this.style[a];this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor,0.8);this.highlightContext.lineWidth=parseFloat(this.style.lineWidth)+1;a=this.itemArray.length;this._barSize=this.map.canvasHeight/a;this.highlightContext.fillStyle=this._barSize>=this._minBarWidthForStroke?ia.Color.toRGBA(this.highlightColor,0.3):ia.Color.toRGBA(this.highlightColor);
for(var b=0;b<a;b++){var c=this.itemArray[b];this._setItemShape(c,b);this._renderItem(c)}};
ia.PyramidLayer.prototype._setItemShape=function(a,b){var c=this.itemArray.length,d,e;this.map.getBBox().getXMin()<0?(d=a.value<0?this.map.getPixelX(a.value):this.map.getPixelX(0),e=this.map.getPixelWidth(Math.abs(a.value))):(d=this.map.getPixelX(this.map.getBBox().getXMin()),e=this.map.getPixelWidth(Math.abs(a.value)-this.map.getBBox().getXMin()));if(a.value<this.map.getBBox().getXMin())d=this.map.canvasX,e-=this.map.getPixelWidth(Math.abs(a.value)-Math.abs(this.map.getBBox().getXMin()));a.value>
this.map.getBBox().getXMax()&&(e-=this.map.getPixelWidth(Math.abs(a.value)-Math.abs(this.map.getBBox().getXMax())));a.rect.x=d;a.rect.width=e;a.rect.y=this.map.canvasY+b/c*this.map.canvasHeight;a.rect.height=this.map.canvasHeight/c;a.hitArea.x=this.gender=="female"?this.map.canvasX:a.rect.x;a.hitArea.y=a.rect.y;a.hitArea.width=this.map.canvasWidth/2;a.hitArea.height=a.rect.height;a.rect.height<this._minBarWidthForStroke&&a.rect.height++};
ia.PyramidLayer.prototype._renderItem=function(a){this._drawItem(a,this.context)};ia.PyramidLayer.prototype.highlightItem=function(a){this._drawItem(a,this.highlightContext)};ia.PyramidLayer.prototype._drawItem=function(a,b){b.beginPath();b.rect(a.rect.x,a.rect.y,a.rect.width,a.rect.height);b.fill();this._barSize>=this._minBarWidthForStroke&&b.stroke()};ia.PyramidLayer.prototype.hitItem=function(a,b){return a.hitArea.intersects(b.x,b.y)};
ia.PyramidLayer.prototype.showTip=function(a,b){if(this.tip!=""){var c=this.tip,c=c.split("${name}").join(a.name),c=c.split("${ageGroup}").join(a.ageGroup),c=c.split("${value}").join(a.formattedValue);this.map.datatip.text(c)}else this.map.datatip.text(a.name+" <br/> "+a.ageGroup+" <br/> "+a.formattedValue);var d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):(c=a.value<0?a.rect.x-(this.map.datatip.getWidth()+5):a.rect.x+a.rect.width+5,d=a.rect.y+
a.rect.height/2-this.map.datatip.getHeight()/2);this.map.datatip.position(c,d);this.map.datatip.show()};ia.CountLayer=function(){ia.CountLayer.baseConstructor.call(this);this.isLegendComponent=!0};ia.extend(ia.BarLayer,ia.CountLayer);
ia.CountLayer.prototype.update=function(){if(this.map&&this.dataChanged){this.getData();this.itemArray=[];this.clearItems();this.minValue=Infinity;this.maxValue=-Infinity;for(var a=this.thematic.getClasses(),b=0;b<a.length;b++){var c=a[b],d={};d.id=c.index;d.legendClass=c;d.color=c.color;d.value=c.items.length;d.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(d.id)!=-1)d.state=ia.ItemLayer.SELECTED;d.parent=this;d.layer=this;d.label=c.getLabel()+" : "+d.value;d.rect=new ia.Rectangle;d.hitArea=
new ia.Rectangle;this.items[d.id]=d;this.itemArray.push(d);this.minValue=Math.min(this.minValue,d.value);this.maxValue=Math.max(this.maxValue,d.value)}if(this.sortDirection!=void 0){var e;e=this.sortDirection=="ascending"?1:-1;this.itemArray.sort(function(a,b){return a.value<b.value?-e:a.value>b.value?e:0})}this.dataChanged=!1}};
ia.CountLayer.prototype.showTip=function(a,b){this.map.datatip.text(a.label);var c,d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):this.map.orientation=="vertical"?(c=a.rect.x+a.rect.width/2-this.map.datatip.getWidth()/2,d=a.value<0?a.rect.y+a.rect.height+5:a.rect.y-this.map.datatip.getHeight()-5):(c=a.value<0?a.rect.x-(this.map.datatip.getWidth()+5):a.rect.x+a.rect.width+5,d=a.rect.y+a.rect.height/2-this.map.datatip.getHeight()/2);this.map.datatip.position(c,
d);this.map.datatip.show()};ia.PieLayer=function(){ia.PieLayer.baseConstructor.call(this);this._piePadding=10;this._pieCenterY=this._pieCenterX=this._pieRadius=this._pieTotal=0;this.isLegendComponent=!0};ia.extend(ia.ItemLayer,ia.PieLayer);
ia.PieLayer.prototype.update=function(){this.itemArray=[];this.clearItems();for(var a=this.thematic.getClasses(),b=0;b<a.length;b++){var c=a[b],d={};d.id=c.index;d.legendClass=c;d.color=c.color;d.value=c.items.length;d.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(d.id)!=-1)d.state=ia.ItemLayer.SELECTED;d.parent=this;d.layer=this;this.items[d.id]=d;this.itemArray.push(d)}};
ia.PieLayer.prototype.render=function(){this.clear();this._pieRadius=Math.min(this.map.canvasWidth,this.map.canvasHeight)/2-this._piePadding;this._pieCenterX=this.map.canvasWidth/2;this._pieCenterY=this.map.canvasHeight/2;for(var a in this.style)this.context[a]=this.style[a],this.selectionContext[a]=this.style[a],this.highlightContext[a]=this.style[a];this.selectionContext.fillStyle="rgba(0, 0, 0, 0)";this.selectionContext.strokeStyle=this.selectionColor;this.selectionContext.lineWidth=parseFloat(this.style.lineWidth)+
1;this.highlightContext.fillStyle=ia.Color.toRGBA(this.highlightColor,0.3);this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor,0.8);this.highlightContext.lineWidth=parseFloat(this.style.lineWidth)+1;a=1.5*Math.PI;var b=0,c=this.itemArray.length;if(c==0)this.context.beginPath(),ia.Shape.drawCircle(this.context,this._pieCenterX,this._pieCenterY,this._pieRadius*2),this.context.fill(),this.context.stroke();else{for(var d=this._pieTotal=0;d<c;d++){var e=this.itemArray[d],b=parseFloat(e.value);
b>0&&(this._pieTotal+=b)}for(d=0;d<c;d++)if(e=this.itemArray[d],b=parseFloat(e.value),b>0){var f=ia.round(b/this._pieTotal*100,2);if(this.tip!=""){var g=this.tip,g=g.split("${name}").join(e.legendClass.getLabel()),g=g.split("${value}").join(b),g=g.split("${percentage}").join(f);e.label=g}else e.label=e.legendClass.getLabel()+" : "+f+"%";b=a+Math.PI*2*(b/this._pieTotal);e.startAngle=a;e.endAngle=b;e.angleSize=b-a;a=b;this._renderItem(e)}this.renderSelection()}};
ia.PieLayer.prototype._renderItem=function(a){this.context.fillStyle=a.color;this._drawItem(a,this.context)};ia.PieLayer.prototype.selectItem=function(a){this._drawItem(a,this.selectionContext)};ia.PieLayer.prototype.highlightItem=function(a){this._drawItem(a,this.highlightContext)};
ia.PieLayer.prototype._drawItem=function(a,b){b.beginPath();b.moveTo(this._pieCenterX,this._pieCenterY);b.arc(this._pieCenterX,this._pieCenterY,this._pieRadius,a.startAngle,a.endAngle,!1);b.lineTo(this._pieCenterX,this._pieCenterY);b.fill();b.stroke()};ia.PieLayer.prototype.hitItem=function(a,b){return this._pointInSlice(a,b.x,b.y)};
ia.PieLayer.prototype._pointInSlice=function(a,b,c){var d=a.endAngle-a.startAngle,e=this._pieCenterX,f=this._pieCenterY;return this._pointInPoly([{x:e,y:f},{x:e+this._pieRadius*Math.cos(a.startAngle),y:f+this._pieRadius*Math.sin(a.startAngle)},{x:e+this._pieRadius*Math.cos(a.startAngle+d/4),y:f+this._pieRadius*Math.sin(a.startAngle+d/4)},{x:e+this._pieRadius*Math.cos(a.startAngle+d/2),y:f+this._pieRadius*Math.sin(a.startAngle+d/2)},{x:e+this._pieRadius*Math.cos(a.startAngle+d/1.5),y:f+this._pieRadius*
Math.sin(a.startAngle+d/1.5)},{x:e+this._pieRadius*Math.cos(a.startAngle+d),y:f+this._pieRadius*Math.sin(a.startAngle+d)},{x:e,y:f}],b,c)};ia.PieLayer.prototype._pointInPoly=function(a,b,c){var d,e,f=0;d=0;for(e=a.length-1;d<a.length;e=d++)a[d].y>c!=a[e].y>c&&b<(a[e].x-a[d].x)*(c-a[d].y)/(a[e].y-a[d].y)+a[d].x&&(f=!f);return f};
ia.PieLayer.prototype.showTip=function(a,b){this.map.datatip.text(a.label);var c,d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):(c=b.x/2,d=b.y-(this.map.datatip.getHeight()+5));this.map.datatip.position(c,d);this.map.datatip.show()};ia.AdvancedPieLayer=function(){ia.AdvancedPieLayer.baseConstructor.call(this)};ia.extend(ia.PieLayer,ia.AdvancedPieLayer);
ia.AdvancedPieLayer.prototype.update=function(){this.itemArray=[];this.clearItems();var a=this.getData();if(a&&this.itemId)if(a.dates)for(var b=a.dates.length,c=0;c<b;c++){var d=a.dates[c],e=a[d][this.itemId];if(e&&(this.itemName=e.name,d=this.thematic.getClass(d))){var f={};f.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(f.id)!=-1)f.state=ia.ItemLayer.SELECTED;f.parent=this;f.layer=this;f.id=d.index;f.legendClass=d;f.value=e.value;f.label=d.getLabel()+" : "+f.value;f.color=d.color;this.items[f.id]=
f;this.itemArray.push(f)}}else if(e=a[this.itemId]){this.itemName=e.name;a=this.thematic.getClasses();for(c=0;c<a.length;c++){d=a[c];b=d.value;f={};f.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(f.id)!=-1)f.state=ia.ItemLayer.SELECTED;f.parent=this;f.layer=this;f.id=d.index;f.legendClass=d;f.value=e[b];f.label=d.getLabel()+" : "+f.value;f.color=d.color;this.items[f.id]=f;this.itemArray.push(f)}}};
ia.BoxLayer=function(){ia.BoxLayer.baseConstructor.call(this);this._maxBarWidth=20;this._minBarWidthForStroke=2;this._barSize=10;this.sortDirection="ascending"};ia.extend(ia.ItemLayer,ia.BoxLayer);
ia.BoxLayer.prototype.update=function(){if(this.map&&this.dataChanged){var a=this.getData();this.itemArray=[];this.clearItems();this.minValue=Infinity;this.maxValue=-Infinity;for(var b in a){var c=a[b];if(ia.isNumber(c[this.medianField])){var d={};d.id=c.id;d.name=c.name;d.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(d.id)!=-1)d.state=ia.ItemLayer.SELECTED;d.parent=this;d.layer=this;d.color=c.color;d.rect=new ia.Rectangle;d.hitArea=new ia.Rectangle;this.items[b]=d;this.itemArray.push(d);
d.median=c[this.medianField];d.largestObservation=c[this.largestObservationField];d.upperQuartile=c[this.upperQuartileField];d.lowerQuartile=c[this.lowerQuartileField];d.smallestObservation=c[this.smallestObservationField];this.maxValue=Math.max(this.maxValue,d.largestObservation);this.minValue=Math.min(this.minValue,d.smallestObservation)}}if(this.sortDirection!=void 0){var e;e=this.sortDirection=="ascending"?1:-1;this.itemArray.sort(function(a,b){return a.median<b.median?-e:a.median>b.median?e:
0})}this.dataChanged=!1}};
ia.BoxLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.selectionContext[a]=this.style[a],this.highlightContext[a]=this.style[a];this.selectionContext.strokeStyle=this.selectionColor;this.selectionContext.lineWidth=parseFloat(this.style.lineWidth)+1;this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor,0.8);this.highlightContext.lineWidth=parseFloat(this.style.lineWidth)+1;a=this.itemArray.length;this._barSize=this.map.orientation==
"vertical"?this.map.canvasWidth/a:this.map.canvasHeight/a;this._barSize>=this._minBarWidthForStroke?(this.selectionContext.fillStyle="rgba(0, 0, 0, 0)",this.highlightContext.fillStyle=ia.Color.toRGBA(this.highlightColor,0.3)):(this.highlightContext.fillStyle=ia.Color.toRGBA(this.selectionColor),this.highlightContext.fillStyle=ia.Color.toRGBA(this.highlightColor));for(var b=0;b<a;b++){var c=this.itemArray[b];this._setItemShape(c,b);this._renderItem(c)}this.renderSelection()};
ia.BoxLayer.prototype._setItemShape=function(a,b){if(this.map.orientation=="vertical"){var c=this.itemArray.length;a.rect.y=this.map.getPixelY(a.upperQuartile);a.rect.height=this.map.getPixelY(a.lowerQuartile)-a.rect.y;a.rect.x=this.map.canvasX+b/c*this.map.canvasWidth;a.rect.width=this.map.canvasWidth/c;a.hitArea.x=a.rect.x;a.hitArea.y=this.map.canvasY;a.hitArea.width=a.rect.width;a.hitArea.height=this.map.canvasHeight;a.uq={};a.uq.x=a.rect.x+a.rect.width/2;a.uq.y=this.map.getPixelY(a.largestObservation);
a.lq={};a.lq.x=a.rect.x+a.rect.width/2;a.lq.y=this.map.getPixelY(a.smallestObservation);a.m={};a.m.x=a.rect.x+a.rect.width/2;a.m.y=this.map.getPixelY(a.median);a.rect.width>this._maxBarWidth?(a.rect.x+=(a.rect.width-this._maxBarWidth)/2,a.rect.width=this._maxBarWidth):a.rect.width<this._minBarWidthForStroke&&a.rect.width++}else c=this.itemArray.length,a.rect.x=this.map.getPixelX(a.lowerQuartile),a.rect.width=this.map.getPixelX(a.upperQuartile)-a.rect.x,a.rect.y=this.map.canvasY+b/c*this.map.canvasHeight,
a.rect.height=this.map.canvasHeight/c,a.hitArea.x=this.map.canvasX,a.hitArea.y=a.rect.y,a.hitArea.width=this.map.canvasWidth,a.hitArea.height=a.rect.height,a.uq={},a.uq.x=this.map.getPixelX(a.largestObservation),a.uq.y=a.rect.y+a.rect.height/2,a.lq={},a.lq.x=this.map.getPixelX(a.smallestObservation),a.lq.y=a.rect.y+a.rect.height/2,a.m={},a.m.x=this.map.getPixelX(a.median),a.m.y=a.rect.y+a.rect.height/2,a.rect.height>this._maxBarWidth?(a.rect.y+=(a.rect.height-this._maxBarWidth)/2,a.rect.height=this._maxBarWidth):
a.rect.height<this._minBarWidthForStroke&&a.rect.height++};ia.BoxLayer.prototype._renderItem=function(a){this.context.fillStyle=a.color;this._drawItem(a,this.context)};ia.BoxLayer.prototype.selectItem=function(a){this._drawItem(a,this.selectionContext)};ia.BoxLayer.prototype.highlightItem=function(a){this._drawItem(a,this.highlightContext)};
ia.BoxLayer.prototype._drawItem=function(a,b){b.beginPath();b.moveTo(a.uq.x,a.uq.y);b.lineTo(a.lq.x,a.lq.y);this.map.orientation=="vertical"?(b.moveTo(a.rect.x,a.uq.y),b.lineTo(a.rect.x+a.rect.width,a.uq.y),b.moveTo(a.rect.x,a.lq.y),b.lineTo(a.rect.x+a.rect.width,a.lq.y)):(b.moveTo(a.uq.x,a.rect.y),b.lineTo(a.uq.x,a.rect.y+a.rect.height),b.moveTo(a.lq.x,a.rect.y),b.lineTo(a.lq.x,a.rect.y+a.rect.height));b.stroke();b.beginPath();b.rect(a.rect.x,a.rect.y,a.rect.width,a.rect.height);b.fill();this._barSize>=
this._minBarWidthForStroke&&b.stroke();b.beginPath();this.map.orientation=="vertical"?(b.moveTo(a.rect.x,a.m.y),b.lineTo(a.rect.x+a.rect.width,a.m.y)):(b.moveTo(a.m.x,a.rect.y),b.lineTo(a.m.x,a.rect.y+a.rect.height));b.stroke()};ia.BoxLayer.prototype.hitItem=function(a,b){return a.hitArea.intersects(b.x,b.y)};
ia.BoxLayer.prototype.showTip=function(a,b){this.map.datatip.text(this.tipFunction(a));var c,d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):this.map.orientation=="vertical"?(c=a.rect.x+a.rect.width,d=a.median<0?a.rect.y+a.rect.height+5:a.rect.y-this.map.datatip.getHeight()-5):(c=a.median<0?a.rect.x-(this.map.datatip.getWidth()+5):a.rect.x+a.rect.width+5,d=a.rect.y+a.rect.height);this.map.datatip.position(c,d);this.map.datatip.show()};
ia.TimeBarLayer=function(){ia.TimeBarLayer.baseConstructor.call(this);this._maxBarWidth=20;this._barSize=this._minBarWidthForStroke=10;this._renderTimeout=null;this.colorPalette=new ia.ColorPalette};ia.extend(ia.ItemLayer,ia.TimeBarLayer);
ia.TimeBarLayer.prototype.update=function(){if(this.map&&this.dataChanged){var a=this.getData();this.itemArray=[];this.clearItems();this.minValue=Infinity;this.maxValue=-Infinity;if(a.dates){var b=a[a.dates[0]],c=a.dates.length,d;for(d in b){var e=b[d],f={};f.id=e.id;f.name=e.name;f.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(f.id)!=-1)f.state=ia.ItemLayer.SELECTED;f.parent=this;f.layer=this;this.items[e.id]=f;this.itemArray.push(f);f.childItems=[];for(var g=0;g<c;g++){var h=a.dates[g],
e=a[h][d],j=e[this.dataField];if(ia.isNumber(j)){var i={};i.id=d+"~"+h;i.name=h;i.rect=new ia.Rectangle;i.hitArea=new ia.Rectangle;i.value=j;i.formattedValue=e[this.dataField+"_formatted"];this.minValue=Math.min(this.minValue,i.value);this.maxValue=Math.max(this.maxValue,i.value);f.childItems[f.childItems.length]=i}else f.childItems[f.childItems.length]={name:h,value:void 0}}}}this.dataChanged=!1}};
ia.TimeBarLayer.prototype.render=function(){this._renderTimeout=null;this.clear();for(var a in this.style)this.context[a]=this.style[a],this.highlightContext[a]=this.style[a];this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor,0.8);this.highlightContext.lineWidth=parseFloat(this.style.lineWidth)+1;a=this.getData();if(a.dates){a=a.dates.length;this._barSize=this.map.orientation=="vertical"?this.map.canvasWidth/a/this.selectionIds.length:this.map.canvasHeight/a/this.selectionIds.length;
this.highlightContext.fillStyle=this._barSize>=this._minBarWidthForStroke?ia.Color.toRGBA(this.highlightColor,0.3):ia.Color.toRGBA(this.highlightColor,0.8);a=this.selectionIds.length;for(var b=this.colorPalette.getColors(a),c=0;c<a;c++){var d=this.items[this.selectionIds[c]];d.color=b[c];if(d){for(var e=d.childItems.length,f=0;f<e;f++){var g=d.childItems[f];g.value!=void 0&&this._setItemShape(g,f,e,c)}this._renderItem(d)}}}};
ia.TimeBarLayer.prototype._setItemShape=function(a,b,c,d){if(this.map.orientation=="vertical"){var e,f;this.map.getBBox().getYMin()<0?(e=a.value<0?this.map.getPixelY(0):this.map.getPixelY(a.value),f=this.map.getPixelHeight(Math.abs(a.value))):(e=this.map.getPixelY(a.value),f=this.map.getPixelHeight(Math.abs(a.value)-this.map.getBBox().getYMin()));a.value<this.map.getBBox().getYMin()&&(e=this.map.canvasY+this.map.canvasHeight,f-=this.map.getPixelHeight(Math.abs(a.value)-this.map.getBBox().getYMin()));
if(a.value>this.map.getBBox().getYMax())e=this.map.canvasY,f-=this.map.getPixelHeight(Math.abs(a.value)-this.map.getBBox().getYMax());a.rect.y=e;a.rect.height=f;a.rect.width=this._barSize;a.rect.x=this.map.canvasX+b/c*this.map.canvasWidth+d*a.rect.width;a.hitArea.x=a.rect.x;a.hitArea.y=this.map.canvasY;a.hitArea.width=a.rect.width;a.hitArea.height=this.map.canvasHeight;a.rect.width>this._maxBarWidth?(a.rect.x+=(a.rect.width-this._maxBarWidth)/2,a.rect.width=this._maxBarWidth):a.rect.width<this._minBarWidthForStroke&&
a.rect.width++}else{this.map.getBBox().getXMin()<0?(e=a.value<0?this.map.getPixelX(a.value):this.map.getPixelX(0),f=this.map.getPixelWidth(Math.abs(a.value))):(e=this.map.getPixelX(this.map.getBBox().getXMin()),f=this.map.getPixelWidth(Math.abs(a.value)-this.map.getBBox().getXMin()));if(a.value<this.map.getBBox().getXMin())e=this.map.canvasX,f-=this.map.getPixelWidth(Math.abs(a.value)-Math.abs(this.map.getBBox().getXMin()));a.value>this.map.getBBox().getXMax()&&(f-=this.map.getPixelWidth(Math.abs(a.value)-
Math.abs(this.map.getBBox().getXMax())));a.rect.x=e;a.rect.width=f;a.rect.height=this._barSize;a.rect.y=this.map.canvasY+b/c*this.map.canvasHeight+d*a.rect.height;a.hitArea.x=this.map.canvasX;a.hitArea.y=a.rect.y;a.hitArea.width=this.map.canvasWidth;a.hitArea.height=a.rect.height;a.rect.height>this._maxBarWidth?(a.rect.y+=(a.rect.height-this._maxBarWidth)/2,a.rect.height=this._maxBarWidth):a.rect.height<this._minBarWidthForStroke&&a.rect.height++}};
ia.TimeBarLayer.prototype._renderItem=function(a){this.context.fillStyle=a.color;this._drawItem(a,this.context)};ia.TimeBarLayer.prototype.selectItem=function(){this._triggerRender()};ia.TimeBarLayer.prototype.unselect=function(a){var b=this.getItem(a);if(b)b.state=ia.ItemLayer.UNSELECTED,a=this.selectionIds.indexOf(a),a!=-1&&this.selectionIds.splice(a,1);this._triggerRender()};
ia.TimeBarLayer.prototype.clearSelection=function(){this.selectionIds=[];for(var a in this.items){var b=this.items[a];if(b)b.state=ia.ItemLayer.UNSELECTED}this._triggerRender()};ia.TimeBarLayer.prototype._triggerRender=function(){if(!this._renderTimeout){var a=this;this._renderTimeout=setTimeout(function(){a.render()},5)}};ia.TimeBarLayer.prototype.highlightItem=function(a){this.selectionIds.indexOf(a.id)!=-1&&this._drawItem(a,this.highlightContext)};
ia.TimeBarLayer.prototype._drawItem=function(a,b){for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];e.value!=void 0&&(b.beginPath(),b.rect(e.rect.x,e.rect.y,e.rect.width,e.rect.height),b.fill(),this._barSize>=this._minBarWidthForStroke&&b.stroke())}};ia.TimeBarLayer.prototype.hitItem=function(a,b){if(this.isSelected(a.id))for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];if(e.value!=void 0&&e.hitArea.intersects(b.x,b.y))return!0}return!1};
ia.TimeBarLayer.prototype.showTip=function(a,b){for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];if(e.value!=void 0&&e.hitArea.intersects(b.x,b.y)){this.tip!=""?(c=this.tip,c=c.split("${name}").join(a.name),c=c.split("${date}").join(e.name),c=c.split("${value}").join(e.formattedValue),this.map.datatip.text(c)):this.map.datatip.text(a.name+" : "+e.name+" : "+e.formattedValue);ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,e=b.y-(this.map.datatip.getHeight()+30)):this.map.orientation==
"vertical"?(c=e.rect.x+e.rect.width/2-this.map.datatip.getWidth()/2,e=e.value<0?e.rect.y+e.rect.height+5:e.rect.y-this.map.datatip.getHeight()-5):(c=e.value<0?e.rect.x-(this.map.datatip.getWidth()+5):e.rect.x+e.rect.width+5,e=e.rect.y+e.rect.height/2-this.map.datatip.getHeight()/2);this.map.datatip.position(c,e);this.map.datatip.show();break}}};
ia.PlotLayer=function(){ia.PlotLayer.baseConstructor.call(this);this._xData={};this._yData={};this.style={fillStyle:"#ffffff",strokeStyle:"#888888",lineWidth:"2",lineJoin:"round"};this.yDataField=this.xDataField="value";this.correlationInfo={};this.showCorrelationLine=!1;this.pointSize=6};ia.extend(ia.ItemLayer,ia.PlotLayer);ia.PlotLayer.prototype.getXData=function(){return this._xData};ia.PlotLayer.prototype.setXData=function(a){this._xData=a;this.dataChanged=!0};
ia.PlotLayer.prototype.getYData=function(){return this._yData};ia.PlotLayer.prototype.setYData=function(a){this._yData=a;this.dataChanged=!0};ia.PlotLayer.prototype.getColorData=function(){return this._colorData};ia.PlotLayer.prototype.setColorData=function(a){this._colorData=a;this.dataChanged=!0};ia.PlotLayer.prototype.getSizeData=function(){return this._sizeData};ia.PlotLayer.prototype.setSizeData=function(a){this._sizeData=a;this.dataChanged=!0};
ia.PlotLayer.prototype.update=function(){if(this.map&&this.dataChanged){this.itemArray=[];this.clearItems();this.xMinValue=Infinity;this.xMaxValue=-Infinity;this.yMinValue=Infinity;this.yMaxValue=-Infinity;var a=0,b=0,c=0,d=0,e=0,f=c=c=0,g=0,h;for(h in this._xData){var c=this._xData[h],j=c[this.xDataField],i=this._yData[h][this.yDataField];if(ia.isNumber(j)&&ia.isNumber(i)){var j=parseFloat(j),i=parseFloat(i),m={};m.id=c.id;m.name=c.name;m.xValue=j;m.yValue=i;m.color=this._colorData!=void 0?this._colorData[h].color:
c.color;m.symbolSize=this._sizeData!=void 0?this._sizeData[h].symbolSize:this.pointSize;m.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(m.id)!=-1)m.state=ia.ItemLayer.SELECTED;m.parent=this;m.layer=this;m.shape=new ia.Rectangle;m.hitArea=new ia.Rectangle;this.items[h]=m;this.itemArray.push(m);c=j*j;a+=j;b+=c;c=i*i;d+=i;e+=c;c=j*i;f+=c;g++;if(this.isComparison){if(this.selectionIds.indexOf(m.id)!=-1)this.xMinValue=Math.min(this.xMinValue,j),this.xMaxValue=Math.max(this.xMaxValue,j),this.yMinValue=
Math.min(this.yMinValue,i),this.yMaxValue=Math.max(this.yMaxValue,i),m.state=ia.ItemLayer.SELECTED;if(this.displayAll)this.xMinValue=Math.min(this.xMinValue,j),this.xMaxValue=Math.max(this.xMaxValue,j),this.yMinValue=Math.min(this.yMinValue,i),this.yMaxValue=Math.max(this.yMaxValue,i)}else this.xMinValue=Math.min(this.xMinValue,j),this.xMaxValue=Math.max(this.xMaxValue,j),this.yMinValue=Math.min(this.yMinValue,i),this.yMaxValue=Math.max(this.yMaxValue,i)}}e=(f/g-a*(d/Math.pow(g,2)))/Math.sqrt((b/
g-Math.pow(a/g,2))*(e/g-Math.pow(d/g,2)));h=(a*d-g*f)/(Math.pow(a,2)-g*b);a=(a*f-d*b)/(Math.pow(a,2)-g*b);this.correlationInfo.correlationCoeff=e;this.correlationInfo.rSquare=Math.pow(e,2);this.correlationInfo.gradient=h;this.correlationInfo.intercept=a;this._sizeData!=void 0&&this.itemArray.sort(function(a,b){return a.symbolSize<b.symbolSize?1:a.symbolSize>b.symbolSize?-1:0});this.dataChanged=!1}};
ia.PlotLayer.prototype.render=function(){this.clear();if(this.showCorrelationLine){this.context.save();this.context.rect(this.map.canvasX,this.map.canvasY,this.map.canvasWidth,this.map.canvasHeight);this.context.clip();this.context.strokeStyle=ia.Color.toRGBA(this.selectionColor,0.3);this.context.lineWidth=2;var a=this.map.getPixelX(this.map.getBBox().getXMin()),b=this.map.getPixelX(this.map.getBBox().getXMax()),c=this.map.getPixelY(this.map.getBBox().getXMin()*this.correlationInfo.gradient+this.correlationInfo.intercept),
d=this.map.getPixelY(this.map.getBBox().getXMax()*this.correlationInfo.gradient+this.correlationInfo.intercept);this.context.beginPath();this.context.moveTo(a,c);this.context.lineTo(b,d);this.context.stroke();this.context.restore()}for(var e in this.style)this.context[e]=this.style[e],this.selectionContext[e]=this.style[e],this.highlightContext[e]=this.style[e];this.highlightContext.strokeStyle=this.highlightColor;this.selectionContext.strokeStyle=this.selectionColor;this.highlightContext.fillStyle=
"rgba(0, 0, 0, 0)";this.selectionContext.fillStyle="rgba(0, 0, 0, 0)";a=this.itemArray.length;for(b=0;b<a;b++)c=this.itemArray[b],this._setItemShape(c),this._renderItem(c);this.renderSelection()};
ia.PlotLayer.prototype._setItemShape=function(a){var b=this.map.getPixelX(a.xValue),c=this.map.getPixelY(a.yValue),d=a.symbolSize,e=a.symbolSize;a.shape.x=b;a.shape.y=c;a.shape.width=d;a.shape.height=e;ia.IS_TOUCH_DEVICE&&(d=Math.max(30,d),e=Math.max(30,e));a.hitArea.x=b-d/2;a.hitArea.y=c-e/2;a.hitArea.width=d;a.hitArea.height=e};
ia.PlotLayer.prototype._renderItem=function(a){if(this._colorData!=void 0)this.context.fillStyle=a.color,this.context.strokeStyle="#CCCCCC",this.context.lineWidth=1;this._drawItem(a,this.context,a.symbolSize)};ia.PlotLayer.prototype.selectItem=function(a){this._drawItem(a,this.selectionContext,a.symbolSize)};
ia.PlotLayer.prototype.highlightItem=function(a){this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor,0.3);var b=this.map.getPixelX(this.map.getBBox().getXMin()),c=this.map.getPixelX(this.map.getBBox().getXMax()),d=this.map.getPixelY(this.map.getBBox().getYMin()),e=this.map.getPixelY(this.map.getBBox().getYMax());this.highlightContext.beginPath();this.highlightContext.moveTo(a.shape.x,d);this.highlightContext.lineTo(a.shape.x,e);this.highlightContext.moveTo(b,a.shape.y);this.highlightContext.lineTo(c,
a.shape.y);this.highlightContext.stroke();this.highlightContext.strokeStyle=this.highlightColor;this._drawItem(a,this.highlightContext,a.symbolSize)};ia.PlotLayer.prototype._drawItem=function(a,b,c){b.beginPath();ia.Shape.drawCircle(b,a.shape.x,a.shape.y,c);b.fill();b.stroke()};ia.PlotLayer.prototype.hitItem=function(a,b){return a.hitArea.intersects(b.x,b.y)?!0:!1};
ia.PlotLayer.prototype.showTip=function(a,b){this.map.datatip.text(this.tipFunction(a));var c,d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):(c=a.shape.x+a.shape.width/2,d=a.shape.y-a.shape.height/2-this.map.datatip.getHeight());this.map.datatip.position(c,d);this.map.datatip.show()};
ia.PlotLayer.prototype._getCorrelation=function(){var a=0,b=0,c=0,d=0,e=0,f=c=0,g=0,h=0,j;for(j in xData){var f=xData[j][xDataField],i=yData[j][yDataField];ia.isNumber(f)&&ia.isNumber(i)&&(c=f*f,a+=f,b+=c,c=i*i,d+=i,e+=c,f*=i,g+=f,h++)}e=(g/h-a*(d/Math.pow(h,2)))/Math.sqrt((b/h-Math.pow(a/h,2))*(e/h-Math.pow(d/h,2)));e=Math.round(e*100)/100;j=(a*d-h*g)/(Math.pow(a,2)-h*b);a=(a*g-d*b)/(Math.pow(a,2)-h*b);a=Math.round(a*100)/100;b={};b.correlationCoeff=e;b.rSquare=Math.pow(e,2);b.gradient=j;b.intercept=
a;ia.log("[coefficient="+b.correlationCoeff+",rSquare="+b.rSquare+",gradient="+b.gradient+",intercept="+b.intercept+"]");return b};ia.ComparisonLineLayer=function(){ia.ComparisonLineLayer.baseConstructor.call(this);this.style={fillStyle:"#ffffff",strokeStyle:"#ff0000",lineWidth:"2",lineJoin:"round"};this.displayAll=!1};ia.extend(ia.ItemLayer,ia.ComparisonLineLayer);
ia.ComparisonLineLayer.prototype.update=function(){if(this.map&&this.dataChanged){var a=this.getData();this.itemArray=[];this.clearItems();this.minValue=Infinity;this.maxValue=-Infinity;for(var b in a){var c=a[b],d=c[this.dataField];if(ia.isNumber(d)){var e={};e.id=c.id;e.name=c.name;e.color=c.color;e.value=c[this.dataField];e.shape=new ia.Rectangle;e.hitArea=new ia.Rectangle;e.state=ia.ItemLayer.UNSELECTED;if(this.selectionIds.indexOf(e.id)!=-1)this.minValue=Math.min(this.minValue,d),this.maxValue=
Math.max(this.maxValue,d),e.state=ia.ItemLayer.SELECTED;if(this.displayAll)this.minValue=Math.min(this.minValue,d),this.maxValue=Math.max(this.maxValue,d);e.parent=this;e.layer=this;this.items[b]=e;this.itemArray.push(e)}}this.dataChanged=!1}};
ia.ComparisonLineLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.highlightContext[a]=this.style[a],this.selectionContext[a]=this.style[a];this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor);a=this.itemArray.length;for(var b=0;b<a;b++){var c=this.itemArray[b];this._setItemShape(c);this.displayAll&&this._renderItem(c)}this.displayAll||this.renderSelection()};
ia.ComparisonLineLayer.prototype._setItemShape=function(a){this.map.orientation=="vertical"?(a.shape.x=this.map.canvasX,a.shape.y=this.map.getPixelY(a.value),a.shape.width=this.map.canvasWidth,a.shape.height=0,a.hitArea.x=a.shape.x,a.hitArea.y=a.shape.y-1,a.hitArea.width=a.shape.width,a.hitArea.height=2):(a.shape.x=this.map.getPixelX(a.value),a.shape.y=this.map.canvasY,a.shape.width=0,a.shape.height=this.map.canvasHeight,a.hitArea.x=a.shape.x-1,a.hitArea.y=a.shape.y,a.hitArea.width=2,a.hitArea.height=
a.shape.height)};ia.ComparisonLineLayer.prototype.clearSelection=function(){};ia.ComparisonLineLayer.prototype._renderItem=function(a){this.context.strokeStyle=a.color;this._drawItem(a,this.context)};ia.ComparisonLineLayer.prototype.selectItem=function(a){this.selectionContext.strokeStyle=a.color;this._drawItem(a,this.selectionContext)};
ia.ComparisonLineLayer.prototype.highlightItem=function(a){ia.IS_IE_TEN||(this.highlightContext.beginPath(),this.highlightContext.rect(this.map.canvasX,this.map.canvasY,this.map.canvasWidth,this.map.canvasHeight),this.highlightContext.clip());this._drawItem(a,this.highlightContext)};
ia.ComparisonLineLayer.prototype._drawItem=function(a,b){b.beginPath();this.map.orientation=="vertical"?(b.moveTo(a.shape.x,a.shape.y),b.lineTo(a.shape.x+a.shape.width,a.shape.y)):(b.moveTo(a.shape.x,a.shape.y),b.lineTo(a.shape.x,a.shape.y+a.shape.height));b.stroke()};ia.ComparisonLineLayer.prototype.hitItem=function(a,b){return this.isSelected(a.id)||this.displayAll?a.hitArea.intersects(b.x,b.y):!1};
ia.ComparisonLineLayer.prototype.showTip=function(a,b){this.map.datatip.text(this.tipFunction(a));var c,d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):this.map.orientation=="vertical"?(c=b.x-this.map.datatip.getWidth()/2,d=a.shape.y-this.map.datatip.getHeight()-5):(c=a.shape.x+a.shape.width+5,d=b.y-this.map.datatip.getHeight()/2);this.map.datatip.position(c,d);this.map.datatip.show()};
ia.ComparisonTimeLayer=function(){ia.ComparisonTimeLayer.baseConstructor.call(this);this.isComparison=!0;this.displayAll=!1;this.selectedDate=""};ia.extend(ia.TimeLayer,ia.ComparisonTimeLayer);
ia.ComparisonTimeLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.highlightContext[a]=this.style[a],this.selectionContext[a]=this.style[a];this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor);a=this.itemArray.length;for(var b=0;b<a;b++){for(var c=this.itemArray[b],d=c.childItems.length,e=0;e<d;e++){var f=c.childItems[e];f.value!=void 0&&this._setItemShape(f,e,d)}this.displayAll&&this._renderItem(c)}this.renderSelection()};
ia.ComparisonTimeLayer.prototype.clearSelection=function(){};ia.ComparisonTimeLayer.prototype._renderItem=function(a){if(this.thematic){var b=this.thematic.getClass(a.id);if(b)this.context.strokeStyle=b.color}this._drawItem(a,this.context)};ia.ComparisonTimeLayer.prototype.selectItem=function(a){if(this.thematic){var b=this.thematic.getClass(a.id);if(b)this.selectionContext.strokeStyle=b.color}this._drawItem(a,this.selectionContext)};
ia.ComparisonTimeLayer.prototype.hitItem=function(a,b){if(this.isSelected(a.id)||this.displayAll)for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];if(e.value!=void 0&&e.hitArea.intersects(b.x,b.y))return!0}return!1};ia.ComparisonTimeBarLayer=function(){ia.ComparisonTimeBarLayer.baseConstructor.call(this);this.isComparison=!0;this.displayAll=!1};ia.extend(ia.TimeLayer,ia.ComparisonTimeBarLayer);
ia.ComparisonTimeBarLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.highlightContext[a]=this.style[a],this.selectionContext[a]=this.style[a];this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor);a=this.itemArray.length;for(var b=0;b<a;b++){for(var c=this.itemArray[b],d=c.childItems.length,e=0;e<d;e++){var f=c.childItems[e];f.value!=void 0&&this._setItemShape(f,e,d)}this.displayAll&&this._renderItem(c)}this.renderSelection()};
ia.ComparisonTimeBarLayer.prototype._setItemShape=function(a,b,c){if(this.map.orientation=="vertical")var d=this.map.canvasWidth/c,c=this.map.canvasX+d/2+d*b,b=this.map.getPixelY(a.value);else d=this.map.canvasHeight/c,c=this.map.getPixelX(a.value),b=this.map.canvasY+d/2+d*b;var e=d=10;ia.IS_TOUCH_DEVICE&&(e=d=30);a.shape.x=c;a.shape.y=b;a.shape.width=d;a.shape.height=e;a.hitArea.x=c-d/2;a.hitArea.y=b-e/2;a.hitArea.width=d;a.hitArea.height=e};ia.ComparisonTimeBarLayer.prototype.clearSelection=function(){};
ia.ComparisonTimeBarLayer.prototype._renderItem=function(a){if(this.thematic){var b=this.thematic.getClass(a.id);if(b)this.context.strokeStyle=b.color}this._drawItem(a,this.context)};ia.ComparisonTimeBarLayer.prototype.selectItem=function(a){if(this.thematic){var b=this.thematic.getClass(a.id);if(b)this.selectionContext.strokeStyle=b.color}this._drawItem(a,this.selectionContext)};
ia.ComparisonTimeBarLayer.prototype._drawItem=function(a,b){var c=!0,d=a.childItems.length;b.beginPath();for(var e=0;e<d;e++){var f=a.childItems[e];f.value!=void 0?(c?b.moveTo(f.shape.x,f.shape.y):b.lineTo(f.shape.x,f.shape.y),c=!1):c=!0}b.stroke();for(e=0;e<d;e++)f=a.childItems[e],f.value!=void 0&&(b.beginPath(),ia.Shape.drawCircle(b,f.shape.x,f.shape.y,7),b.fill(),b.stroke())};
ia.ComparisonTimeBarLayer.prototype.hitItem=function(a,b){if(this.isSelected(a.id)||this.displayAll)for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];if(e.value!=void 0&&e.hitArea.intersects(b.x,b.y))return!0}return!1};ia.ComparisonPlotLayer=function(){ia.ComparisonPlotLayer.baseConstructor.call(this);this.style={fillStyle:"#ffffff",strokeStyle:"#ff0000",lineWidth:"2",lineJoin:"round"};this.displayAll=!1;this.isComparison=!0};ia.extend(ia.PlotLayer,ia.ComparisonPlotLayer);
ia.ComparisonPlotLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.selectionContext[a]=this.style[a],this.highlightContext[a]=this.style[a];this.highlightContext.strokeStyle=this.highlightColor;this.selectionContext.strokeStyle=this.selectionColor;a=this.itemArray.length;for(var b=0;b<a;b++){var c=this.itemArray[b];this._setItemShape(c);this.displayAll&&this._renderItem(c)}this.renderSelection()};
ia.ComparisonPlotLayer.prototype._setItemShape=function(a){var b=this.map.getPixelX(a.xValue),c=this.map.getPixelY(a.yValue),d=10,e=10;a.shape.x=b;a.shape.y=c;a.shape.width=d;a.shape.height=e;ia.IS_TOUCH_DEVICE&&(d=Math.max(30,d),e=Math.max(30,e));a.hitArea.x=b-d/2;a.hitArea.y=c-e/2;a.hitArea.width=d;a.hitArea.height=e};ia.ComparisonPlotLayer.prototype.clearSelection=function(){};ia.ComparisonPlotLayer.prototype._renderItem=function(a){this.context.strokeStyle=a.color;this._drawItem(a,this.context)};
ia.ComparisonPlotLayer.prototype.selectItem=function(a){this.selectionContext.strokeStyle=a.color;this._drawItem(a,this.selectionContext)};ia.ComparisonPlotLayer.prototype._drawItem=function(a,b){b.beginPath();ia.Shape.drawCircle(b,a.shape.x,a.shape.y,a.symbolSize);b.fill();b.stroke()};ia.ComparisonPlotLayer.prototype.hitItem=function(a,b){return this.isSelected(a.id)||this.displayAll?a.hitArea.intersects(b.x,b.y):!1};
ia.ComparisonPyramidLayer=function(){ia.ComparisonPyramidLayer.baseConstructor.call(this);this.style={fillStyle:"#ffffff",strokeStyle:"#ff0000",lineWidth:"2",lineJoin:"round"};this.sortDirection="ascending";this.gender="male";this.displayAll=!1};ia.extend(ia.ItemLayer,ia.ComparisonPyramidLayer);
ia.ComparisonPyramidLayer.prototype.update=function(a){if(this.map){var b=this.getData();this.itemArray=[];this.clearItems();this.minValue=Infinity;this.maxValue=-Infinity;if(b[0])for(var c=b[0].features,d=0;d<c.length;d++){var e=c[d],f=0,g={};g.id=e.id;g.name=e.name;g.state=ia.ItemLayer.UNSELECTED;g.parent=this;g.layer=this;this.items[g.id]=g;this.itemArray.push(g);g.childItems=[];for(e=0;e<b.length;e++){var h=b[e],j=h.features[d];if(j){var i=j[this.dataField];if(ia.isNumber(i)){this.gender=="female"&&
(i*=-1);if(this.selectionIds.indexOf(g.id)!=-1)this.minValue=Math.min(this.minValue,i),this.maxValue=Math.max(this.maxValue,i),g.state=ia.ItemLayer.SELECTED;if(this.displayAll)this.minValue=Math.min(this.minValue,i),this.maxValue=Math.max(this.maxValue,i)}if(a==void 0||h.date==a){if(ia.isNumber(i)){var m={};m.id=g.id+"~"+h.name;m.name=h.name;m.ageGroup=h.name;m.shape=new ia.Rectangle;m.hitArea=new ia.Rectangle;m.value=i;m.index=f;m.formattedValue=j[this.dataField+"_formatted"];g.childItems[g.childItems.length]=
m}f++}}}g.nChildItems=f;g.childItems.reverse()}}};ia.ComparisonPyramidLayer.prototype.clearSelection=function(){};
ia.ComparisonPyramidLayer.prototype.render=function(){this.clear();ia.IS_IE_TEN||(this.highlightContext.beginPath(),this.highlightContext.rect(this.map.canvasX,this.map.canvasY,this.map.canvasWidth,this.map.canvasHeight),this.highlightContext.clip());for(var a in this.style)this.context[a]=this.style[a],this.highlightContext[a]=this.style[a],this.selectionContext[a]=this.style[a];this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor);a=this.itemArray.length;for(var b=0;b<a;b++){for(var c=
this.itemArray[b],d=c.childItems.length,e=0;e<d;e++){var f=c.childItems[e],g=c.nChildItems-1-f.index;f!=void 0&&this._setItemShape(f,g,c.nChildItems)}this.displayAll&&this._renderItem(c)}this.renderSelection()};
ia.ComparisonPyramidLayer.prototype._setItemShape=function(a,b,c){var d=this.map.canvasHeight/c,c=this.map.getPixelX(a.value),b=this.map.canvasY+d/2+d*b,e=d=10;a.shape.x=c;a.shape.y=b;a.shape.width=d;a.shape.height=e;ia.IS_TOUCH_DEVICE&&(e=d=30);a.hitArea.x=c-d/2;a.hitArea.y=b-e/2;a.hitArea.width=d;a.hitArea.height=e};ia.ComparisonPyramidLayer.prototype._renderItem=function(a){if(this.thematic){var b=this.thematic.getClass(a.id);if(b)this.context.strokeStyle=b.color}this._drawItem(a,this.context)};
ia.ComparisonPyramidLayer.prototype.selectItem=function(a){if(this.thematic){var b=this.thematic.getClass(a.id);if(b)this.selectionContext.strokeStyle=b.color}this._drawItem(a,this.selectionContext)};ia.ComparisonPyramidLayer.prototype.highlightItem=function(a){ia.IS_IE_TEN||(this.highlightContext.beginPath(),this.highlightContext.rect(this.map.canvasX,this.map.canvasY,this.map.canvasWidth,this.map.canvasHeight),this.highlightContext.clip());this._drawItem(a,this.highlightContext,!0)};
ia.ComparisonPyramidLayer.prototype._drawSpline=function(a,b){for(var c=[],d=a.childItems.length,e=0;e<d-2;e++)c=c.concat(this._getControlPoints(a.childItems[e].shape.x,a.childItems[e].shape.y,a.childItems[e+1].shape.x,a.childItems[e+1].shape.y,a.childItems[e+2].shape.x,a.childItems[e+2].shape.y,0.3));for(e=1;e<d-2;e++)b.beginPath(),b.moveTo(a.childItems[e].shape.x,a.childItems[e].shape.y),b.bezierCurveTo(c[4*e-2],c[4*e-1],c[4*e],c[4*e+1],a.childItems[e+1].shape.x,a.childItems[e+1].shape.y),b.stroke();
d>0&&(b.beginPath(),b.moveTo(a.childItems[0].shape.x,a.childItems[0].shape.y),b.quadraticCurveTo(c[0],c[1],a.childItems[1].shape.x,a.childItems[1].shape.y),b.stroke(),b.beginPath(),b.moveTo(a.childItems[d-1].shape.x,a.childItems[d-1].shape.y),b.quadraticCurveTo(c[4*d-10],c[4*d-9],a.childItems[d-2].shape.x,a.childItems[d-2].shape.y),b.stroke())};
ia.ComparisonPyramidLayer.prototype._getControlPoints=function(a,b,c,d,e,f,g){var h=Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2)),h=g*h/(h+Math.sqrt(Math.pow(e-c,2)+Math.pow(f-d,2)));g-=h;return[c+h*(a-e),d+h*(b-f),c-g*(a-e),d-g*(b-f)]};ia.ComparisonPyramidLayer.prototype._drawItem=function(a,b,c){this._drawSpline(a,b);if(c==!0)for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];e!=void 0&&(b.beginPath(),ia.Shape.drawCircle(b,e.shape.x,e.shape.y,5),b.fill(),b.stroke())}};
ia.ComparisonPyramidLayer.prototype.hitItem=function(a,b){if(this.isSelected(a.id)||this.displayAll)for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];if(e!=void 0&&e.hitArea.intersects(b.x,b.y))return!0}return!1};
ia.ComparisonPyramidLayer.prototype.showTip=function(a,b){for(var c=a.childItems.length,d=0;d<c;d++){var e=a.childItems[d];if(e!=void 0&&e.hitArea.intersects(b.x,b.y)){this.tip!=""?(c=this.tip,c=c.split("${name}").join(a.name),c=c.split("${ageGroup}").join(e.ageGroup),c=c.split("${value}").join(e.formattedValue),this.map.datatip.text(c)):this.map.datatip.text(a.name+" <br/> "+e.ageGroup+" <br/> "+e.formattedValue);ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,e=b.y-(this.map.datatip.getHeight()+
30)):(c=e.value<0?e.shape.x-(this.map.datatip.getWidth()+5):e.shape.x+e.shape.width+5,e=e.shape.y+e.shape.height/2-this.map.datatip.getHeight()/2);this.map.datatip.position(c,e);this.map.datatip.show();break}}};ia.LineLayer=function(){ia.LineLayer.baseConstructor.call(this);this._xData=[];this._yData=[];this.style={fillStyle:"#ffffff",strokeStyle:"#888888",lineWidth:"2",lineJoin:"round"};this.connectMissingValues=this.animationMode=!1};ia.extend(ia.ItemLayer,ia.LineLayer);
ia.LineLayer.prototype.getXData=function(){return this._xData};ia.LineLayer.prototype.setXData=function(a){this._xData=a;this.dataChanged=!0};ia.LineLayer.prototype.getYData=function(){return this._yData};ia.LineLayer.prototype.setYData=function(a){this._yData=a;this.dataChanged=!0};
ia.LineLayer.prototype.update=function(){if(this.map&&this.dataChanged){this.itemArray=[];this.clearItems();this.xMinValue=Infinity;this.xMaxValue=-Infinity;this.yMinValue=Infinity;this.yMaxValue=-Infinity;var a={id:"myLineId",name:"myLineName"};a.state=ia.ItemLayer.UNSELECTED;a.parent=this;a.layer=this;this.items[a.id]=a;this.itemArray.push(a);this.dataChanged=!1}};
ia.LineLayer.prototype.render=function(){this.clear();for(var a in this.style)this.context[a]=this.style[a],this.highlightContext[a]=this.style[a];this.highlightContext.strokeStyle=ia.Color.toRGBA(this.highlightColor);a=this.itemArray.length;for(var b=0;b<a;b++)this._renderItem(this.itemArray[b])};
ia.LineLayer.prototype.highlightItem=function(a){ia.IS_IE_TEN||(this.highlightContext.beginPath(),this.highlightContext.rect(this.map.canvasX,this.map.canvasY,this.map.canvasWidth,this.map.canvasHeight),this.highlightContext.clip());this._drawItem(a,this.highlightContext)};ia.LineLayer.prototype._renderItem=function(a){ia.IS_IE_TEN||(this.context.beginPath(),this.context.rect(this.map.canvasX,this.map.canvasY,this.map.canvasWidth,this.map.canvasHeight),this.context.clip());this._drawItem(a,this.context)};
ia.LineLayer.prototype._drawItem=function(a,b){b.beginPath();for(var c=this._xData.length,d=!1,e=0;e<c;e++){var f=this._xData[e],g=this._yData[e];ia.isNumber(f)&&ia.isNumber(g)&&(f=this.map.getPixelX(f),g=this.map.getPixelY(g),d==!1?(d=!0,b.moveTo(f,g)):b.lineTo(f,g))}b.stroke()};ia.LineLayer.prototype.hitItem=function(a,b){return this._pointInLine(b.x,b.y)};
ia.LineLayer.prototype._pointInLine=function(a,b){for(var c=new ia.Rectangle(a-4,b-4,8,8),d=this._xData.length,e=0;e<d-1;e++){var f=this.map.getPixelX(this._xData[e]),g=this.map.getPixelY(this._yData[e]),h=this.map.getPixelX(this._xData[e+1]),j=this.map.getPixelY(this._yData[e+1]);if(c.intersectsLine({x:f,y:g},{x:h,y:j}))return!0}return!1};
ia.LineLayer.prototype.showTip=function(a,b){this.map.datatip.text(this.tipFunction(a));var c,d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):(c=b.x+10,d=b.y-this.map.datatip.getHeight());this.map.datatip.position(c,d);this.map.datatip.show()};ia.MapMouseEvent=function(a,b,c,d,e,f,g,h,j,i,m){ia.MapMouseEvent.baseConstructor.call(this,b,c,f,g,a);this.x2=h;this.y2=j;this.dataX=d;this.dataY=e;this.map=a;this.pageX=i;this.pageY=m};
ia.extend(ia.MouseEvent,ia.MapMouseEvent);ia.MapMouseEvent.MAP_PINCH_DOWN="mapPinchDown";ia.MapMouseEvent.MAP_PINCH_MOVE="mapPinchMove";ia.MapMouseEvent.MAP_PINCH_UP="mapPinchUp";ia.MapMouseEvent.MAP_MOUSE_CLICK="mapMouseClick";ia.MapMouseEvent.MAP_MOUSE_DOWN="mapMouseDown";ia.MapMouseEvent.MAP_MOUSE_UP="mapMouseUp";ia.MapMouseEvent.MAP_MOUSE_MOVE="mapMouseMove";ia.MapMouseEvent.MAP_MOUSE_OVER="mapMouseOver";ia.MapMouseEvent.MAP_MOUSE_OUT="mapMouseOut";ia.MapMouseEvent.MAP_MOUSE_WHEEL="mapMouseWheel";
ia.MapMouseEvent.MAP_MOUSE_WHEEL_END="mapMouseWheelEnd";ia.MapMouseEvent.MAP_MOUSE_DRAG="mapMouseDrag";ia.MapMouseEvent.MAP_MOUSE_DRAG_UP="mapMouseDragUp";
ia.Map=function(a){ia.Map.baseConstructor.call(this,a);this._bitmapMode=!1;this._mouseDownPixels=this._mouseDownCoords=this._imageDataBBox=void 0;this._doZoom=this._doPan=!1;this._userDefinedRect=void 0;this._doZoomWheel=!1;this._wheelTimeout=this._lastW=void 0;this.container.addClass("ia-map");this.maintainAspectRatio=!0;this.controller=new ia.MapController(this);this.isDraggable=!0;this.addEventListener(ia.BBoxEvent.BBOX_TRANSLATE,this._bBoxChangeHandler.bind(this));this.addEventListener(ia.BBoxEvent.BBOX_SCALE,
this._bBoxChangeHandler.bind(this));this.markerLayer=new ia.MarkerLayer;this.markerLayer.setMap(this,this.foregroundContainer);this.markerLayer.setVisible(!0)};ia.extend(ia.CanvasBase,ia.Map);
ia.Map.prototype.useNavigation=function(a){a&&(this.addEventListener(ia.MapMouseEvent.MAP_MOUSE_MOVE,this._onMouseMove.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_MOUSE_DOWN,this._onMouseDown.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_MOUSE_DRAG,this._onMouseDrag.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_MOUSE_DRAG_UP,this._onMouseDragUp.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_MOUSE_UP,this._onMouseUp.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_MOUSE_OVER,
this._onMouseOver.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_MOUSE_OUT,this._onMouseOut.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_MOUSE_WHEEL,this._onMouseWheel.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_PINCH_DOWN,this._onPinchDown.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_PINCH_MOVE,this._onPinchMove.bind(this)),this.addEventListener(ia.MapMouseEvent.MAP_PINCH_UP,this._onPinchUp.bind(this)))};
ia.Map.prototype._bBoxChangeHandler=function(){this._bitmapMode?this._drawBitmap():this.render()};ia.Map.prototype.render=function(){this.mapContainer.css({"-moz-transform":"matrix(1, 0, 0, 1, 0, 0)","-webkit-transform":"matrix(1, 0, 0, 1, 0, 0)","-o-transform":"matrix(1, 0, 0, 1, 0, 0)",msTransform:"matrix(1, 0, 0, 1, 0, 0)",transform:"matrix(1, 0, 0, 1, 0, 0)"});for(var a=this.getLayers(),b=0;b<a.length;b++)a[b].render();this.markerLayer.render()};
ia.Map.prototype._drawBitmap=function(){var a=this.getPixelRect(this._imageDataBBox),b,c,d,e,f;this._doPan?(c=b=0,e=d=1,f=a.x,a=a.y):(b=this.mouseX,c=this.mouseY,d=this._imageDataBBox.getWidth()/this.bBox.getWidth(),e=this._imageDataBBox.getHeight()/this.bBox.getHeight(),a=f=0);this.mapContainer.css({"transform-origin":b+"px "+c+"px",msTransformOrigin:b+"px "+c+"px","-moz-transform-origin":b+"px "+c+"px","-webkit-transform-origin":b+"px "+c+"px","-o-transform-origin":b+"px "+c+"px","-moz-transform":"matrix("+
d+", 0, 0, "+e+", "+f+", "+a+")","-webkit-transform":"matrix("+d+", 0, 0, "+e+", "+f+", "+a+")","-o-transform":"matrix("+d+", 0, 0, "+e+", "+f+", "+a+")",msTransform:"matrix("+d+", 0, 0, "+e+", "+f+", "+a+")",transform:"matrix("+d+", 0, 0, "+e+", "+f+", "+a+")"})};ia.Map.prototype._initBitmap=function(){this.datatip.hide();this._bitmapMode=!0;this.doHitTest=!1;this._imageDataBBox=this.getBBox()};
ia.Map.prototype._drawRect=function(a,b,c){for(var d in c)a[d]=c[d];a.beginPath();a.rect(b.x,b.y,b.width,b.height);a.fill();a.stroke()};ia.Map.prototype._drawBBox=function(a,b,c){b=this.getPixelRect(b);this._drawRect(a,b,c)};ia.Map.prototype.zoomToFeatureWithId=function(a,b){for(var c=b||this.getLayers(),d=0;d<c.length;d++){var e=c[d].items,f;for(f in e)if(f==a)return this.zoomToFeature(e[f]),!0}return!1};
ia.Map.prototype.zoomToFeatureWithName=function(a,b){for(var c=b||this.getLayers(),d=0;d<c.length;d++){var e=c[d].items,f;for(f in e){var g=e[f];if(g.name==a)return this.zoomToFeature(g),!0}}return!1};
ia.Map.prototype.zoomToFeature=function(a){var b=a.bBox.clone(),c=b.getWidth()*0.2,d=b.getHeight()*0.2,e=b.getXCenter(),f=b.getYCenter();b.setWidth(b.getWidth()+c*2);b.setHeight(b.getHeight()+d*2);b.setXCenter(e);b.setYCenter(f);this.maxZoom!=-1&&Math.min(b.getWidth(),b.getHeight())<this.maxZoom&&(e=b.getXCenter(),f=b.getYCenter(),b.setWidth(this.maxZoom),b.setHeight(this.maxZoom),b.setXCenter(e),b.setYCenter(f));a.layer.geometry=="point"?this.controller.centerOnCoords(b.getXCenter(),b.getYCenter()):
this.controller.zoomToBBox(b)};ia.Map.prototype.centerOnFeature=function(a){for(var b=this.getLayers(),c=0;c<b.length;c++){var d=b[c].items,e;for(e in d)if(e==a)return a=d[e].bBox,this.controller.centerOnCoords(a.getXCenter(),a.getYCenter()),!0}return!1};ia.Map.prototype._onMouseOver=function(){this._doZoomWheel=!0};ia.Map.prototype._onMouseOut=function(){this.datatip.hide();this._doZoomWheel=!1};
ia.Map.prototype._onMouseDown=function(){ia.disableTextSelection($j("body"));this._mouseDownCoords=this.mouseCoords();this._mouseDownPixels=new ia.Point(this.mouseX,this.mouseY);this._doZoom=this._doPan=!1;this._doPan=!0};ia.Map.prototype._onMouseUp=function(){this._doZoom=this._doPan=!1;ia.enableTextSelection($j("body"))};ia.Map.prototype._onMouseMove=function(){};
ia.Map.prototype._onMouseDrag=function(){var a=this.mouseCoords(),b=new ia.Point(this.mouseX,this.mouseY);if(this._doPan)this._bitmapMode==!1&&this._initBitmap(),ia.showMoveCursor(),a=this._mouseDownCoords.subtract(a),this.controller.translate(a.x,a.y);else if(this._doZoom)this._userDefinedRect=new ia.Rectangle(Math.min(this._mouseDownPixels.x,b.x),Math.min(this._mouseDownPixels.y,b.y),Math.abs(this._mouseDownPixels.x-b.x),Math.abs(this._mouseDownPixels.y-b.y)),this._drawRect(this.context,this._userDefinedRect,
{fillStyle:"rgba(255,255,255,0.5)",strokeStyle:"#CCCCCC",lineWidth:"0.5"})};ia.Map.prototype._onMouseDragUp=function(){var a=this.mouseCoords();this._bitmapMode=!1;this._doZoom?this._userDefinedRect.width>5&&this._userDefinedRect.height>5&&this.controller.zoomToPointExtent(this._mouseDownCoords,a):this._doPan&&this.render();ia.showDefaultCursor();this._doZoom=this._doPan=!1;ia.enableTextSelection($j("body"))};ia.Map.prototype._onPinchDown=function(){this._doZoom=this._doPan=!1};
ia.Map.prototype._onPinchMove=function(a){this._bitmapMode==!1&&this._initBitmap();a=Math.abs(a.x-a.x2);if(this._lastW!=void 0)this.mouseX=this.container.width()/2,this.mouseY=this.container.height()/2,this.controller.zoomOnCenter(this._lastW/a);this._lastW=a};ia.Map.prototype._onPinchUp=function(){this._lastW=void 0;this._bitmapMode=!1;this.render()};
ia.Map.prototype._onMouseWheel=function(a){if(this._doZoomWheel)this.datatip.hide(),this._bitmapMode==!1&&this._initBitmap(),this.controller.zoomOnCursor(a.delta>0?1/1.4:1.4),clearTimeout(this._wheelTimeout),this._wheelTimeout=setTimeout(function(){clearTimeout(this._wheelTimeout);this._bitmapMode=!1;this.render();this.dispatchEvent(new ia.MapMouseEvent(this,a,ia.MapMouseEvent.MAP_MOUSE_WHEEL_END,this.mouseX,this.mouseY))}.bind(this),250)};
ia.GoogleMap=function(a,b,c,d,e,f,g){function h(){s==!1&&(j()?l.controller.zoomFull():l.commitChanges())}function j(){var a=o.getProjection(),b=k.gMap.getBounds(),c=b.getNorthEast();return b.getSouthWest().lng()>=c.lng()?!0:a.getWorldWidth()<=k.container.width()?!0:!1}function i(){var a=k.gMap.getBounds(),b;hw1=m(p);hw2=m(a);if(Math.floor(hw1.x)==0)b=0;else if(Math.floor(hw1.y)==0)b=0;else{b=hw2.x/hw1.x;var c=hw2.y/hw1.y;b=b<c?b:c;b=b<1?0:Math.floor(Math.log(b)/Math.log(2))}b>0&&r?k.gMap.setZoom(k.gMap.getZoom()+
b):(b=a.getNorthEast(),a=a.getSouthWest(),a=n.project(a.lng(),a.lat(),!0),b=n.project(b.lng(),b.lat(),!0),k.bBox.setXMin(a.x),k.bBox.setYMin(a.y),k.bBox.setXMax(b.x),k.bBox.setYMax(b.y),k.commitChanges());r=!1}function m(a){var b=o.getProjection(),c=b.fromLatLngToContainerPixel(a.getSouthWest()),a=b.fromLatLngToContainerPixel(a.getNorthEast());return new google.maps.Point(Math.abs(c.y-a.y),Math.abs(c.x-a.x))}ia.GoogleMap.baseConstructor.call(this);var k=this,n=new ia.GoogleMercatorProjection,l,o,
p,r=!1,s=!1,w=-1,q=-1;this.addMapOverlay=function(a){function b(){this.setMap(k.gMap)}l=a;l.embeddedInGoogleMaps=!0;l.isDraggable=!1;l.addEventListener(ia.Event.MAP_RESIZE,h);var c=k.controller.defaultBBox,a=n.unproject(c.getXMin(),c.getYMin(),!0),c=n.unproject(c.getXMax(),c.getYMax(),!0),a=new google.maps.LatLng(a.latitude,a.longitude),c=new google.maps.LatLng(c.latitude,c.longitude);k.defaultBounds=new google.maps.LatLngBounds(a,c);b.prototype=new google.maps.OverlayView;b.prototype.onAdd=function(){this.getPanes().overlayImage.appendChild(l.container.get(0))};
b.prototype.draw=function(){};b.prototype.onRemove=function(){l.container.parentNode.removeChild(l.container)};o=new b;var f=-1;google.maps.event.addListener(k.gMap,"zoom_changed",function(){var a=k.gMap.getZoom(),b=!0;d!=-1&&a<d&&(b=!1);e!=-1&&a>e&&(b=!1);a==f&&(b=!1);b&&(s=!0,f!=-1&&l.clear(),f=a)});google.maps.event.addListener(k.gMap,"idle",function(){l.clear();var a=o.getProjection();if(j()){var b=k.defaultBounds.getSouthWest(),c=k.defaultBounds.getNorthEast(),d=a.fromLatLngToDivPixel(b),c=a.fromLatLngToDivPixel(c),
e=Math.abs(c.x-d.x),f=Math.abs(d.y-c.y),d=d.x,g=c.y;if(k.controller.defaultBBox.getWidth()>=4E7)e=a.getWorldWidth(),a=a.fromLatLngToContainerPixel(b).x,b=k.container.width()/2,a>b&&(d-=e);l.container.css({left:d+"px",top:g+"px",width:e+"px",height:f+"px"})}else e=k.gMap.getBounds(),b=e.getSouthWest(),c=e.getNorthEast(),d=a.fromLatLngToDivPixel(b).x,g=a.fromLatLngToDivPixel(c).y,e=k.container.width(),f=k.container.height(),l.container.css({left:d+"px",top:g+"px",width:e+"px",height:f+"px"}),a=n.project(b.lng(),
b.lat(),!0),b=n.project(c.lng(),c.lat(),!0),l.getBBox().setXMin(a.x),l.getBBox().setYMin(a.y),l.getBBox().setXMax(b.x),l.getBBox().setYMax(b.y);Math.round(e)==Math.round(w)&&Math.round(f)==Math.round(q)&&l.render();w=e;q=f;s=!1});google.maps.event.addListener(k.gMap,"dragstart",function(){l.startDrag()});google.maps.event.addListener(k.gMap,"dragend",function(){l.endDrag()})};var t=google.maps.MapTypeId.ROADMAP;this.setMapType=function(a){if(a=="greyscale")t=f;else if(a=="off")t=g;else if(a=="normal")t=
google.maps.MapTypeId.ROADMAP;else if(a=="satellite")t=google.maps.MapTypeId.SATELLITE;else if(a=="hybrid")t=google.maps.MapTypeId.HYBRID;else if(a=="physical")t=google.maps.MapTypeId.TERRAIN};this.setBBox=function(a){if(k.gMap){a.equals(k.controller.defaultBBox)&&(r=!0);a.getXMin()<-2E7&&(a.setXMin(-2E7),k.adjustY(a));a.getXMax()>2E7&&(a.setXMax(2E7),k.adjustY(a));var b=n.unproject(a.getXMin(),a.getYMin(),!0),a=n.unproject(a.getXMax(),a.getYMax(),!0),b=new google.maps.LatLng(b.latitude,b.longitude),
a=new google.maps.LatLng(a.latitude,a.longitude);p=new google.maps.LatLngBounds(b,a);k.gMap.fitBounds(p)}};this.zoomToFeatureWithId=function(a){for(var b=l.getLayers(),c=0;c<b.length;c++){var d=b[c].items,e;for(e in d)if(e==a)return k.zoomToFeature(d[e]),!0}return!1};this.zoomToFeatureWithName=function(a,b){for(var c=b||l.getLayers(),d=0;d<c.length;d++){var e=c[d].items,f;for(f in e){var g=e[f];if(g.name==a)return k.zoomToFeature(g),!0}}return!1};this.zoomToFeature=function(a){k.controller.zoomToBBox(a.bBox)};
this.centerOnFeature=function(a){return this.zoomToFeature(a)};(function(){k.id=a;k.apiKey=c;k.setMapType(b);var h=new google.maps.StyledMapType([{featureType:"all",stylers:[{saturation:-80}]}],{name:f}),j=new google.maps.StyledMapType([{stylers:[{visibility:"off"}]}],{name:g}),l={panControl:!1,zoomControl:!1,streetViewControl:!1,overviewMapControl:!0,disableDoubleClickZoom:!0,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID,
google.maps.MapTypeId.TERRAIN,f,g]}};if(d!=-1)l.minZoom=d;if(e!=-1)l.maxZoom=e;k.container=$j("<div id='"+a+"' class='ia-map'>");k.mapContainer=$j("<div id='"+a+"-map-container'>");k.container.append(k.mapContainer);k.controller=new ia.MapController(k);var m;k.container.resize(function(){clearTimeout(m);m=setTimeout(function(){clearTimeout(m);var b=k.container.width(),c=k.container.height();if(k.mapContainer.width()!=b||k.mapContainer.height()!=c){k.mapContainer.width(b);k.mapContainer.height(c);
k.canvasWidth=b;k.canvasHeight=c;k.commitChanges();if(k.gMap==void 0)k.gMap=new google.maps.Map(document.getElementById(a+"-map-container"),l),google.maps.event.addListener(k.gMap,"bounds_changed",i),k.gMap.mapTypes.set(f,h),k.gMap.mapTypes.set(g,j),k.gMap.setMapTypeId(t),b=new ia.Event(ia.Event.MAP_READY,k),k.dispatchEvent(b);google.maps.event.trigger(k.gMap,"resize")}},500)})})()};ia.extend(ia.CartesianSpace,ia.GoogleMap);ia.MapController=function(a){this._map=a};
ia.MapController.prototype.panN=function(){this.pan(0)};ia.MapController.prototype.panNE=function(){this.pan(45)};ia.MapController.prototype.panE=function(){this.pan(90)};ia.MapController.prototype.panSE=function(){this.pan(135)};ia.MapController.prototype.panS=function(){this.pan(180)};ia.MapController.prototype.panSW=function(){this.pan(225)};ia.MapController.prototype.panW=function(){this.pan(270)};ia.MapController.prototype.panNW=function(){this.pan(315)};
ia.MapController.prototype.pan=function(a,b){b==null&&(b=0.5);var c=Math.abs(b),c=a>=45&&a<=135||a>=225&&a<=315?this._map.getBBox().getWidth()*c:this._map.getBBox().getHeight()*c;this.panDistance(a,c)};ia.MapController.prototype.panDistance=function(a,b){if(a>=0&&a<=360){var c=a*(Math.PI/180);this.translate(Math.sin(c)*b,Math.cos(c)*b)}};ia.MapController.prototype.centerOnCursor=function(){this.centerOnPoint(this._map.mouseCoords())};
ia.MapController.prototype.centerOnPoint=function(a){this.centerOnCoords(a.x,a.y)};ia.MapController.prototype.centerOnCoords=function(a,b){var c=this._map.getBBox().getXMin()+this._map.getBBox().getWidth()/2,d=this._map.getBBox().getYMin()+this._map.getBBox().getHeight()/2;this.translate(a-c,b-d)};
ia.MapController.prototype.translate=function(a,b){var c=this._map.getBBox().getXMin()+a,d=this._map.getBBox().getYMin()+b,e=this._map.getBBox().getWidth(),f=this._map.getBBox().getHeight();this.resetBBox(c,d,e,f)};ia.MapController.prototype.zoomIn=function(){this.zoomOnCenter(0.5)};ia.MapController.prototype.zoomOut=function(){this.zoomOnCenter(2)};
ia.MapController.prototype.zoomOnCenter=function(a){a==null&&(a=0.5);var b=this._map.getBBox().getXMin()+this._map.getBBox().getWidth()/2,c=this._map.getBBox().getYMin()+this._map.getBBox().getHeight()/2;this.zoomOnCoords(b,c,a)};ia.MapController.prototype.zoomInOnCursor=function(){this.zoomOnPoint(this._map.mouseCoords(),0.5)};ia.MapController.prototype.zoomOutOnCursor=function(){this.zoomOnPoint(this._map.mouseCoords(),2)};
ia.MapController.prototype.zoomOnCursor=function(a){a==null&&(a=0.5);this.zoomOnPoint(this._map.mouseCoords(),a)};ia.MapController.prototype.zoomOnPoint=function(a,b){b==null&&(b=0.5);this.zoomOnCoords(a.x,a.y,b)};
ia.MapController.prototype.zoomOnCoords=function(a,b,c){c==null&&(c=0.5);var d=Math.abs(c),c=this._map.getBBox().getWidth()*d;d*=this._map.getBBox().getHeight();a-=(a-this._map.getBBox().getXMin())/this._map.getBBox().getWidth()*c;b-=(b-this._map.getBBox().getYMin())/this._map.getBBox().getHeight()*d;this.resetBBox(a,b,c,d)};ia.MapController.prototype.zoomToPointExtent=function(a,b){this.resetBBox(Math.min(a.x,b.x),Math.min(a.y,b.y),Math.abs(a.x-b.x),Math.abs(a.y-b.y))};
ia.MapController.prototype.zoomToExtent=function(a){var b=this._map.getBBox().getXMin()+this._map.getBBox().getWidth()/2,c=this._map.getBBox().getYMin()+this._map.getBBox().getHeight()/2,d=a.width,a=a.height;this.resetBBox(b-d/2,c-a/2,d,a)};ia.MapController.prototype.changeBBox=function(a,b,c,d){a=this._map.getBBox().getXMin()+a;b=this._map.getBBox().getYMin()+b;c=this._map.getBBox().getXMax()+c;d=this._map.getBBox().getYMax()+d;this.resetBBox(a,b,c-a,d-b)};
ia.MapController.prototype.zoomToRect=function(a){a.width>5&&a.height>5&&this.zoomToBBox(this.getDataBBox(a))};ia.MapController.prototype.zoomFull=function(){this.zoomToBBox(this.defaultBBox)};ia.MapController.prototype.zoomToBBox=function(a){a&&this._map.setBBox(a)};ia.MapController.prototype.resetBBox=function(a,b,c,d){this.zoomToBBox(new ia.BoundingBox(a,b,a+c,b+d))};
ia.FeatureLayer=function(a){ia.FeatureLayer.baseConstructor.call(this);this.dataLabel="";this.minLabelExtent=-Infinity;this.maxLabelExtent=Infinity;this.symbolSize=15;this.iconPath="";this.eval=!0;this.uid="";this.symbol=ia.Shape.CIRCLE;this.highlightOpacity=this.selectionOpacity=0.3;if(a!=null)this.source=a};ia.extend(ia.ItemLayer,ia.FeatureLayer);
ia.FeatureLayer.prototype.loadSource=function(){var a=this;ia.File.load(a.source,"json",function(b){a.parseData(b);a.isLoaded=!0;a.render();b=new ia.Event(ia.Event.LAYER_READY,a);a.dispatchEvent(b)})};
ia.FeatureLayer.prototype.parseData=function(a){this.items={};this.itemArray=[];if(a.e!=void 0)this.eval=!1;if(a.uid!=void 0)this.uid=a.uid;for(var b=a.boundingBox.split(" "),c=new ia.BoundingBox(parseFloat(b[0]),parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3])),b=c.getXMin(),d=c.getYMin(),e=c.getWidth(),c=c.getHeight(),f=parseFloat(a.pixelWidth),g=parseFloat(a.pixelHeight),h=Infinity,j=Infinity,i=-Infinity,m=-Infinity,k=a.features.length,n=0;n<k;n++){var l=a.features[n],o={};o.state=ia.ItemLayer.UNSELECTED;
o.layer=this;o.id=l.d;o.name=l.n;o.parent=this;o.symbolSize=this.symbolSize;if(this.geometry=="line")o.symbolSize=this.style.lineWidth;if(this.geometry=="polygon"||this.geometry=="line"){for(var p=Infinity,r=Infinity,s=-Infinity,w=-Infinity,q=l.p.length,t=[],ca=0;ca<q;ca++){for(var v=l.p[ca],L=v.length-1,O=[],u=0,da=0,ea=0;ea<L;ea+=2){var A={};u+=v[ea];da+=v[ea+1];A.x=b+u/f*e;A.y=d+da/g*c;O.push(A);p=A.x<p?A.x:p;r=A.y<r?A.y:r;s=A.x>s?A.x:s;w=A.y>w?A.y:w}t.push(O)}o.shapes=t}else A={},A.x=b+l.p[0]/
f*e,A.y=d+l.p[1]/g*c,p=A.x,r=A.y,s=A.x,w=A.y,o.shapes=[A];o.bBox=new ia.BoundingBox(p,r,s,w);o.size=Math.max(o.bBox.getWidth(),o.bBox.getHeight());this.items[o.id]=o;this.itemArray.push(o);h=p<h?p:h;j=r<j?r:j;i=s>i?s:i;m=w>m?w:m}this.bBox=new ia.BoundingBox(h,j,i,m);if(this.iconPath!="")this.icon=new Image,this.icon.onload=function(){},this.icon.src=this.iconPath};ia.FeatureLayer.prototype.render=function(){this.map&&this.getVisible()&&this.isLoaded&&(this.clear(),this.draw())};
ia.FeatureLayer.prototype.draw=function(){if(this.map&&this.getVisible()&&this.isLoaded){for(var a in this.style)this.context[a]=this.style[a],this.interactive&&(this.selectionContext[a]=this.style[a],this.highlightContext[a]=this.style[a]);if(this.interactive)this.selectionContext.strokeStyle=this.selectionColor,this.selectionContext.fillStyle=ia.Color.toRGBA(this.selectionColor,this.selectionOpacity),this.selectionContext.lineWidth=Math.max(2,parseFloat(this.style.lineWidth)+1.5),this.highlightContext.strokeStyle=
ia.Color.toRGBA(this.highlightColor,0.8),this.highlightContext.fillStyle=ia.Color.toRGBA(this.highlightColor,this.highlightOpacity),this.highlightContext.lineWidth=Math.max(2,parseFloat(this.style.lineWidth)+1.5);a=this.getData();var b=this.map.getBBox();if(this.bBox.intersects(b)){var c=!1,d=Math.min(b.getWidth(),b.getHeight()),e=Math.max(b.getWidth(),b.getHeight());d>=this.minLabelExtent&&e<=this.maxLabelExtent&&(c=!0);d=this.itemArray.length;for(e=0;e<d;e++){var f=this.itemArray[e];if(this.dataChanged){var g=
a[f.id];if(g){f.name=g.name;f.disabled=!1;var h=ia.Color.a(this.style.fillStyle);if(g.color)f.color=ia.Color.toRGBA(g.color,h);f.symbolSize=g.symbolSize}else f.disabled=!0,f.color=this.style.fillStyle,f.symbolSize=0}this.geometry!="point"&&f.bBox&&f.bBox.intersects(b)&&(this.renderItem(f),this.showLabels&&c&&this.renderItemLabel(f))}if(this.geometry=="point"){this.itemArray.sort(function(a,b){return a.symbolSize<b.symbolSize?1:a.symbolSize>b.symbolSize?-1:0});d=this.itemArray.length;for(e=0;e<d;e++)f=
this.itemArray[e],f.bBox&&f.bBox.intersects(b)&&f.symbolSize>0&&(this.renderItem(f),this.showLabels&&c&&this.renderItemLabel(f))}if(this.dataChanged)this.dataChanged=!1}this.renderSelection()}};ia.FeatureLayer.prototype.selectItem=function(a){this._drawItem(a,this.selectionContext)};ia.FeatureLayer.prototype.highlightItem=function(a){this._drawItem(a,this.highlightContext)};
ia.FeatureLayer.prototype.renderItem=function(a){if(a.color&&(this.context.fillStyle=a.color,this.geometry=="line"))this.context.strokeStyle=a.color;this._drawItem(a,this.context)};
ia.FeatureLayer.prototype._drawItem=function(a,b){if(this.getVisible()){b.beginPath();var c=a.shapes.length;if(this.geometry=="polygon")for(var d=0;d<c;d++){var e=a.shapes[d],f=e.length;b.moveTo(this.map.getPixelX(e[0].x),this.map.getPixelY(e[0].y));for(var g=1;g<f;g++)b.lineTo(this.map.getPixelX(e[g].x),this.map.getPixelY(e[g].y))}else if(this.geometry=="point")for(d=0;d<c;d++)e=a.shapes[d],f=this.map.getPixelX(e.x),e=this.map.getPixelY(e.y),this.icon!=void 0?b.drawImage(this.icon,f-this.icon.width/
2,e-this.icon.height/2,this.icon.width,this.icon.height):a.symbolSize>0&&ia.Shape.draw(this.symbol,b,f,e,a.symbolSize);else if(this.geometry=="line"&&a.symbolSize>0){for(d=0;d<c;d++){e=a.shapes[d];f=e.length;b.moveTo(this.map.getPixelX(e[0].x),this.map.getPixelY(e[0].y));for(g=1;g<f;g++)b.lineTo(this.map.getPixelX(e[g].x),this.map.getPixelY(e[g].y))}b.lineWidth=a.symbolSize}this.geometry!="line"&&b.fill();b.stroke()}};
ia.FeatureLayer.prototype.renderItemLabel=function(a){var b=this.map.getPixelX(a.bBox.getXCenter()),c=this.map.getPixelY(a.bBox.getYCenter());this.geometry=="polygon"?(this.labelContext.textBaseline="middle",this.labelContext.textAlign="center"):(this.labelContext.textBaseline="bottom",this.labelContext.textAlign="left",this.icon?(b+=this.icon.width/2,c-=this.icon.width/2):(b+=a.symbolSize/2,c-=a.symbolSize/2));this.labelContext.strokeText(a.name,b,c);this.labelContext.fillText(a.name,b,c)};
ia.FeatureLayer.prototype.hitItem=function(a,b){var c=b.dataX,d=b.dataY;if(this.geometry=="point")for(var e=a.shapes,f,g=0;g<e.length;g++){if(f=e[g],f=this.iconPath!=""?this._pointInRect(this.icon.width,this.icon.height,f,c,d):this._pointInRect(a.symbolSize,a.symbolSize,f,c,d))return!0}else if(this.geometry=="polygon"){if(a.bBox)if(c<a.bBox.left()||c>a.bBox.right())return!1;else if(d>a.bBox.top()||d<a.bBox.bottom())return!1;e=a.shapes;for(g=0;g<e.length;g++)if(f=this._pointInPoly(e[g],c,d))return!0}else if(this.geometry==
"line"){if(a.bBox)if(c<a.bBox.left()||c>a.bBox.right())return!1;else if(d>a.bBox.top()||d<a.bBox.bottom())return!1;c=a.shapes;for(g=0;g<c.length;g++)if(f=this._pointInLine(c[g],b.x,b.y))return!0}return!1};ia.FeatureLayer.prototype._pointInLine=function(a,b,c){for(var b=new ia.Rectangle(b-4,c-4,8,8),c=a.length,d=0;d<c-1;d++){var e=this.map.getPixelX(a[d].x),f=this.map.getPixelY(a[d].y),g=this.map.getPixelX(a[d+1].x),h=this.map.getPixelY(a[d+1].y);if(b.intersectsLine({x:e,y:f},{x:g,y:h}))return!0}return!1};
ia.FeatureLayer.prototype._pointInPoly=function(a,b,c){var d,e,f=0;d=0;for(e=a.length-1;d<a.length;e=d++)a[d].y>c!=a[e].y>c&&b<(a[e].x-a[d].x)*(c-a[d].y)/(a[e].y-a[d].y)+a[d].x&&(f=!f);return f};ia.FeatureLayer.prototype._pointInRect=function(a,b,c,d,e){var f=c.x,c=c.y,a=this.map.getDataWidth(a),b=this.map.getDataHeight(b);return d>=f-a/2&&d<=f+a/2&&e>=c-b/2&&e<=c+b/2?!0:!1};
ia.FeatureLayer.prototype.showTip=function(a,b){this.map.datatip.text(this.tipFunction(a));var c,d;ia.IS_TOUCH_DEVICE?(c=b.x-this.map.datatip.getWidth()/2,d=b.y-(this.map.datatip.getHeight()+30)):this.geometry=="point"?(c=this.map.getPixelX(a.bBox.getXCenter())+a.symbolSize/2,d=this.map.getPixelY(a.bBox.getYCenter())-a.symbolSize/2-this.map.datatip.getHeight()):(c=b.x+10,d=b.y-this.map.datatip.getHeight());this.map.datatip.position(c,d);this.map.datatip.show()};
ia.TileLayer=function(a){ia.TileLayer.baseConstructor.call(this);this._tileCache=[];this.path="./";this.minExtent=-Infinity;this.maxExtent=Infinity;if(a!=null)this.source=a};ia.extend(ia.LayerBase,ia.TileLayer);
ia.TileLayer.prototype.render=function(){if(this.map&&this.getVisible()&&this.isLoaded){this.clear();var a=this.map.getBBox(),a=Math.min(a.getWidth(),a.getHeight());if(a>this.minExtent&&a<this.maxExtent)for(var a=this.map.getBBox(),b=this._tileCache.length,c=0;c<b;c++){var d=this._tileCache[c];d.bBox.intersects(a)&&this._renderTile(d)}}};
ia.TileLayer.prototype._renderTile=function(a){if(a.image){var b=this.map.getPixelRect(a.bBox);this.context.drawImage(a.image,b.x,b.y,b.width,b.height)}else{var c=this,d=new Image;d.onload=function(){a.image=d;c._renderTile(a)};d.src=a.path}};ia.TileLayer.prototype.loadSource=function(){var a=this;ia.File.load(this.source,"json",function(b){a.parseData(b);a.isLoaded=!0;a.render();b=new ia.Event(ia.Event.LAYER_READY,a);a.dispatchEvent(b)})};
ia.TileLayer.prototype.parseData=function(a){this.path.indexOf("/",this.path.length-1)==-1&&(this.path+="/");var b=ia.File.getFileDirectory(this.source)+this.path,c=a.boundingBox.split(" "),d=new ia.BoundingBox(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3])),e=parseFloat(a.pixelWidth),f=parseFloat(a.pixelHeight),g=a.tileWidth/e*d.getWidth(),h=a.tileHeight/f*d.getHeight(),j=this;$j.each(a.tiles,function(c,m){var k=d.getXMin()+m.x/e*d.getWidth(),n=k+g,l=d.getYMax()-m.y/f*d.getHeight(),
o=l-h,p={};p.id=m.id;p.bBox=new ia.BoundingBox(k,o,n,l);p.path=b+p.id+"."+a.tileExtension;j._tileCache[j._tileCache.length]=p})};ia.ImageLayer=function(){ia.ImageLayer.baseConstructor.call(this,"");this._item=void 0;this.version=this.srs=this.layers=this.params=this.url=""};ia.extend(ia.LayerBase,ia.ImageLayer);
ia.ImageLayer.prototype.render=function(){if(this.map&&this.getVisible()){this.clear();this.draw(this.context);var a=new Image;this._item={};this._item.bBox=this.map.getBBox().clone();this._item.img=a;var b=this;a.onload=function(){var a=b.map.getPixelRect(b._item.bBox);b.clear();b.context.drawImage(b._item.img,a.x,a.y,a.width,a.height)};a.src=this.getUrl(this.map.getBBox(),this.map.canvasWidth,this.map.canvasHeight)}};
ia.ImageLayer.prototype.draw=function(a){try{if(this._item&&this._item.img){var b=this.map.getPixelRect(this._item.bBox);a.drawImage(this._item.img,b.x,b.y,b.width,b.height)}}catch(c){ia.log(c)}};ia.ImageLayer.prototype.getUrl=function(){};ia.AGSLayer=function(){ia.AGSLayer.baseConstructor.call(this)};ia.extend(ia.ImageLayer,ia.AGSLayer);
ia.AGSLayer.prototype.getUrl=function(a,b,c){var d=this.url;this.url.indexOf("?")==-1&&(d+="?");this.url.charAt(this.url.length-1)!="&"&&this.url.charAt(this.url.length-1)!="?"&&(d+="&");d+="bbox="+a.getXMin()+","+a.getYMin()+","+a.getXMax()+","+a.getYMax();this.params.toLowerCase().indexOf("f=")<0&&(d+="&f=image");this.params.toLowerCase().indexOf("layers=")<0&&(d+="&layers="+this.layers);this.params.toLowerCase().indexOf("bboxSR=")<0&&(d+="&bboxSR="+this.srs);this.params.toLowerCase().indexOf("imageSR=")<
0&&(d+="&imageSR="+this.srs);this.params.toLowerCase().indexOf("format=")<0&&(d+="&format=jpg");this.params.toLowerCase().indexOf("size=")<0&&(d+="&size="+Math.round(b)+","+Math.round(c));d+=this.params;return d};ia.AGSFeatureLayer=function(a){ia.AGSFeatureLayer.baseConstructor.call(this,a);this._firstRender=!0;this._renderQueue=this._rendering=!1;this._maxRecordCount=Infinity;this.nameField=this.idField=this._objectIdField="";this.srs=102100};ia.extend(ia.FeatureLayer,ia.AGSFeatureLayer);
ia.AGOLData.prototype._useToken=!0;
ia.AGSFeatureLayer.prototype.loadSource=function(){var a=this;a.eval=!1;ia.File.load(a.source+"?f=json","json",function(b){b.error&&ia.log(b.error);if(b.error&&b.error.code==498)a._useToken=!1,a.loadSource();else{a.esriGeometryType=b.geometryType;if(b.maxRecordCount!=void 0)a._maxRecordCount=ia.parseInt(b.maxRecordCount);b=a.source+"/query?where=1+%3D+1&f=json&returnIdsOnly=true";a.objectIds!=void 0&&(b=a.source+"/query?objectIds="+a.objectIds+"&f=json&returnIdsOnly=true");ia.File.load(b,"json",function(b){function d(b){for(var c=
b.length,e=0;e<c;e++){var k=b[e],n={};n.objectId=k.attributes[a._objectIdField];n.id=k.attributes[a.idField];n.name=k.attributes[a.nameField];n.parent=a;n.state=ia.ItemLayer.UNSELECTED;n.layer=a;n.symbolSize=a.symbolSize;n.shapes=[];a.items[n.id]=n;a.itemArray.push(n)}h++;h<g?a.getFeatureDetails(f[h],d):(a.isLoaded=!0,a.render(),b=new ia.Event(ia.Event.LAYER_READY,a),a.dispatchEvent(b))}if(b.error&&b.error.code==499){var e="https://www.arcgis.com/sharing/oauth2/authorize?client_id=83wV2txRMBrDpKjq&response_type=token&redirect_uri="+
encodeURI(window.location.href);window.location.href=e}a._objectIdField=b.objectIdFieldName;a._maxRecordCount=Math.min(b.objectIds.length,a._maxRecordCount);for(var f=[];b.objectIds.length>0;)f[f.length]=b.objectIds.splice(0,a._maxRecordCount);a.items={};a.itemArray=[];if(a.geometry=="line")a.symbolSize=a.style.lineWidth;var g=f.length,h=0;a.getFeatureDetails(f[h],d)},a._useToken)}},a._useToken)};
ia.AGSFeatureLayer.prototype.getFeatureDetails=function(a,b){ia.File.postJSON(this.source+"/query","where=1+%3D+1&f=json&returnGeometry=false&objectIds="+a+"&outFields="+this._objectIdField+","+this.idField+","+this.nameField,function(a){b.call(null,a.features)},this._useToken)};
ia.AGSFeatureLayer.prototype.render=function(){if(this.map&&this.getVisible()&&this.isLoaded)this._rendering==!1?(this._rendering=!0,this._updateItems(function(){this._rendering=!1;if(this._renderQueue)this._renderQueue=!1,this.render()}.bind(this))):(this._firstRender&&(this.clear(),this.draw()),this._renderQueue=!0)};
ia.AGSFeatureLayer.prototype._updateItems=function(a){if(this.map&&this.getVisible()){this.clear();this.draw();for(var b=this.map.getDataWidth(1),c=[],d=[],e=[],f=this.map.getBBox(),g=0,h=[],j=[],i=this.itemArray.length,m=0;m<i;m++){var k=this.itemArray[m];if(k.bBox==void 0)j[j.length]=k,e[e.length]=k,h[h.length]=k.objectId,g++;else if(k.bBox.intersects(f)&&(j[j.length]=k,e[e.length]=k,k.maxAllowableOffset>b))h[h.length]=k.objectId,g++;if(g==this._maxRecordCount||m==i-1&&h.length>0)c[c.length]=h,
d[d.length]=j,g=0,h=[],j=[]}if(c.length>0){var n=c.length,l=0,o=this,p=function(f){o._firstRender&&l==0&&o.clear();o.parseData(f,b);o._firstRender&&o._renderItems(d[l]);l++;o._renderQueue==!0?a.call(null):l==n?(o._firstRender||(o.clear(),o._renderItems(e)),o.renderSelection(),o._firstRender=!1,a.call(null)):o.getFeatures(c[l],b,p)};this.getFeatures(c[l],b,p)}else this.renderSelection(),a.call(null)}};
ia.AGSFeatureLayer.prototype.getFeatures=function(a,b,c){ia.File.postJSON(this.source+"/query","where=1+%3D+1&f=json&returnGeometry=true&objectIds="+a+"&maxAllowableOffset="+b+"&outFields="+this._objectIdField+","+this.idField+","+this.nameField+"&outSR="+this.srs,function(a){c.call(null,a.features)},this._useToken)};
ia.AGSFeatureLayer.prototype.parseData=function(a,b){var c="rings";this.geometry=="line"&&(c="paths");for(var d=a.length,e=0;e<d;e++){var f=a[e],g=this.items[f.attributes[this.idField]];g.maxAllowableOffset=b;if(this.geometry=="polygon"||this.geometry=="line"){var h=Infinity,j=Infinity,i=-Infinity,m=-Infinity;if(f.geometry){for(var k=f.geometry[c].length,n=[],l=0;l<k;l++){for(var o=f.geometry[c][l],p=o.length,r=[],s=0;s<p;s++){var w=o[s],q={};q.x=w[0];q.y=w[1];r.push(q);h=q.x<h?q.x:h;j=q.y<j?q.y:
j;i=q.x>i?q.x:i;m=q.y>m?q.y:m}n.push(r)}g.shapes=n}}else if(this.esriGeometryType=="esriGeometryPoint"){if(f.geometry)q={},q.x=f.geometry.x,q.y=f.geometry.y,h=q.x,j=q.y,i=q.x,m=q.y,g.shapes=[q]}else if(p=f.geometry.points.length,n=[],f.geometry){for(l=0;l<p;l++)w=f.geometry.points[l],q={},q.x=w[0],q.y=w[1],h=q.x,j=q.y,i=q.x,m=q.y,n.push(r);g.shapes=n}g.bBox=new ia.BoundingBox(h,j,i,m);g.size=Math.max(g.bBox.getWidth(),g.bBox.getHeight())}if(this.iconPath!="")this.icon=new Image,this.icon.onload=function(){},
this.icon.src=this.iconPath};ia.AGSFeatureLayer.prototype._renderItems=function(a){a==void 0&&(a=this.itemArray.concat());for(var b=a.length,c=0;c<b;c++){var d=a[c];if(this.geometry!="point"||this.geometry=="point"&&d.symbolSize>0)this.renderItem(d),this.showLabels&&this.renderItemLabel(d)}};ia.WMSLayer=function(){ia.WMSLayer.baseConstructor.call(this);this.requiresAxisSwitch=!1};ia.extend(ia.ImageLayer,ia.WMSLayer);
ia.WMSLayer.prototype.getUrl=function(a,b,c){var d=this.url;this.url.indexOf("?")==-1&&(d+="?");this.url.charAt(this.url.length-1)!="&"&&this.url.charAt(this.url.length-1)!="?"&&(d+="&");d+=this.requiresAxisSwitch==!0?"request=GetMap&bbox="+a.getYMin()+","+a.getXMin()+","+a.getYMax()+","+a.getXMax():"request=GetMap&bbox="+a.getXMin()+","+a.getYMin()+","+a.getXMax()+","+a.getYMax();this.params.toLowerCase().indexOf("layers=")<0&&(d+="&layers="+this.layers);this.params.toLowerCase().indexOf("srs=")<
0&&(d+="&srs="+this.srs);this.params.toLowerCase().indexOf("crs=")<0&&(d+="&crs="+this.srs);this.params.toLowerCase().indexOf("width=")<0&&(d+="&width="+Math.round(b));this.params.toLowerCase().indexOf("height=")<0&&(d+="&height="+Math.round(c));this.params.toLowerCase().indexOf("version=")<0&&(d+="&version="+this.version);this.params.toLowerCase().indexOf("format=")<0&&(d+="&format=image/jpeg");this.params.toLowerCase().indexOf("exceptions=")<0&&(d+="&exceptions=application/vnd.ogc.se_blank");this.params.toLowerCase().indexOf("service=")<
0&&(d+="&service=WMS");this.params.toLowerCase().indexOf("styles=")<0&&(d+="&styles=");d+=this.params;return d};ia.MarkerLayer=function(){ia.MarkerLayer.baseConstructor.call(this);this._markers=[]};ia.extend(ia.LayerBase,ia.MarkerLayer);ia.MarkerLayer.prototype.addMarker=function(a,b,c){var d={};d.icon=a;d.x=b;d.y=c;this._markers[this._markers.length]=d};ia.MarkerLayer.prototype.clearMarkers=function(){this._markers=[];this.clear()};
ia.MarkerLayer.prototype.render=function(){this.clear();for(var a=0;a<this._markers.length;a++){var b=this._markers[a],c=this.map.getPixelX(b.x)-b.icon.width/2,d=this.map.getPixelY(b.y)-b.icon.height;this.context.drawImage(b.icon,c,d)}};ia.GoogleMercatorProjection=function(){this._originLon=this._originLat=0;this._ellipsoid={};this._ellipsoid.id="WGS_84";this._ellipsoid.semiMajorAxis=6378137;this._ellipsoid.inverseFlattening=298.257223563;this._checkEllipsoid()};
ia.GoogleMercatorProjection.prototype._checkEllipsoid=function(){this._ellipsoid.semiMinorAxis==void 0&&(this._ellipsoid.semiMinorAxis=this._ellipsoid.semiMajorAxis-this._ellipsoid.semiMajorAxis/this._ellipsoid.inverseFlattening);if(this._ellipsoid.eccentricity==void 0){var a=(this._ellipsoid.semiMajorAxis-this._ellipsoid.semiMinorAxis)/this._ellipsoid.semiMajorAxis;this._ellipsoid.eccentricity=Math.sqrt(2*a-a*a)}};
ia.GoogleMercatorProjection.prototype.project=function(a,b){var c={},d=Math.PI*(b/180),e=this._ellipsoid.semiMajorAxis;c.x=e*(Math.PI*(a/180)-Math.PI*(this._originLon/180));c.y=e*Math.log(Math.tan(Math.PI/4+d/2));return c};ia.GoogleMercatorProjection.prototype.unproject=function(a,b){var c={},d=this._ellipsoid.semiMajorAxis,e=Math.PI/2-2*Math.atan(Math.pow(Math.E,(0-b)/d));c.longitude=(a/d+Math.PI*(this._originLon/180))*180/Math.PI;c.latitude=e*180/Math.PI;return c};
ia.GeoRSSLayer=function(a){ia.GeoRSSLayer.baseConstructor.call(this,a);this._mp=new ia.GoogleMercatorProjection;this._layerMinY=this._layerMinX=Infinity;this._layerMaxY=this._layerMaxX=-Infinity;$j.support.cors=!0};ia.extend(ia.FeatureLayer,ia.GeoRSSLayer);
ia.GeoRSSLayer.prototype.loadSource=function(){var a=this;$j.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&output=xml&num=10&callback=?&q="+encodeURIComponent(a.source),dataType:"json",success:function(b){a.parseData(b.responseData.xmlString);a.isLoaded=!0;a.render();b=new ia.Event(ia.Event.LAYER_READY,a);a.dispatchEvent(b)}})};
ia.GeoRSSLayer.prototype.parseData=function(a){a=$j(a);this.items={};this.itemArray=[];var b=this,c=a.find("item");$j.each(c,function(a,c){b._toFeature(c)});c=a.find("atom\\:entry, entry");$j.each(c,function(a,c){b._toFeature(c)});this.bBox=new ia.BoundingBox(this._layerMinX,this._layerMinY,this._layerMaxX,this._layerMaxY);if(this.iconPath!="")this.icon=new Image,this.icon.onload=function(){},this.icon.src=this.iconPath};
ia.GeoRSSLayer.prototype._toFeature=function(a){var b={};b.state=ia.ItemLayer.UNSELECTED;b.layer=this;b.id=$j(a).find("guid").text();b.name=$j(a).find("title").text();b.description=$j(a).find("description").text();b.parent=this;b.symbolSize=this.symbolSize;a=this._toPoint(a);minX=a.x;minY=a.y;maxX=a.x;maxY=a.y;b.shapes=[a];b.bBox=new ia.BoundingBox(minX,minY,maxX,maxY);b.size=Math.max(b.bBox.getWidth(),b.bBox.getHeight());this.items[b.id]=b;this.itemArray.push(b);this._layerMinX=minX<this._layerMinX?
minX:this._layerMinX;this._layerMinY=minY<this._layerMinY?minY:this._layerMinY;this._layerMaxX=maxX>this._layerMaxX?maxX:this._layerMaxX;this._layerMaxY=maxY>this._layerMaxY?maxY:this._layerMaxY};
ia.GeoRSSLayer.prototype._toPoint=function(a){var b={x:0,y:0},c=$j(a).find("geo\\:long, long"),d=$j(a).find("geo\\:lat, lat");if(c.length>0&&d.length>0)return b.x=parseFloat($j(c).text()),b.y=parseFloat($j(d).text()),b=this._mp.project(b.x,b.y,!0);c=$j(a).find("georss\\:point, point");if(c.length>0)return a=jQuery.trim($j(c).text()).split(" "),b.x=parseFloat(a[0]),b.y=parseFloat(a[1]),b=this._mp.project(b.x,b.y,!0);a=$j(a).find("gml\\:pos, pos");if(a.length>0)a=jQuery.trim($j(a).text()).split(" "),
b.x=parseFloat(a[0]),b.y=parseFloat(a[1]),b=this._mp.project(b.x,b.y,!0);return b};ia.Thematic=function(a){ia.Thematic.baseConstructor.call(this);this._data={};this._dataField="value";this._dataType="numeric";this._dataChanged=!0;this.symbol=ia.Shape.SQUARE;this.noDataValue="No Data";this.numericClassifier=new ia.NumericClassifier;this.categoricClassifier=new ia.CategoricClassifier;a!=void 0&&this.setData(a)};ia.extend(ia.EventDispatcher,ia.Thematic);ia.Thematic.CONTINUOUS="continuous";
ia.Thematic.EQUAL_INTERVAL="equalInterval";ia.Thematic.QUANTILE="quantile";ia.Thematic.NATURAL="natural";ia.Thematic.STANDARD_DEVIATION="standardDeviation";ia.Thematic.NUMERIC="numeric";ia.Thematic.CATEGORIC="categoric";ia.Thematic.prototype.getData=function(){return this._data};ia.Thematic.prototype.setData=function(a){this._data=a;this._dataChanged=!0};ia.Thematic.prototype.getDataField=function(){return this._dataField};
ia.Thematic.prototype.setDataField=function(a){this._dataField=a;this._dataChanged=!0};ia.Thematic.prototype.getDataType=function(){return this._dataType};ia.Thematic.prototype.setDataType=function(a){this._dataType=a;this._dataChanged=!0};ia.Thematic.prototype.getClasses=function(){return this.numericClassifier.getClasses().concat(this.categoricClassifier.getClasses())};
ia.Thematic.prototype.getClass=function(a){return this._dataType==ia.Thematic.CATEGORIC?this.categoricClassifier.getClass(a):ia.isNumber(a)?this.numericClassifier.getClass(a):this.categoricClassifier.getClass(a)};
ia.Thematic.prototype.commitChanges=function(){if(this._dataChanged){var a=[],b=[],c,d,e;for(e in this._data)c=this._data[e],d=c[this._dataField],this._dataType==ia.Thematic.CATEGORIC?b.push(d):ia.isNumber(d)?a.push(d):b.push(d);this.numericClassifier.setData(a);this.categoricClassifier.setData(b)}this.numericClassifier.commitChanges();this.categoricClassifier.commitChanges();for(var a=this.getClasses(),b=a.length,f,g=0;g<b;g++)if(f=a[g],f.symbol=this.symbol,f.index=g,f.getLabel()==this.noDataValue&&
f.symbol!=ia.Shape.LINE&&f.symbol!=ia.Shape.SQUARE)f.size=0;for(e in this._data){c=this._data[e];d=c[this._dataField];for(g=0;g<b;g++)if(f=a[g],f.contains(d)){c.color=f.color;c.symbolSize=f.size;c.legendClass=f;f.items.push(c);break}}this.dispatchEvent(new ia.Event(ia.Event.THEME_CHANGED,this))};
ia.BreaksCalculator=function(a){this._stats=new ia.Statistics;this._data=[];this._functions={};this.sdSize=1;this.errorMessage="Legend error defaulting to equal interval.";this.addFunction(ia.Thematic.CONTINUOUS,ia.Thematic.CONTINUOUS);this.addFunction(ia.Thematic.EQUAL_INTERVAL,ia.Thematic.EQUAL_INTERVAL);this.addFunction(ia.Thematic.QUANTILE,ia.Thematic.QUANTILE);this.addFunction(ia.Thematic.NATURAL,ia.Thematic.NATURAL);this.addFunction(ia.Thematic.STANDARD_DEVIATION,ia.Thematic.STANDARD_DEVIATION);
a!=void 0&&this.setData(a)};ia.BreaksCalculator.prototype.addFunction=function(a,b){this._functions[a]=b};ia.BreaksCalculator.prototype.getStats=function(){return this._stats};ia.BreaksCalculator.prototype.getData=function(){return this._data};ia.BreaksCalculator.prototype.setData=function(a){this._data=a;this._stats.setData(a)};
ia.BreaksCalculator.prototype.getBreaks=function(a,b){a==null&&(a=5);b==null&&(b="equalInterval");var c;try{if(this._stats.range==0)c=[this._stats.minValue];else{var d=this._functions[b];d!=void 0&&(c=d==ia.Thematic.CONTINUOUS?this.continuous(a):d==ia.Thematic.EQUAL_INTERVAL?this.equalIntervals(a):d==ia.Thematic.QUANTILE?this.quantiles(a):d==ia.Thematic.NATURAL?this.natural(a):d==ia.Thematic.STANDARD_DEVIATION?this.standardDeviation(a):d.call(null,a))}}catch(e){c=this.equalIntervals(a)}return c};
ia.BreaksCalculator.prototype.continuous=function(){return this._stats.range>0?this._stats.unique:null};ia.BreaksCalculator.prototype.equalIntervals=function(a){a==null&&(a=5);if(this._stats.range>0){var b=a+1,c=Array(b),d=this._stats.range/a;c[0]=this._stats.minValue;for(var e=1;e<a;e++)c[e]=parseFloat(this._stats.minValue)+e*d;c[b-1]=this._stats.maxValue;return c}else return null};
ia.BreaksCalculator.prototype.quantiles=function(a){a==null&&(a=5);for(var b=!1,c=this._quantileFunc(a,this._stats.sorted),d=c.length,e=0;e<d-1;e++)if(c[e]>=c[e+1]){b=!0;break}for(;b;)if(c=this._quantileFunc(a,this._stats.unique),d=c.length,d==1)b=!1;else for(e=0;e<d-1;e++)if(c[e]>=c[e+1]){a--;b=!0;break}else b=!1;return c};
ia.BreaksCalculator.prototype._quantileFunc=function(a,b){if(this._stats.range>0){if(this._stats.unique.length<a)a=this._stats.unique.length;var c=a+1,d=Array(c),e=1/a;d[0]=this._stats.minValue;for(var f=1;f<a;f++){var g=ia.round(e*f,2);d[f]=this._stats.getPercentile(g,b)}d[c-1]=this._stats.maxValue;return d}else return null};
ia.BreaksCalculator.prototype.natural=function(a){a==null&&(a=5);if(this._stats.range>0){var b=this._stats.unique.length;if(this._stats.unique.length<a)a=this._stats.unique.length;for(var c=Array(b+1),d=Array(b+1),e=1;e<=b;e++){c[e]=Array(a+1);d[e]=Array(a+1);for(var f=1;f<=a;f++)f==1?(c[e][f]=1,d[e][f]=0):d[e][f]=Infinity}for(var g,h,j,i,m,k,e=2;e<=b;e++){i=j=h=g=0;for(var n=1;n<=e;n++)if(m=e-n+1,g=this._stats.unique[m-1],h++,j+=parseFloat(g),f=j/h,f*=f,g*=g,i+=parseFloat(g),g=i/h-f,k=m-1,k!=0)for(f=
2;f<=a;f++)d[e][f]>=d[k][f-1]+g&&(c[e][f]=m,d[e][f]=d[k][f-1]+g);c[e][1]=1;d[e][1]=g}e=b;d=Array(a);d[a-1]=b-1;for(f=a;f>=2;f--)m=c[e][f]-2,d[f-2]=m,e=c[e][f]-1;a=[];a[0]=this._stats.minValue;for(e=0;e<=d.length-2;e++)a[a.length]=this._stats.unique[d[e]];a[a.length]=this._stats.maxValue;return a}else return null};
ia.BreaksCalculator.prototype.standardDeviation=function(){if(this._stats.range>0){var a,b=Array(5),c=Math.ceil(b.length/2),d=this._stats.mean,e=this._stats.standardDeviation*this.sdSize;b[0]=-Infinity;for(var f=1;f<=5;f++)a=f==c?d:d+e*(f-c),b[f]=a;b[b.length]=Infinity;return b}else return null};
ia.NumericClassifier=function(a){this._breaks=[];this._classes=[];this._adjustedNoClasses=0;this._calculator=new ia.BreaksCalculator;this._data=[];this.formatter=new ia.Formatter;this.colorPalette=new ia.ColorPalette;this.sizePalette=new ia.SizePalette;this.classificationName=ia.Thematic.EQUAL_INTERVAL;this.labels=[];this.sdLabels=["> 2 SD below mean","1 - 2 SD below mean","0 - 1 SD below mean","0 - 1 SD above mean","1 - 2 SD above mean","> 2 SD above mean"];this.noClasses=5;a!=void 0&&this.setData(a)};
ia.NumericClassifier.prototype.getData=function(){return this._data};ia.NumericClassifier.prototype.setData=function(a){this._data=a;this._calculator.setData(this._data)};ia.NumericClassifier.prototype.getBreaks=function(){return this._breaks};ia.NumericClassifier.prototype.getCalculator=function(){return this._calculator};ia.NumericClassifier.prototype.getClasses=function(){return this._classes};ia.NumericClassifier.prototype.commitChanges=function(){this._buildClasses();this._buildPalettes()};
ia.NumericClassifier.prototype.getClass=function(a){for(var b=0;b<this._classes.length;b++){var c=this._classes[b];if(c.contains(a))return c}return null};
ia.NumericClassifier.prototype._buildClasses=function(a){var b,c=!1,d;this._classes=[];this._breaks=this._calculator.getBreaks(this.noClasses,this.classificationName);if(this._breaks!=null)if(d=a!=void 0?a:ia.getPrecision(this._breaks),a=this.classificationName==ia.Thematic.CONTINUOUS?this._breaks.length:this._breaks.length==1?1:this._breaks.length-1,a==1)b=new ia.NumberClass(this._breaks[0]),b.formatter=this.formatter,this._classes.push(b);else for(var e=0;e<a;e++)if(this.classificationName==ia.Thematic.CONTINUOUS)b=
new ia.NumberClass(this._breaks[e]),b.formatter=this.formatter,this._classes.push(b);else{var f=this._breaks[e],g=this._breaks[e+1];b=new ia.RangeClass(f,g);b.formatter=this.formatter;this._classes.push(b);if(this.labels.length>e)b.setLabel(this.labels[e]);else if(this.classificationName==ia.Thematic.STANDARD_DEVIATION&&this.sdLabels.length>e)b.setLabel(this.sdLabels[e]);else if(f=this.formatter.format(f,d),g=this.formatter.format(g,d),e!=0&&(f=this.formatter.format(this._adjustBreak(f),d)),this.formatter.unformat(f)>
this.formatter.unformat(g)){c=!0;break}else f==g?b.setLabel(f):b.setLabel(f+" - "+g)}else this._breaks=[],this._classes=[],a=0;this._adjustedNoClasses=a;c&&this._buildClasses(d+1)};ia.NumericClassifier.prototype._adjustBreak=function(a){var b=this.formatter.unformat(a);if(a.indexOf(this.formatter.decimalSeparatorTo)>-1){for(var a=a.length-a.toString().indexOf(this.formatter.decimalSeparatorTo)-1,c="0.",d=0;d<a;d++)c+=d==a-1?"1":"0";b=parseFloat(b)+parseFloat(c)}else b=parseFloat(b)+1;return b};
ia.NumericClassifier.prototype._buildPalettes=function(){var a,b;if(this.classificationName==ia.Thematic.CONTINUOUS){var c=this._breaks.length,d=this._breaks[c-1]-this._breaks[0];a=[];this.sizePalette.useSqrRoot=!0;b=[];for(var e=0;e<c;e++){var f=(this._breaks[e]-this._breaks[0])/d;ia.isNumber(f)||(f=0);a.push(this.colorPalette.getColor(f));b.push(this.sizePalette.getSize(f))}}else a=this.colorPalette.getInterpolatedColors(this._adjustedNoClasses),this.sizePalette.useSqrRoot=!1,b=this.sizePalette.getInterpolatedSizes(this._adjustedNoClasses);
for(e=0;e<this._classes.length;e++)c=this._classes[e],c.color=a[e],c.size=b[e]};ia.CategoricClassifier=function(a){this._uniqueValues=[];this._classes=[];this._data=[];this.formatter=new ia.Formatter;this.colorPalette=new ia.ColorPalette;this.colorPalette.setColorList(ia.ColorPalette.CATEGORY_COLORS);this.symbolSize=10;this.noClasses=0;this.labels=[];this.breaks=[];this.uniqueValues=[];a!=void 0&&this.setData(a)};ia.CategoricClassifier.prototype.getData=function(){return this._data};
ia.CategoricClassifier.prototype.setData=function(a){this._data=a;this._uniqueValues=this.breaks.length>0?this.breaks.concat():this._getUniqueValues(this._data)};ia.CategoricClassifier.prototype.getClasses=function(){return this._classes};
ia.CategoricClassifier.prototype.commitChanges=function(){this._buildClasses();this._buildPalettes();for(var a=0;a<this._classes.length;a++){var b=this._classes[a];if(this.colorPalette.matchColorsToValues[b.value]==void 0)this.colorPalette.matchColorsToValues[b.value]=b.color}};ia.CategoricClassifier.prototype.getClass=function(a){for(var b=0;b<this._classes.length;b++){var c=this._classes[b];if(c.contains(a))return c}return null};
ia.CategoricClassifier.prototype._getUniqueValues=function(a){var b=[];if(a.length>0){a=a.concat();a.sort();for(var c,d=0,e=a.length,f=0;f<e;f++){var g=a[f];g!=c&&(b.push(g),d=0);c=g;d++}}return b};
ia.CategoricClassifier.prototype._buildClasses=function(){this._classes=[];if(this.noClasses!=this._uniqueValues.length)this.noClasses=this._uniqueValues.length;for(var a=0;a<this.noClasses;a++){var b=new ia.CategoricClass(this._uniqueValues[a]);this.labels.length>a&&b.setLabel(this.labels[a]);b.formatter=this.formatter;this._classes.push(b)}};
ia.CategoricClassifier.prototype._buildPalettes=function(){if(this._uniqueValues.length>0)for(var a=this.colorPalette.getMatchingColors(this._uniqueValues),b=0;b<this._classes.length;b++){var c=this._classes[b];c.color=a[b];c.size=this.symbolSize}};ia.LegendClass=function(a,b,c){this.formatter=new ia.Formatter;this.color="#FFFFFF";this.size=15;this.items=[];this.symbol=ia.Shape.SQUARE;this.index=0;if(a!=null)this.value=a;if(b!=null)this.color=b;if(c!=null)this.size=c};
ia.NumberClass=function(a,b,c){ia.NumberClass.baseConstructor.call(this,a,b,c);this._label=void 0};ia.extend(ia.LegendClass,ia.NumberClass);ia.NumberClass.prototype.getLabel=function(){return this._label!=void 0?this._label:this.formatter.format(this.value)};ia.NumberClass.prototype.setLabel=function(a){this._label=a};ia.NumberClass.prototype.contains=function(a){return a==this.value?!0:!1};
ia.RangeClass=function(a,b,c,d){ia.RangeClass.baseConstructor.call(this,NaN,c,d);this._range=this._label=void 0;this.minValue=a;this.maxValue=b;this.minRule=ia.RangeClass.GREATER_THAN_OR_EQUAL_TO;this.maxRule=ia.RangeClass.LESS_THAN_OR_EQUAL_TO};ia.extend(ia.LegendClass,ia.RangeClass);ia.RangeClass.LESS_THAN="lessThan";ia.RangeClass.LESS_THAN_OR_EQUAL_TO="lessThanOrEqual";ia.RangeClass.GREATER_THAN="greaterThan";ia.RangeClass.GREATER_THAN_OR_EQUAL_TO="greaterThanOrEqual";
ia.RangeClass.prototype.getLabel=function(){if(this._label!=void 0)return this._label;else{var a=this.formatter.format(this.minValue),b=this.formatter.format(this.maxValue);return a+" - "+b}};ia.RangeClass.prototype.setLabel=function(a){this._label=a};ia.RangeClass.prototype.getRange=function(){return maxValue-minValue};
ia.RangeClass.prototype.contains=function(a){if(ia.isNumber(a)){if(this.minRule==ia.RangeClass.GREATER_THAN){if(!(parseFloat(a)>this.minValue))return!1}else if(!(parseFloat(a)>=this.minValue))return!1;if(this.maxRule==ia.RangeClass.LESS_THAN){if(!(parseFloat(a)<this.maxValue))return!1}else if(!(parseFloat(a)<=this.maxValue))return!1;return!0}else return!1};ia.CategoricClass=function(a,b,c){ia.CategoricClass.baseConstructor.call(this,a,b,c);this._label=void 0};ia.extend(ia.LegendClass,ia.CategoricClass);
ia.CategoricClass.prototype.getLabel=function(){return this._label!=void 0?this._label:this.formatter.formatText(this.value)};ia.CategoricClass.prototype.setLabel=function(a){this._label=a};ia.CategoricClass.prototype.contains=function(a){return a==this.value?!0:!1};ia.ColorPalette=function(a){this._colors=[];this.id="";this.matchColorsToValues={};a!=void 0?this.setColorList(a):this.setColorList(ia.ColorPalette.NUMERIC_COLORS)};ia.ColorPalette.NUMERIC_COLORS=["#ece7f2","#74a9cf","#023858"];
ia.ColorPalette.CATEGORY_COLORS=["#B4371F","#FFBB78","#2CA02C","#98DF8A","#D62728","#FF9896","#9467BD","#C5B0D5","#8C564B","#C49C94","#E377C2","#F7B6D2","#7F7F7F","#C7C7C7","#BCBD22","#DBDB8D","#17BECF","#9EDAE5","#AEC7E8","#9EDAE5"];ia.ColorPalette.prototype.getColorList=function(){return this._colors};ia.ColorPalette.prototype.setColorList=function(a){this._colors=a};ia.ColorPalette.prototype.addColor=function(a){this._colors.push(a)};
ia.ColorPalette.prototype.getColorAtIndex=function(a){return this._colors[a%this._colors.length]};ia.ColorPalette.prototype.setColorAtIndex=function(a,b){this._colors[a]=b};ia.ColorPalette.prototype.getMatchingColors=function(a){for(var b=a.length,c=Array(b),d=this.getColors(b),e=0;e<b;e++)c[e]=this.matchColorsToValues[a[e]]!=void 0?this.matchColorsToValues[a[e]]:d[e];return c};
ia.ColorPalette.prototype.getColors=function(a){for(var b=Array(a),c=0,d=0;d<a;d++)d<this._colors.length?b[d]=this._colors[d]:(b[d]=c<ia.ColorPalette.CATEGORY_COLORS.length?ia.ColorPalette.CATEGORY_COLORS[c]:ia.Color.getRandomColor(),c++);return b};
ia.ColorPalette.prototype.getInterpolatedColors=function(a){if(a==1)return[this._colors[0]];else if(a==2)return[this.getColor(0),this.getColor(1)];else{for(var b=Array(a),c=1/(a-1),d=0,e=0;e<a;e++)b[e]=e==0?this.getColor(0):e==a-1?this.getColor(1):this.getColor(d),d+=parseFloat(c);return b}};
ia.ColorPalette.prototype.getColor=function(a){var b=this._colors.length-1;if(b<=0||a<=0)return this._colors[0];else if(a>=1)return this._colors[b];else{for(var c,d=1/b,e=0,f=0;f<b;f++){var g=e,h=g+d;if(a>=g&&a<=h){c=ia.Color.getInterpolatedColor(this._colors[f],this._colors[f+1],(a-g)/(h-g));break}e+=parseFloat(d)}return c}};ia.SizePalette=function(a,b){this.maxSize=this.minSize=15;this.useSqrRoot=!1;if(a!=null)this.minSize=a;if(b!=null)this.maxSize=b};
ia.SizePalette.prototype.getInterpolatedSizes=function(a){var b=[];if(a==1)return[this.minSize];for(var c=0;c<a;c++)b.push(this.getSize(c/(a-1)));return b};ia.SizePalette.prototype.getSize=function(a){if(a==null)return this.minSize;this.useSqrRoot&&(a=Math.sqrt(a));return this.minSize+a*(this.maxSize-this.minSize)};
